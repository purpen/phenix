{%extends 'layout/sns.html'%}
{% block title %}社区-{% endblock %}
{% block page_css %}
<style type="text/css">
	.ui.tophead {
	    background: url("{{ app_url_packaged }}/images/bg-banner.jpg") no-repeat scroll center center / cover rgba(0, 0, 0, 0);
	}
</style>
{% endblock %}
{% block jquery %}
	
{% endblock %}

{% block tophead %}
<div class="ui tophead">
	<div class="masthead">
		<div class="masthead-cover transparent">
			<div class="ui responsive head grid">
				<div class="row">
					<div class="nine wide column">
						<div class="introduction">
							<h2 class="ui header">
							  	<div class="content">
							    	发现、支持、分享
							    	<div class="sub header">让我们用创意和梦想去改变这个平凡无奇的世界</div>
							  	</div>
							</h2>
							<div class="actions">
								<a href="{{ app_url_helper }}/topic" class="ui white btn-4 btn-4c icon-arrow-right btn">
									查看帮助
								</a>
							</div>
						</div>
					</div>
					<div class="seven wide column">
					
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
{% endblock %}

{% block content %}
<div id="topics">
	<div class="ui responsive grid">
		<div class="container column">
			{% category_list var:'category' only_open:1 domain:domain %}
			{% for cat in category.rows %}
				<div class="ui block segment">
					<h3 class="ui dividing header">
						<a class="ui link" href="{{ cat.view_url }}">{{ cat.title }}</a>
					</h3>
					{% category_list var:'children' page:1 only_open:1 domain:domain pid:cat._id %}
					<div class="ui three items">
						{% for child in children.rows %}
						<div class="item">
							<div class="ui header">
								<div class="picicon">
									<div class="cate icon">
										<i class="flat s_{{ child.name }} icon"></i>
									</div>
								</div>
							  	<div class="content">
									<a class="ui magenta link" href="{{ child.view_url }}">
										{{ child.title }}
										{% if child.total_count %}
										<small class="newadd">({{ child.total_count }})</small>
										{% endif %}
									</a>
							    	<div class="sub header">{{ child.summary|truncate 40 }}</div>
									<div class="count">主题：{{ child.total_count }} , 回帖：{{ child.reply_count|default 0 }}</div>
							  	</div>
							</div>
						</div>
						{% endfor %}
					</div>
					
					{% topic_list var:'list' category_id:cat._id is_top:1 time:time sort:sort page:1 size:5 %}
					
					<div class="ui computer tablet only block">
						<table class="ui basic table">
							{% for topic in list.rows %}
								<tr>
									<td class="nine wide">
							          	<a href="{{ topic.view_url }}" title="{{ topic.title }}" class="ui line link">{{ topic.title }}</a>
									</td>
									<td>
										<a class="ui small link" href="{{ topic.user.home_url }}">
								      		<img src="{{ topic.user.mini_avatar_url }}" class="ui avatar image" alt="{{ topic.user.nickname }}" /> {{ topic.user.nickname }}
										</a>
									</td>
									<td>
										{% if topic.last_user %}
										回复于{{ topic.last_reply_time|relative_datetime}}
										{% endif %}
									</td>
									<td>
										<a href="{{ topic.view_url }}#comment" class="dot-irecommend">
											<span class="dot-irecommend-count">{{ topic.comment_count }}</span> 
											<span class="dot-irecommend-suffix"></span>
										</a>
									</td>
								</tr>
							{% endfor %}
						</table>
					</div>
					
					<div class="ui mobile only block">
						<table class="ui basic table">
							{% for topic in list.rows %}
								<tr>
									<td>
							          	<a href="{{ topic.view_url }}" title="{{ topic.title }}" class="ui link">{{ topic.title }}</a>
									</td>
								</tr>
							{% endfor %}
						</table>
					</div>
				</div>
			{% endfor %}
			
		</div>
	</div>
</div>
{% endblock %}