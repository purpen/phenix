{%extends 'layout/column.html'%}
{% block title %}{% endblock %}
{% block page_css %}
<style type="text/css">
    
</style>
{% endblock %}

{% block jquery %}
	$('.ui.cart.button').click(function(){
		$.get($(this).attr('href'));
		return false;
	});

  //预售结束时间
	$('[data-countdown]').each(function() {
		var $this = $(this), finalDate = $(this).data('countdown');
		$this.countdown(finalDate, function(event) {
			$this.html(event.strftime('%-D'));
		});
	});
{% endblock %}

{% block content %}
<div class="category image {{ current_category.name }}" >
	<h1>
        {% if css_saled %}
        新品预售
        {% else %}
		{{ current_category.title }}
        {% endif %}
        
        <div class="desc">
            <p>{{ current_category.summary|default '我们用心挑选数以万计的创意产品，为你每次的一见钟情' }}</p>
        </div>
	</h1>
    <div class="cover"></div>
</div>

<ul class="nav-categories">
    {% category_list var:'category' only_open:1 domain:domain show_all:0 current:category_id %}
	<li class="category {% if !category_id %} active{% endif %}">
        <a href="{{ app_url_shop }}/c0">
            <i class="sidebar icon"></i> <span class="computer only">全部分类</span>
        </a>
    </a>
	{% for cat in category.rows %}
    <li class="category {{ cat.active}}">
      	<a href="{{ cat.view_url }}">
            <i class="{{ cat.name }} icon"></i> <span class="computer only">{{ cat.title }}</span>
        </a>
    </li>
	{% endfor %}
</ul>

<div class="sorts cubes">
    <div class="container">
        <label><i class="cubes icon"></i>选项：</label>
        <div class="ui horizontal list">
          <a class="{% if type == 0 %}active{% endif %} item" href="{{ list_prefix }}/list-c{{ category_id }}-t0-s{{ sort }}-p{{ page }}">
                全部
            </a>
            <a class="{% if type == 2 %}active{% endif %} item" href="{{ list_prefix }}/list-c{{ category_id }}-t2-s{{ sort }}-p{{ page }}">
                可购买
            </a>
            <a class="{% if type == 1 %}active{% endif %} item" href="{{ list_prefix }}/list-c{{ category_id }}-t1-s{{ sort }}-p{{ page }}">
                产品灵感
            </a>
            <a class="{% if type == 3 %}active{% endif %} item" href="{{ list_prefix }}/list-c{{ category_id }}-t3-s{{ sort }}-p{{ page }}">
                积分兑换
            </a>
        </div>
    </div>
</div>

<div class="sorts">
    <div class="container">
        <label><i class="sort content ascending icon"></i>排序：</label>
        <div class="ui horizontal list">
          <a class="{% if sort == 0 %}active{% endif %} item" href="{{ list_prefix }}/list-c{{ category_id }}-t{{ type }}-s0-p{{ page }}">
                最新
            </a>
            <a class="{% if sort == 2 %}active{% endif %} item" href="{{ list_prefix }}/list-c{{ category_id }}-t{{ type }}-s2-p{{ page }}">
                热门
            </a>
            <a class="{% if sort == 1 %}active{% endif %} item" href="{{ list_prefix }}/list-c{{ category_id }}-t{{ type }}-s1-p{{ page }}">
                评分
            </a>
        </div>
    </div>
</div>

<div class="shop list" id="shoplist">
	<div class="ui wideping grid">
		<div class="row">
			{% product_list var:'list' page:page category_id:category_id is_shop:1 process_presaled:presaled type:type only_onsale:1 size:20 sort:sort %}
			{% if list.rows %}
			<div class="column">
				<div class="ui four products cards">
					{% for product in list.rows %}
				  		{% include "block/product_card.html" %}
				    {% endfor %}
				</div>
				{% if list.total_page > 1 %}
				<div class="ui pagination grid">
					{% pager url:pager_url,total_rows:list.total_rows,total_page:list.total_page,current_page:page,var:'pager',pager_size:9 %}
					{%include 'block/pager.html'%}
				</div>
				{% endif %}
			</div>
			{% else %}
			<div class="center aligned column">
				<div class="empty result">
					<div class="ui danger message">
						没有更多鸟，可选择其他产品~~
					</div>
				</div>
			</div>
			{% endif %}
		</div>
	</div>
</div>
{% endblock %}
