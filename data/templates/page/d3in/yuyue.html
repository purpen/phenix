{%extends 'layout/column.html'%}
{% block title %}铟立方未来实验室 -{% endblock %}

{% block page_css %}
<link rel="stylesheet" href="http://frstatic.qiniudn.com/wechat/js/swiper.min.css">
<style type="text/css">
.lab.submenu>.ui.responsive.grid>.row{
	padding:1rem 0;
	border-bottom: 1px solid rgba(0,0,0,0.15);
}
.lab.submenu > .ui.responsive.grid > .row > .column{
	padding:0;
}
.lab.submenu h3{
	margin:0;
}
.lab.submenu .right.wide.column a.ui.line.item{
	margin-left: 1rem;
	line-height: 23px;
}
.ui.table th{
	text-align:center;
}
.ui.table tbody tr,.ui.table tbody tr:nth-child(2n){
	background:#fff;
}
.ui.table tbody tr:hover{
	background:rgba(255,51,102,0.75);
	cursor: pointer;
}
.clss{
	background:#f1f1f1 !important;
}

/* 已预约的 */
.okyu{
	background:#ccc !important;
	cursor:auto !important;
}
p a.ui.link{
	color:#f36;
	margin-left:1em;
}
.swiper-button-prev{
	left:0;
}
.swiper-button-next{
	right:0;
}
.swiper-slide .ui.grid.row{
	margin:0 2%;
}
.row.chooli{
	margin:0 0 1rem;
}
.row.chooli span{
	margin-right: 15px;
  background: green;
  padding: 0.5px 6px;
}
.row.chooli span.black{
	background:#f36;
}
.row.chooli .ui.white.button.active{
	color:rgba(0,0,0,0.8);
	-webkit-user-select: initial;
	  -moz-user-select: initial;
	  -ms-user-select: initial;
	  user-select: initial;
	cursor:auto;
	text-transform: none;
}
.swiper-slide td {
	position:relative;
}
.swiper-slide td span{
	background: green;
  padding: 10px 6px;
  position: absolute;
  top: 50%;
  margin-top: -10px;
  left: 25%;
}
.swiper-slide td span.black{
	background:#f36;
}

</style>
{% endblock %}
{% block layout_js %}
	<script src="http://frstatic.qiniudn.com/wechat/js/swiper.min-1.js" type="text/javascript"></script>
{% endblock %}
{% block jquery %}

var rest_time = parseInt($('#rest-time .t').attr('rest-val'));

$('.ui.table tbody tr').click(function(){
	$(this).toggleClass('clss');
})
var mySwiper = new Swiper('.swiper-container',{
  freeMode : true,
  slidesPerView : 'auto',
	nextButton: '.swiper-button-next',
	prevButton: '.swiper-button-prev',
	noSwiping : 'true',
	noSwipingClass : 'stop-swiping',
});

$('.appoint-btn').click(function(){
  var id = $(this).attr('data-value');
  var item_name = $(this).text();
  $('[name=item_name]').val(item_name);
  $('.option-date').show();
});

$('.date-btn').click(function(){
  var id = $(this).attr('data-value');
  $('.option-hour').show();
  $('#rest-time').show();

});

// 选择时间点
$('.option-hour [name=hour]').click(function(){
  rest_time = parseInt($('#rest-time .t').attr('rest-val'));
  if($(this).is(":checked")){
    rest_time -= 1;
  }else{
    rest_time += 1;
  }
  if(rest_time <0 ){
    phenix.show_error_note('您的时间用完!');
    $(this).prop('checked', false);
    return;
    }else if(rest_time>4){
    phenix.show_error_note('操作有误!');
    $(this).prop('checked', true);
    return;  
    }
  $('#rest-time .t').attr('rest-val', rest_time).text(rest_time);
});

//确定btn
$('#gen-btn').click(function(){
  var item_id = $('[name=item_id]').val();
  var item_name = $('[name=item_name]').val();
  var date_id = $('[name=date_id]').val();
  var hour_arr = new Array();
  $('[name=hour]:checked').each(function(){
    hour_arr.push($(this).val());
  });
  hour_ids = hour_arr.join('|');

  if(!item_id || !date_id || !hour_ids){
    phenix.show_error_note('信息不完整!');
    return;
  }

  $('#item-show').show();
  
  
});

{% endblock %}
{% block content %}
<div class="lab submenu">
	<div class="ui responsive grid" style="padding:0 11%;">
		<div class="row">
			<div class="eight wide column">
				<h3>D3IN铟立方未来实验室</h3>
			</div>
			<div class="eight right aligned wide column">
        {% include "block/d3in/sub_nav.html" %}
			</div>
		</div>
	</div>
</div>
<div class="ui big block">
	<div class="ui responsive grid" style="padding:0 11%;">
		<div class="row">
			<div class="column">
				<h3 class="ui header">实验室预约</h3>
				<p>您希望什么时间前来？</p>
			</div>
		</div>
		
		<div class="row chooli">
			<div class="column">
        {% for d in classes %}
        <div class="ui white active inverted button"><span class="black"></span>{{ d.title }}</div>&nbsp;
        {%endfor%}

			</div>
		</div>

		<div class="row" id="item-show" style="display:none;">
			<div class="column">
        预约结果: 

			</div>
		</div>

      <div class="row">
        <div class="column">
                <div class="ui fluid selection option-item dropdown" style="position:relative;width:100px;">
                    <input type="hidden" name="item_id" value="" />
                    <input type="hidden" name="item_name" value="" />
                      <div class="default text">--开始预约--</div>
                      <i class="angle down icon" style="position:absolute;right:0;"></i>
                      <div class="menu">
                        {% for d in classes %}
                        <div data-value="{{ d._id }}" class=" item appoint-btn">{{ d.title }}</div>
                        {%endfor%}
                        
                      </div>
                  </div>

                <div class="ui fluid selection option-date dropdown" style="position:relative;width:100px;display:none;">
                    <input type="hidden" name="date_id" value="" />
                      <div class="default text">--选择日期--</div>
                      <i class="angle down icon" style="position:absolute;right:0;"></i>
                      <div class="menu">
                        {% for d in appoint_date_arr %}
                          {% for c in d %}
                            <div data-value="{{ c.id }}" class=" item date-btn">{{ c.date }}</div>
                          {%endfor%}
                        {%endfor%}
                      </div>
                  </div>

                  <div class="option-hour" style="display:none;">
                    <label><input name="hour" type="checkbox" value="9" />9:00-10:00</label>&nbsp;
                    <label><input name="hour" type="checkbox" value="10" />10:00-11:00</label>&nbsp;
                    <label><input name="hour" type="checkbox" value="11" />11:00-12:00</label>&nbsp;
                    <label><input name="hour" type="checkbox" value="12" />12:00-13:00</label>&nbsp;
                    <label><input name="hour" type="checkbox" value="13" />13:00-14:00</label>&nbsp;
                    <label><input name="hour" type="checkbox" value="14" />14:00-15:00</label>&nbsp;
                    <label><input name="hour" type="checkbox" value="15" />15:00-16:00</label>&nbsp;
                    <label><input name="hour" type="checkbox" value="16" />16:00-17:00</label>&nbsp;
                    <label><input name="hour" type="checkbox" value="17" />17:00-18:00</label>&nbsp;
                    <label><input name="hour" type="checkbox" value="18" />18:00-19:00</label>&nbsp;
                    <label><input name="hour" type="checkbox" value="19" />19:00-20:00</label>&nbsp;
                    <label><input name="hour" type="checkbox" value="20" />20:00-21:00</label>&nbsp;

                    <br />
<input type="button" name="gen-btn" id="gen-btn" value="确定" />
                  </div>
                  

        </div>
    </div>

    <div class="row" id="rest-time" style="display:none;">
      <div class="column">
        剩余<span rest-val="4" class="t">4</span>小时
      </div>
    </div>
		
		<div class="swiper-container">
			<div class="swiper-wrapper">

        {% for d in appoint_date_arr %}

				<div class="swiper-slide stop-swiping">
					<div class="ui center aligned grid row">
			
            {% for c in d %}
						<div class="five wide center aligned column">
							<table class="ui celled table">
								<thead>
									<tr>
                    <th id="{{ c.id }}">{{ c.date }} {{ c.week }}</th>
									</tr>
								</thead>
								<tbody>
									<tr name="10" class="clss">
										<td>
											<span></span>
											10:00-11:00</td>
									</tr>
									<tr name="11" class="clss">
										<td>
												11:00-12:00</td>
									</tr>
									<tr name="12" class="clss">
										<td>12:00-13:00</td>
									</tr>
									<tr name="13" class="clss">
										<td>13:00-14:00</td>
									</tr>
									<tr name="14" class="okyu">
										<td><span class="black"></span>
                      14:00-15:00</td>
									</tr>
									<tr name="15">
										<td>15:00-16:00</td>
									</tr>
									<tr name="16">
										<td>16:00-17:00</td>
									</tr>
									<tr name="17">
										<td>17:00-18:00</td>
									</tr>
									<tr name="18">
										<td>18:00-19:00</td>
									</tr>
									<tr name="19">
										<td>19:00-20:00</td>
									</tr>
									<tr name="20">
										<td>20:00-21:00</td>
									</tr>
									<tr name="21">
										<td>21:00-22:00</td>
									</tr>
							
								</tbody>
							</table>	
						</div>
            {%endfor%}
			
					</div>
				</div>

        {%endfor%}
		
			</div>
			<div class="swiper-button-next"></div>
			<div class="swiper-button-prev"></div>
		</div>

    <div class="row">
      <div class="column">

      </div>
    </div>
		
		<div class="row">
        {% if vip_state != 3 %}
			<div class="column">
				<p>费用</p>
        <p>
        {{ vip_money.day }}元/次    
        {% if vip_state==0 %}<a href="{{ app_url_d3in }}/member" class="ui link" target="_blank"> 加入VIP会员订阅计划 </a>{%endif%}{% if vip_state==1 %}<a href="{{ app_url_d3in }}/member" class="ui link" target="_blank"> 会员到期,点击续费 </a>{%endif%}
        {% if vip_state==2 %}<a href="javascript:void(0);" class="ui link"> 该会员被禁用,暂时无法预约,请联系管理员 </a>{%endif%}
        </p>
				<p>支付方式</p>
				
				<div class="ui checkbox" style="margin-right:1rem;">
					<input type="radio" name="pay_ment" id="" />
					<label for="">在线支付</label>
				</div>
				<div class="ui checkbox">
					<input name="pay_ment" type="radio" id="" />
					<label for="">现场支付</label>
				</div>

			</div>
      {%endif%}
		</div>
		
		<div class="row">
			<div class="right aligned column">
        <a href="{{ app_url_domin }}/d3in/choose?ids={{ ids }}" class="ui magenta inverted button">上一步</a>&nbsp;&nbsp;
        {% if vip_state != 2 %}
				<a href="" class="ui magenta inverted button">下一步</a>
        {%endif%}
			</div>
		</div>
		
		
		
	</div>
</div>

{% endblock %}
