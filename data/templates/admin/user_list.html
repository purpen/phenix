{%extends 'layout/admin.html'%}
{% block page_css %}
<style type="text/css">
	
</style>
{% endblock %}
{% block js %}
{% endblock %}
{% block content %}
	<div class="ui tool-box">
		<div class="ui small magenta buttons">
			<div class="ui button">
				{% if state == 0 %}
					全部列表
				{% endif %}
				{% if state == 2 %}
					已激活列表
				{% endif %}
				{% if state == 1 %}
					未激活列表
				{% endif %}
			</div>
			<div class="ui floating dropdown icon button">
				<i class="flat add icon"></i>
				<div class="menu">
					<a href="{{ app_url_admin }}/user" class="item">全部列表</a>
					<a href="{{ app_url_admin }}/user?state=2&time={{ time }}" class="{{ css_ok }} item">已激活列表</a>
					<a href="{{ app_url_admin }}/user?state=1&time={{ time }}" class="{{ css_pending }} item">未激活列表</a>
		    	</div>
		  	</div>
		</div>
		
		<div class="ui small magenta buttons">
			<div class="ui button">
				{% if time == '' %}
					全部时间
				{% endif %}
				{% if time == 'yesterday' %}
					昨天
				{% endif %}
				{% if time == 'week' %}
					最近一周
				{% endif %}
				{% if time == 'mouth' %}
					最近一月
				{% endif %}
			</div>
			<div class="ui floating dropdown icon button">
				<i class="flat add icon"></i>
				<div class="menu">
					<a href="{{ app_url_admin }}/user?time=" class="item">全部时间</a>
					<a href="{{ app_url_admin }}/user?time=yesterday" class="{{ css_yesterday }} item">昨天</a>
					<a href="{{ app_url_admin }}/user?time=week" class="{{ css_week }} item">最近一周</a>
					<a href="{{ app_url_admin }}/user?time=mouth" class="{{ css_mouth }} item">最近一月</a>
		    	</div>
		  	</div>
		</div>
		
		<form class="ui small right floated column form" method="post" action="{{ app_url_admin_base }}/user">
			<div class="inline field">
				<div class="ui icon input">
	          		<input placeholder="Search ..." type="text" name="q" />
	          		<i class="flat search icon"></i>
				</div>
	        </div>
		</form>
	</div>
	
	<div class="ui divider"></div>
	{% user_list var:'list' only_ok:only_ok only_pending:only_pending page:page start_time:start_time end_time:end_time search_passport:search_passport search_id:search_id %}
	<table class="ui small table segment">
		<thead>
			<tr>
				<th></th>
				<th>用户名</th>
				<th>联系方式</th>
				<th>注册时间</th>
				<th>管理操作</th>
			</tr>
		</thead>
		<tbody>
			{% for user in list.rows %}
			<tr>
				<td>
					<div class="ui checkbox">
					  	<input name="ids[]" type="checkbox" value="{{ user._id }}" />
					  	<label></label>
					</div>
				</td>
				<td>
					<a class="ui image label link" href="{{ user.home_url }}" target="_blank">
					  	<img src="{{ user.mini_avatar_url }}">
					  	{{ user.nickname }}
					</a>
					<p>
						{% if user.from_site == 2 %}
						<i class="flat icon_weibo icon"></i>
						{% endif %}
						{% if user.from_site == 3 %}
						<i class="flat icon_qq icon"></i>
						{% endif %}
						{{ user.account }}
					</p>
				</td>
				<td>
					{{ user.city }}<br />
					{{ user.profile.phone }}
				</td>
				<td>
					{{ user.created_on|date 'Y-m-d H:i'}}
					<p>
						{% if user.state == 2 %}
						<label class="ui green label">已激活</label>
						{% endif %}
						
						{% if user.state == 1 %}
						<label class="ui orange label">未激活</label>
						{% endif %}
						
						{% if user.state == 0 %}
						<label class="ui gray label">已禁用</label>
						{% endif %}
					</p>
				</td>
				<td>
					<div class="ui small divided horizontal list">
						{% if visitor.role_id == 3 %}
						<a href="{{ app_url_admin }}/user/upgrade?id={{ user._id }}" class="ui link ajax item">升级管理员</a>
						{% endif %}
						<a href="{{ app_url_admin }}/user/activtion?id={{ user._id }}" class="ui link ajax item">激活</a>
						<a href="{{ app_url_admin }}/user/disabled?id={{ user._id }}" class="ui link ajax item">禁用</a>
					</div>
				</td>
			</tr>
			{% endfor %}
		</tbody>
	</table>
	
	{% if list.rows %}
	<div class="ui pagination">
		{% pager url:pager_url,total_rows:list.total_rows,total_page:list.total_page,current_page:page,var:'pager',pager_size:9 %}
		{%include 'block/pager.html'%}
		<label class="page_count">{{ list.total_rows }}个</label>
	</div>
	{% endif %}
	
{% endblock %}