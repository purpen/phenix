{%extends 'layout/mobile.html'%}
{% block title %}最火爆的智能硬件TOP100{% endblock %}
{% block page_css %}
<style type="text/css">
#mfrbird{
	margin-top:0;
	margin-bottom: 0;
}
.topbg {
    background: url({{ app_url_packaged }}/images/top/wap_bg.jpg) no-repeat center center;
    background-size: cover;
	padding-top: 37%;
	padding-bottom: 8%;
}
.topbg .ui.jointop{
	padding-left:30px;
	padding-right:30px;
}
.ui.like.inverted.magenta.button{
    box-shadow: 0 0 0 1px #f36 inset!important;
    font-size: 12px;
	position: relative;
	overflow: visible;
	width: 105px;
}
.ui.responsive.grid{
	overflow: visible;
}
.like.button .add {
    position: absolute;
    top: 14px;
    text-align: center;
    left: 0;
    color: transparent;
    width: 100%;
    font-size: 20px;
    opacity: 1;
    z-index: 9;
    transition: all 1s;
}
.like.button .add.add-active {
    top: 50%;
	margin-top:-70px;
    color: #f36;
    transition-delay: .3s;
    -webkit-animation: arrow 1.5s ease both;
    -moz-animation: arrow 1.5s ease both;
    animation: arrow 1.5s ease both;
}
.eight.column{
	width:50%;
	overflow: visible;
}
.row{
	overflow: visible;
}
.eight.title.column h3.ui.header{
    line-height: 37px;
    height: 35px;
	font-size: 1.18rem;
}
.ui.descrite.segment{
    padding: 20px 20px 30px;
    margin-bottom: 30px;
}
.ui.descrite.segment p{
	line-height: 26px;
}
.ui.descrite.segment p.link{
	color:#f36;
}
.ui.descrite.segment p.link a{
	color:#f36;
	position:relative;
}
.ui.descrite.segment p.link a::before{
	position: absolute;
    top: auto;
    bottom: 1px;
    left: 0;
    width: 100%;
    height: 1px;
    background-color: #f36;
    content: '';
    -webkit-transition: all 0.2s;
    -webkit-backface-visibility: hidden;
    transition: all 0.2s;
    backface-visibility: hidden;
    -webkit-transform: scaleX(0);
    transform: scaleX(0);
}
.ui.descrite.segment p.link a:hover:before{
    -webkit-transform: scaleX(1);
    transform: scaleX(1);
}
</style>
{% endblock %}

{% block jquery %}
    $('.like.button').click(function(){
        var obj = $(this);
        var id = $(this).data('id');
        var loved = $(this).data('mark');
      // 所有ajax请求，验证是否登录
      if (!phenix.visitor.is_login){
        phenix.redirect("{{ app_url_wap }}/auth/login_signup");
        return false;
      }
      
      if (loved == 'n'){
        $.post("{{ app_url_wap }}/app/site/favorite/ajax_laud", {id:id, type:4}, function(result){
          if(result.success){
            obj.data('mark', 'y');
            obj.addClass('active');
            obj.children('.add').addClass('add-active');        
            obj.find('span').text("已投票");
          }else{
            phenix.show_error_note('操作失败!',3000);
          }
        }, 'json');
      }else{
      /**
        $.post("{{ app_url_wap }}/app/site/favorite/ajax_cancel_laud", {id:id, type:4}, function(result){
          if(result.success){
            obj.data('mark', 'n');
            obj.removeClass('active');
            obj.children('.add').removeClass('add-active');
            obj.find('span').text("投他一票");
          }else{
            phenix.show_error_note('操作失败!',3000);
          }
        }, 'json');
        */
      }
      
    });

  	$('#slider').flexslider({
        animation: "slide",
        directionNav: false, 
        controlNav: true,
        animationLoop: true,
        slideshow: true,
        slideshowSpeed: 5000,
        animationDuration: 300,
        animationSpeed: 300,
    });

{% endblock %}
{% block content %}
<img src="{{ asset.thumbnails.huge.view_url }}" style="display:none;">
<div class="top100">
	<div class="topbg">
		<div class="ui responsive grid">
			<div class="row">
				<div class="center aligned column">
					<a href="{{ app_url_wap }}/stuff/tsubmit" class="ui magenta inverted jointop active button">
						立即报名
					</a>
				</div>
			</div>
		</div>
	</div>
	
	<div class="ui stuffs social">
		<div class="ui responsive grid">
			<div class="row">
				<div class="eight title wide column">
          <h3 class="ui header">{{ stuff.title }}</h3>
				</div>
				<div class="eight wide column" style="text-align:right;">

          {%if is_loved%}
            <div class="ui magenta like inverted button active" data-mark="y" data-id="{{ stuff._id }}">
              <i class=" heart icon"></i>
              <span>已投票</span>
              <div class="add">
                <i class="heart icon" style="font-size: 14px;vertical-align: middle;"></i>+1      
              </div>
            </div>
          {%else%}
            <div class="ui magenta like inverted button" data-mark="n" data-id="{{ stuff._id }}">
              <i class=" heart icon"></i>
              <span>投他一票</span>
              <div class="add">
                <i class="heart icon" style="font-size: 14px;vertical-align: middle;"></i>+1      
              </div>
            </div>
          {%endif%}

				</div>
			</div>
				
			<div class="row" style="padding-top: 0;">
				<div class="column">
					<div id="slider" class="flexslider flex-single">
						{% asset_list var:'assets' parent_id:stuff._id size:10 asset_type:70 %}
						<ul class="slides">
              {% for asset in assets.rows %}
                <li style="background-image: url('{{ asset.thumbnails.huge.view_url }}');">
                    <a href="{{ asset.thumbnails.huge.view_url }}" title="{{ stuff.title }}">
                    </a>
                </li>
              {%endfor%}
							
						</ul>
					</div>
				</div>
				
			</div>
			
			<div class="row">
				<div class="column">
					<div class="ui descrite segment">
            <p>{{ stuff.description }}</p>
						{% if stuff.link %}
						<p class="link">
							详情请点击：
              <a href="{{ stuff.link }}">{{ stuff.link }}</a>
						</p>
            {%endif%}
					</div>
				</div>
			</div>
			
			
		</div>
	</div>
	
</div>
{% endblock %}
