{%extends 'layout/mobile.html'%}
{% block title %}神嘴争霸赛 -{% endblock %}

{% block page_css %}
<style type="text/css">
#mfrbird{
	margin-top:0;
	margin-bottom:2em;
}
.rtitle{
  background:url({{ app_url_packaged }}/images/promo/rankbj.png);
  width:180px;
  height:50px;
  color: #fff;
  text-align: center;
  line-height: 50px;
  font-size: 1.28rem;
  padding-left: 15px;
  margin: 0 auto 15px;
}
p{
  margin-bottom:0.8rem;
}
.line{
  width: 100%;
  height: 20px;
  background: url({{ app_url_packaged }}/images/promo/rankline.jpg);
  background-position: 0px -4px;
}
.rtitle.tmr{
  position: absolute;
  left: 50%;
  top: 10px;
  margin-left: -90px;
}
.time{
  margin-top: 30px;
  width:100%;
  padding-top: 37%;
  background:url({{ app_url_packaged }}/images/promo/rankmtime.png);
  background-size:cover;
}
.propk{
  padding:0 !important;
  position:relative;
  margin-bottom: -10px;
}

.pkhbtn{
  position:absolute;
  bottom: 20px;
  width:70px;
  left:50px;
  background:url({{ app_url_packaged }}/images/promo/rankhz.png);
  background-size:cover;
  height:70px;
}
.pklbtn{
  position:absolute;
  bottom: 20px;
  width:70px;
  right:50px;
  background:url({{ app_url_packaged }}/images/promo/ranklz.png);
  background-size:cover;
  height:70px;
}
.rankhpro{
  background:url({{ app_url_packaged }}/images/promo/rankhpro.jpg);
  height:40px;
  background-repeat:repeat;
  display:inline-block;
  border-bottom-left-radius: 8px;
  padding: 0 10px !important;
  line-height: 40px;
  font-size: 16px;
  font-weight: 500;
  color: #fff;
  letter-spacing: 1px;
}
.ranklpro{
  background:url({{ app_url_packaged }}/images/promo/ranklpro.jpg);
  height:40px;
  background-repeat:repeat;
  display:inline-block;
  border-bottom-right-radius: 8px;
  padding: 0 10px !important;
  line-height: 40px;
  font-size: 16px;
  font-weight: 500;
  color: #fff;
  letter-spacing: 1px;
  text-align:right;
}
.post.comment,.ui.comments{
  font-size:1rem !important;
}

.ui.white.block{
  background:#fff;
  margin: 0;
  padding: 10px 0 0;
}
</style>
{% endblock %}

{% block layout_js %}
<script type="text/javascript">

  var has_support = {{ has_support|default 0 }};
  var support_cid = {{ support_cid|default 0 }};

  function support_event(cid){
		// 所有ajax请求，验证是否登录
		if (!phenix.visitor.is_login){
			phenix.show_login_box();
			return false;
		}

    // 难证是否支持过
    $.get("{{ app_url_domain_base }}/app/site/promo_func/ajax_attend", {target_id: 1, event: 5, cid: cid}, function(result){
      if(result.success){
        // 已投票标识
        has_support = 1;
        support_cid = cid;
        phenix.show_ok_note(result.message);
        var l_count = parseInt($('.support-l-count').text());
        var r_count = parseInt($('.support-r-count').text());

        if(cid==1){
          $('.support-l-count').text(l_count+1);
          fetch_present(l_count+1, r_count);
        }else if(cid==2){
          $('.support-r-count').text(r_count+1);
          fetch_present(l_count, r_count+1);
        }

      }else{
        phenix.show_error_note(result.message);
        return;
      }
    }, 'json');
  }

  // 得到两个数百分比
  function fetch_present(x, y){
    var total = x+y;
    if(total==0){
      var l_per = 50;
      var r_per = 50;   
    }else{
      var l_per = (x/total)*100;
      var r_per = (y/total)*100;
    }

    $('.support-l-count').show().css('width', l_per+"%");
    $('.support-r-count').show().css('width', r_per+"%");
    if(l_per==0){
      $('.support-l-count').hide();
    }else if(r_per==0){
      $('.support-r-count').hide();
    }

  }
</script>
{% endblock %}

{% block jquery %}
  $(window).scroll(function(){
	    var scrollTop = $(window).scrollTop();
			if(scrollTop > 1600){
        $('.pktitle').addClass('transition fly up in');
        $('.pkhs').addClass('transition fly in');
        $('.pkls').addClass('transition fly in');
        $('.pkvs').addClass('transition flip vertical in');
      }
      if(scrollTop > 1700){
        $('.pkp').addClass('transition fly down in');
        $('.pkhf').addClass('transition slide right in');
        $('.pklf').addClass('transition slide left in');
      }
  })

	phenix.hook_comment_page();
  // 查看大图
  phenix.comment_blow_up_img();

  // 支持左方铵钮
  $('.support-l-btn').click(function(){
    var cid = $(this).data('cid');
    support_event(cid);
  });

  // 支持右方铵钮
  $('.support-r-btn').click(function(){
    var cid = $(this).data('cid');
    support_event(cid);
  });

  fetch_present({{count_01|default 0}}, {{count_02|default 0}});

  $('#comment-box .ui.submit.button').click(function(){
    if(has_support==0){
      phenix.show_error_note('投票后才有权力发表意见哦~');
      return false;
    }
    $('#comment-form :input[name=sku_id]').val(support_cid);

  });

    // 绑定跳楼
    $('.gotofloor').bind('keydown', function(e){
        var floor = $(this).val(), max = parseInt($(this).data('max')), url = $(this).data('url');
        if(e.keyCode == 13){
            if (isNaN(floor)){
                alert('必须输入一个数字！');
                return false;
            }
            if (floor > max){
                floor = max;
            }
            window.location.href = url + '?floor=' + floor + '#f' + floor;
        }
    });
{% endblock %}
{% block content %}
<div id="srank">
  <img src="{{ app_url_packaged }}/images/promo/rankmt.jpg" width="100%" alt="神嘴争霸赛">
  <div class="ui big white block" style="margin-top:-3px;">
    <div class="ui responsive grid">
      <div class="row">
        <div class="column">
          <div class="rtitle">
            活动介绍
          </div>
          <p>这是一场不见硝烟的战争，这是一次无关对错的辩论。我们举办此次活动，只为找到能够开口就让别人吐几十两鲜血的旷世人才！</p>
          <p>霸气总侧漏！好胆你就来！这次争霸赛就是为你而生！让撕X来的更猛烈些吧！</p>
          
        </div>
        <div class="line"></div>
      </div>
    </div>
  </div>
  
  <div class="ui big block">
    <div class="ui responsive grid">
      <div class="row">
        <div class="column">
          <div class="rtitle tmr">
            活动时间
          </div>
          <div class="time"></div>
        </div>
      </div>
      <div class="line"></div>
    </div>
  </div>
    
  <div class="ui big white block">
    <div class="ui responsive grid">
      <div class="row">
        <div class="column">
          <div class="rtitle">
            活动规则
          </div>
          <p>1.根据辩题分为正反两方，用户可以自行选择对战方阵。</p>
          <p>2.正反双方人气最高且最具领袖风范的用户将获得”太火鸟神嘴“称号，各自获得太火鸟送出的让许多大咖爱不释手的云马神秘新品！</p>
          <p>3.根据辩论精彩程度，将从双方各自挑选三名获得”太火鸟名嘴“称号，获得太火鸟送出的云马神秘新品发布会VIP门票。</p>
          <p class="ui magenta link">（PS：届时，发布会现场将会邀请行业精英与圈内大咖，甚至神秘嘉宾到场，徐小平？雷军？或是？展开你的想象力，我只告诉你这是一场高手云集，错过后悔的大场面！现场除100家媒体外，只供内部席位，太火鸟将设6个特别名额，快点来抢吧！）</p>
          <p>4.根据回复楼层百分比挑选六名用户获得”太火鸟硬嘴“称号，获得太火鸟独家定制神秘礼包。</p>
        </div>
      </div>  
      <div class="line"></div>
    
      <div class="row">
        <div class="column">
          <div class="rtitle">
            注意事项
          </div>
          <p>1.严禁辩论双方进行人身攻击；</p>
          <p>2.跟帖留言用户不得恶意复制他人内容回复，同样内容回复超过两次，超长式刷屏按灌水违规禁言处理；</p>
          <p>3.同一ID、电话、联系人、地址均视为同一人，不得重复中奖；</p>
          <p>4.中奖楼层为总楼层的 15%、25%、35%、55%、65%、75%。中奖时涉及到小数点的楼层取整数；</p>
          <p>5.云马神秘新品如何领取将由太火鸟官方工作人员电话通知；</p>
          <p>6.本次活动最终解释权归太火鸟所有。<br/></p>
        </div>
      </div>
      <div class="line"></div>  
    
      <div class="row">
        <div class="column">
          <div class="rtitle">
            奖品设置
          </div>
          <img src="{{ app_url_packaged }}/images/promo/rankmj.jpg" width="100%">
          <p><br/></p>
        </div>
      </div>
    
    </div>
  </div>
  
  
  <div class="ui responsive grid">
    <div class="propk row">
      <img src="{{ app_url_packaged }}/images/promo/rankmvs.jpg" width="100%">
      
      <a class="pkhbtn support-l-btn" data-cid="1" href="javascript:void(0);"></a>
      <a class="pklbtn support-r-btn" data-cid="2" href="javascript:void(0);"></a>
      
    </div>
    <div class="rankhpro support-l-count">{{ count_01 }}</div>
    <div class="ranklpro support-r-count">{{ count_02 }}</div>
    
  </div>
  
</div>
{% endblock %}
