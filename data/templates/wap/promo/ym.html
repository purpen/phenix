{%extends 'layout/weixin.html'%}
{% block title %}{% endblock %}
{% block page_css %}
<style type="text/css">
.loading{
	background: url({{ app_url_packaged }}/images/promo/mini/loading2.jpg);
	background-size: cover;
	position: absolute;
	top: 0;
    left: 0;
}
.loading__inner{
    background-color:rgba(0,0,0,0); 
	position: absolute;
    top: 50%;
    left: 50%;
}
.loading-num{
    position: absolute;
    left: 50%;
    margin-left: 14px;
    top: 50%;
    text-align: center;
    width: 40px;
    height: 12px;
    margin-top: -32px;
}
.screen__bg {
	background-size: 100%;
	position: absolute;
	left: 0;
	top: 0;
	width: 100%;
	height: 100%;
	background-repeat: no-repeat;
	background-position: center bottom;
}
.screen1 .screen__bg{
	background-image: url({{ app_url_packaged }}/images/promo/mini/p1_1.jpg);
	background-color:#e1e3e4; 
}
.screen2 .screen__bg,.screen8 .screen__bg{
	background-color: #17181a;
}
.screen3 .screen__bg{
	background-image: url({{ app_url_packaged }}/images/promo/mini/p3.jpg);
	background-color: #17181a;
}
.screen4 .screen__bg{
	background-image: url({{ app_url_packaged }}/images/promo/mini/p4_1.jpg);
	background-color: #e1e3e4;
}
.screen5 .screen__bg{
	background-image: url({{ app_url_packaged }}/images/promo/mini/p5_1.jpg);
	background-color: #e1e3e4;
}
.screen6 .screen__bg{
	background-image: url({{ app_url_packaged }}/images/promo/mini/p6_1.jpg);
	background-color: #e1e3e4;
}
.screen7 .screen__bg{
	background-image: url({{ app_url_packaged }}/images/promo/mini/p7_1.jpg);
	background-color: #e1e3e4;
}
.screen9 .screen__bg{
	background-color: #e1e3e4;
}
.p2_bg{
	background-image: url({{ app_url_packaged }}/images/promo/mini/p2.jpg);
	width: 320px;
	height: 504px;
	background-size: 100%;
}
.p8_bg{
	background-image: url({{ app_url_packaged }}/images/promo/mini/p8_1.jpg);
	width: 320px;
	height: 504px;
	background-size: 100%;
}
.p9_bg{
	background-image: url({{ app_url_packaged }}/images/promo/mini/p9_1.jpg);
	width: 320px;
	height: 504px;
	background-size: 100%;
}
.jb_1{
	background-image: url({{ app_url_packaged }}/images/promo/mini/jb1_2.png);
	width: 170px;
	height: 205px;
	background-size: 100%;
    background-position: 0 0;
    position: absolute;
    top: 30px;
    right: 100%;
}
.jb_2{
	background-image: url({{ app_url_packaged }}/images/promo/mini/jb1_2.png);
	width: 170px;
	height: 190px;
	background-size: 100%;
    background-position: 0 190px;
    position: absolute;
    top: 245px;
    right: 100%;   
}
.jb_3{
	background-image: url({{ app_url_packaged }}/images/promo/mini/jb2.png);
	width: 170px;
	height: 215px;
	background-size: 100%;
    background-position: 0 0;
    position: absolute;
    top: 30px;
    right: 100%;
}
.jb_4{
	background-image: url({{ app_url_packaged }}/images/promo/mini/jb2.png);
	width: 170px;
	height: 180px;
	background-size: 100%;
    background-position: 0 180px;
    position: absolute;
    top: 245px;
    right: 100%;   
}
.jb_5{
	background-image: url({{ app_url_packaged }}/images/promo/mini/jb3.png);
	width: 170px;
	height: 215px;
	background-size: 100%;
    background-position: 0 0;
    position: absolute;
    top: 30px;
    right: 100%;
}
.jb_6{
	background-image: url({{ app_url_packaged }}/images/promo/mini/jb3.png);
	width: 170px;
	height: 180px;
	background-size: 100%;
    background-position: 0 180px;
    position: absolute;
    top: 245px;
    right: 100%;   
}
.jb_7{
	background-image: url({{ app_url_packaged }}/images/promo/mini/jb4.png);
	width: 170px;
	height: 200px;
	background-size: 100%;
    background-position: 0 0;
    position: absolute;
    top: 30px;
    right: 100%;
}
.jb_8{
	background-image: url({{ app_url_packaged }}/images/promo/mini/jb4.png);
	width: 170px;
	height: 195px;
	background-size: 100%;
    background-position: 0 195px;
    position: absolute;
    top: 245px;
    right: 100%;   
}
.jb_9{
	background-image: url({{ app_url_packaged }}/images/promo/mini/jb5.png);
	width: 170px;
	height: 200px;
	background-size: 100%;
    background-position: 0 0;
    position: absolute;
    top: 30px;
    right: 100%;
}
.jb_10{
	background-image: url({{ app_url_packaged }}/images/promo/mini/jb5.png);
	width: 170px;
	height: 195px;
	background-size: 100%;
    background-position: 0 195px;
    position: absolute;
    top: 245px;
    right: 100%;   
}
.jb_11{
	background-image: url({{ app_url_packaged }}/images/promo/mini/jb6.png);
	width: 170px;
	height: 200px;
	background-size: 100%;
    background-position: 0 0;
    position: absolute;
    top: 30px;
    right: 100%;
}
.jb_12{
	background-image: url({{ app_url_packaged }}/images/promo/mini/jb6.png);
	width: 170px;
	height: 195px;
	background-size: 100%;
    background-position: 0 195px;
    position: absolute;
    top: 245px;
    right: 100%;   
}
.current .pw{
	-webkit-animation: btright 4.5s 1 alternate forwards;
    animation: btright 4.5s 1 alternate forwards;
}
.current .pw.jb_1{
	animation-delay:0s !important;
	-webkit-animation-delay:0s !important;
	-webkit-animation: btrightt 4s 1 alternate forwards;
    animation: btrightt 4s 1 alternate forwards;
}
.current .pw.jb_2{
	animation-delay:1s !important;
	-webkit-animation-delay:1s !important;
	-webkit-animation: btrightt 4s 1 alternate forwards;
    animation: btrightt 4s 1 alternate forwards;
}
.current .pw.jb_3{
	animation-delay:3s !important;
	-webkit-animation-delay:3s !important;
}
.current .pw.jb_4{
	animation-delay:5s !important;
	-webkit-animation-delay:5s !important;
}
.current .pw.jb_5{
	animation-delay:7s !important;
	-webkit-animation-delay:7s !important;
}
.current .pw.jb_6{
	animation-delay:9s !important;
	-webkit-animation-delay:9s !important;
}
.current .pw.jb_7{
	animation-delay:11s !important;
	-webkit-animation-delay:11s !important;
}
.current .pw.jb_8{
	animation-delay:13s !important;
	-webkit-animation-delay:13s !important;
}
.current .pw.jb_9{
	animation-delay:15s !important;
	-webkit-animation-delay:15s !important;
}
.current .pw.jb_10{
	animation-delay:17s !important;
	-webkit-animation-delay:17s !important;
}
.current .pw.jb_11{
	animation-delay:19s !important;
	-webkit-animation-delay:19s !important;
	-webkit-animation: btrightl 1.6s 1 alternate forwards;
	animation: btrightl 1.6s 1 alternate forwards;
}
.current .pw.jb_12{
	animation-delay:21s !important;
	-webkit-animation-delay:21s !important;
	-webkit-animation: btrightl 1.6s 1 alternate forwards;
	animation: btrightl 1.6s 1 alternate forwards;
}
.p8_sy{
	position: absolute;
	width: 90px;
	height: 30px;
	background-image: url({{ app_url_packaged }}/images/promo/mini/mian.png);
	background-size: 100%;
	top: 360px;
    left: 106px;
}
.p8_yy{
	position: absolute;
	width: 75px;
	height: 25px;
	background-image: url({{ app_url_packaged }}/images/promo/mini/yiyuan.png);
	background-size: 100%;
	top: 395px;
    left: 106px;
}
.fenxia{
	position: absolute;
	width: 110px;
	height: 90px;
	background-image: url({{ app_url_packaged }}/images/promo/mini/fh5.png);
	background-size: 100%;
	top: 275px;
    left: 85px;
}
.word{
	position: absolute;
	width: 160px;
	height: 45px;
	background-image: url({{ app_url_packaged }}/images/promo/mini/word.png);
	background-size: 100%;
	top: 375px;
    left: 85px;
}
.fenh5{
	background-image: url({{ app_url_packaged }}/images/promo/mini/fxh5.png);
	width: 100%;
	height: 100%;
	position: absolute;
    top: 0;
    left: 0;
    background-size: 100%;
    display: none;
    background-repeat: no-repeat;
    background-color: rgba(0,0,0,1);
    background-position: 45px -85px;
}
.postbd{
	display: none;
}
.ui.input input {
    border: none;
    background-color: #ffea00;
    box-shadow: -1px -1px 1px 1px rgba(255,234,0,0.2),0 0 0 1px rgba(255,234,0,0.1);
    width: 100%;
    position: absolute;
    top: 0;
    right: 0;
    margin: 0;
    max-width: 100%;
    -webkit-box-flex: 1;
    -webkit-flex: 1 0 auto;
    -ms-flex: 1 0 auto;
    flex: 1 0 auto;
    outline: 0;
    -webkit-tap-highlight-color: rgba(255,255,255,0);
    text-align: left;
    line-height: 1.2142em;
    padding: .67861429em 1em;
    border: 1px solid rgba(255,234,0,.15);
    color: rgba(0,0,0,.87);
    border-radius: .28571429rem;
    -webkit-transition: background-color .1s ease,box-shadow .1s ease,border-color .1s ease;
    transition: background-color .1s ease,box-shadow .1s ease,border-color .1s ease;
    box-shadow: none;
    text-align: center;
}
.ui.input input:focus, .ui.input.focus input {
    border-color: rgba(255,234,0,.35);
    background: #ffea00;
    color: rgba(0,0,0,.8);
    box-shadow: none;
}
.ui.input input:-webkit-input-placeholder {
　　color: #000 !important;
}
.ui.input.one{
	position: absolute;
    top: 270px;
    width: 180px;
    left: 50%;
    margin-left: -80px;
}
.ui.input.two{
	position: absolute;
    top: 312px;
    left: 50%;
    width: 180px;
    margin-left: -80px;
}
.ui.input.three{
	position: absolute;
    top: 354px;
    left: 50%;
    width: 180px;
    margin-left: -80px;
}
.submitbtn{
	position: absolute;
    top: 430px;
    width: 80px;
    height: 34px;
    background: #ffea00;
    left: 120px;
    box-shadow: none !important;
    border: 1px solid rgba(255,234,0,.15);
    color: rgba(0,0,0,.87);
    border-radius: .28571429rem;
    -webkit-transition: background-color .1s ease,box-shadow .1s ease,border-color .1s ease;
    transition: background-color .1s ease,box-shadow .1s ease,border-color .1s ease;
    box-shadow: none;
}
input,input:focus,input:active{
	user-select: text;
}
.postbd p{
	font-size: 13px;
    width: 100%;
    position: absolute;
    top: 403px;
    text-align: center;
}
@-webkit-keyframes swipe {
		0%{-webkit-transform:translateY(40px);opacity:0}
		60%{-webkit-transform:translateY(12px);opacity:1}
		100%{-webkit-transform:translateY(0px);opacity:0}
	}
	@-moz-keyframes swipe {
		0%{-webkit-transform:translateY(40px);opacity:0}
		60%{-webkit-transform:translateY(12px);opacity:1}
		100%{-webkit-transform:translateY(0px);opacity:0}
	}
	@keyframes swipe {
		0%{-webkit-transform:translateY(40px);opacity:0}
		60%{-webkit-transform:translateY(12px);opacity:1}
		100%{-webkit-transform:translateY(0px);opacity:0}
	}
	.swipe{
		opacity: 0;
	}
.current .swipe { 
	position: absolute; 
	width: 28px; 
	height: 16px; 
	bottom: 20px; 
	left: 50%; 
	margin-left: -14px;
	z-index:4;
	animation: swipe 1.5s linear infinite;
  -webkit-animation: swipe 1.5s linear infinite; 
  animation-delay:22s !important;
	-webkit-animation-delay:22s !important;
}
@-webkit-keyframes btright {
 	0% {
	 right: -100%;
	}
	20%{
		right:78px;
	}
	80%{
		right:78px;
	}
	100%{
		right: 100%;
	}
}
 @keyframes btright {
 	0% {
	 right: -100%;
	}
	20%{
		right:78px;
	}
	80%{
		right:78px;
	}
	100%{
		right: 100%;
	}
}
@-webkit-keyframes btrightt {
 	0% {
	 right: -100%;
	}
	30%{
		right:78px;
	}
	70%{
		right:78px;
	}
	100%{
		right: 100%;
	}
}
 @keyframes btrightt {
 	0% {
	 right: -100%;
	}
	30%{
		right:78px;
	}
	70%{
		right:78px;
	}
	100%{
		right: 100%;
	}
}
@-webkit-keyframes btrightl {
 	0% {
	 right: -100%;
	}
	100%{
		right:78px;
	}
}
 @keyframes btrightl {
 	0% {
	 right: -100%;
	}
	100%{
		right:78px;
	}
}
.current .page-logo{
	animation: 0.4s scale-to-zero-with-left cubic-bezier(.17, .67, .11, .93) forwards;
	-webkit-animation: 0.4s scale-to-zero-with-left cubic-bezier(.17, .67, .11, .93) forwards;
}
@keyframes scale-to-zero-with-left {
	0% {
		transform: translate3d(0%, 0, 0) scale(20);
		opacity: 0;
	}
	50% {
		opacity: 0.3;
	}
	100% {
		transform: translate3d(0%, 0, 0) scale(1);
		opacity: 1;
	}
}
@-webkit-keyframes scale-to-zero-with-left {
	0% {
	-webkit-transform: translate3d(0%, 0, 0) scale(20);
		opacity: 0;
	}
	50% {
		opacity: 0.3;
	}
	100% {
		-webkit-transform: translate3d(0%, 0, 0) scale(1);
		opacity: 1;
	}
}
</style>
{% endblock %}
{% block layout_js %}
<script type="text/javascript">
    /* 加载 */
    var basePath = "{{ app_url_packaged }}/images/promo/mini/";
    if (!(typeof webpsupport == 'function')) {
        var webpsupport = function (cb) {
            cb();
        }
    }
    webpsupport(function (webpa) {
    var loader = new WxMoment.Loader(),
     fileList =[
		'loading2.jpg','p1_1.jpg','p2.jpg','p3.jpg','p4_1.jpg','p5_1.jpg','p6_1.jpg','p7_1.jpg','p8_1.jpg','p9_1.jpg','jb1_2.png','jb2.png','jb3.png','jb4.png','jb5.png','jb6.png'
	];
     
     for (var i = 0; i < fileList.length; i++) {
         var basename = fileList[i].substring(fileList[i].lastIndexOf('/') + 1);

         if (webpa && img_map && (basename in img_map) && img_map[basename]) { //if webp
             var path = fileList[i].replace(/\.\w+/, '.webp');
         } else {
             var path = fileList[i];
         }

         loader.addImage(basePath + path);
         //$('#app_bgm').get(0).pause();
         $('#app_bgm').get(0).play();
     }

     loader.addCompletionListener(function () {
         $('.loading').remove();
         $('.screen').eq(0).addClass('current');
         $('.wrap').show();
         //$('#app_bgm').get(0).play();
         $('.music').show();
     });

     //loading 进度监听
     loader.addProgressListener(function (e) {
         var percentUp = Math.round((e.completedCount / e.totalCount) * 100), //正序, 1-100
             progressDown = 100 - percentUp;                                   //倒序, 100-1
         $('.loading-num').text(percentUp + '%');
     });

     //启动
     loader.start();
    });
    $('.fenxia').click(function(){
    	$('.fenh5').css('display','block');
    	$('.music').css('display','none');
    });
    $('.fenh5').click(function(){
    	$(this).css('display','none');
    	$('.music').css('display','block');
    });
    function hdsuccess(){
    	$('.fenxia,.fenh5,.word').css('display','none');
        $('.postbd').css('display','block');
        $('.music').css('display','block');
    }
    $("input").focus(function(){
		$(".ui.input,.submitbtn,p").css("margin-top","-200px");
	});
	$("input").blur(function(){
		$(".ui.input,.submitbtn,p").css("margin-top","0");
	});
    // 微信分享统计
    var m_name = '大咖齐聚，马力出行';
    var img_url = '{{ app_url_packaged }}/images/promo/mini/ym.jpg';
    var link = '{{ app_url_wap }}/promo/ym';
    var desc_str = '雷军、郭台铭、徐小平都投资的电单车——云马mini可折叠电动自行车，这个夏天只炫彩不炎热';

    wx.config({
        debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
        appId: '{{ app_id }}', // 必填，公众号的唯一标识
        timestamp: {{ timestamp }}, // 必填，生成签名的时间戳
        nonceStr: '{{ wxnonceStr }}', // 必填，生成签名的随机串
        signature: '{{ wxSha1 }}',// 必填，签名，见附录1
        jsApiList: ['onMenuShareTimeline', 'onMenuShareAppMessage', 'onMenuShareQQ', 'onMenuShareWeibo', 'hideMenuItems'] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2
   });

	wx.ready(function(){
    // 2.1 监听“分享给朋友”，按钮点击、自定义分享内容及分享结果接口
     wx.onMenuShareAppMessage({
      title: m_name,
      desc: desc_str,
      link: link,
      imgUrl: img_url,
      success: function (res) {
        record_share_num();
        hdsuccess();
      }
    });      

    // 2.2 监听“分享到朋友圈”按钮点击、自定义分享内容及分享结果接口
    wx.onMenuShareTimeline({
      title: m_name,
      desc: desc_str,
      link: link,
      imgUrl: img_url,
      success: function (res) {
        record_share_num();
        hdsuccess();
      }
    });

    // 2.3 监听“分享到QQ”按钮点击、自定义分享内容及分享结果接口
    wx.onMenuShareQQ({
      title: m_name,
      desc: desc_str,
      link: link,
      imgUrl: img_url,
      success: function (res) {
        record_share_num();
       hdsuccess();
      }
    });

    // 2.4 监听“分享到微博”按钮点击、自定义分享内容及分享结果接口
    wx.onMenuShareWeibo({
      title: m_name,
      desc: desc_str,
      link: link,
      imgUrl: img_url,
      success: function (res) {
        record_share_num();
        hdsuccess();
      }
    });
  });

  //记录分享数
  function record_share_num(){
    var url = '{{ app_url_wap }}/app/site/promo/ajax_stat_sum_record';
    $.get(url, { target_id: 23, count_name:'count', type: 4, kind:4 });
  }

    $(function(e){
        $('.submitbtn').click(function(){
            var target_id = $('input[name=target_id]').val();   
            var event = $('input[name=event]').val(); 
            var realname = $('input[name=realname]').val(); 
            var phone = $('input[name=phone]').val(); 
            var address = $('input[name=address]').val();

            var url = "{{ app_url_wap }}/app/wap/promo_func/save_subject_sign";
            $.post(url, {target_id: target_id, event:event, realname:realname, phone:phone, address:address}, function(result){
                if(result.success){
                    alert('参与成功！');
                    window.location.reload();
                }else{
                    alert(result.message);
                    return;
                }
            }, 'json');
        });
        
    });

</script>

{% endblock %}
{% block content %}
<img src="{{ app_url_packaged }}/images/promo/mini/ym.jpg" style="display:none;">
<div class="wrap"  style="display: none">
	<section class="screen screen1">
		<div class="screen__bg"></div>
	</section>
	<section class="screen screen2">
		<div class="screen__bg"></div>
		<div class="screen__inner">
			<div class="p2_bg"></div>
			<div class="pw jb_1"></div>
			<div class="pw jb_2"></div>
			<div class="pw jb_3"></div>
			<div class="pw jb_4"></div>
			<div class="pw jb_5"></div>
			<div class="pw jb_6"></div>
			<div class="pw jb_7"></div>
			<div class="pw jb_8"></div>
			<div class="pw jb_9"></div>
			<div class="pw jb_10"></div>
			<div class="pw jb_11"></div>
			<div class="pw jb_12"></div>
			<img class="swipe" src="https://s3.taihuoniao.com/images/swipe.png" width="28" height="16"/>
		</div>
	</section>
	<section class="screen screen3">
		<div class="screen__bg"></div>
	</section>
	<section class="screen screen4">
		<div class="screen__bg"></div>
	</section>
	<section class="screen screen5">
		<div class="screen__bg"></div>
	</section>
	<section class="screen screen6">
		<div class="screen__bg"></div>
	</section>
	<section class="screen screen7">
		<div class="screen__bg"></div>
	</section>
	<section class="screen screen8">
		<div class="screen__bg"></div>
		<div class="screen__inner">
			<div class="p8_bg"></div>
			<a class="p8_sy page-logo" href="http://m.taihuoniao.com/try/view-52118.html" target="_blank"></a>
			<a class="p8_yy page-logo" href="http://z.jd.com/project/details/60196.html" target="_blank"></a>
		</div>
	</section>
	<section class="screen screen9">
		<div class="screen__bg"></div>
		<div class="screen__inner">
			<div class="p9_bg"></div>
			<div class="fenxia"></div>
			<div class="word"></div>
			<div class="postbd">
			<!-- 表单 -->
				<form action="javascript:void(0);">
                    <input type="hidden" name="event" value="4" />
                    <input type="hidden" name="target_id" value="11" />
					<div class="ui input one">
						<input type="text" name="realname" placeholder="姓名">
					</div>
					<div class="ui input two">
						<input type="text" name="phone" placeholder="电话">
					</div>
					<div class="ui input three">
						<input type="text" name="address" placeholder="地址">
					</div>
					<p>留下您的联系方式，用于抽奖哟！</p>
					<button class="submitbtn" type="submit">提交</button>
				</form>
			</div>
		</div>
		<div class="fenh5"></div>
	</section>
</div>
<div class="music playing" style="display:none;"></div>
<audio id="app_bgm" src="https://s3.taihuoniao.com/wechat/js/ym.mp3" loop="true" autoplay></audio>
{% endblock %}
