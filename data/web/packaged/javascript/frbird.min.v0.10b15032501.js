var phenix={visitor:{},url:{},redirect:function(a,b){setTimeout(function(){window.location=a},b)},show_error_note:function(a,b){a='<div class="content"><i class="remove sign icon"></i>'+a+"</div>",phenix.show_notify_bar(a,"error",b)},show_ok_note:function(a,b){a='<div class="content"><i class="checkmark icon"></i>'+a+"</div>",phenix.show_notify_bar(a,"ok",b)},show_notify_bar:function(a,b,c){var d;b&&"ok"!=b?(b="error",d="error"):(b="ok",d="success"),$.gritter.add({title:"",text:a,time:c,class_name:d})}};phenix.show_error_message=function(a,b){var c='<ul class="list">';$.isArray(a)?$.each(a,function(a,b){c+="<li>"+b+"</li>"}):c+="<li>"+a+"</li>",c+="</ul>",$("<div/>").addClass("ui danger message").html(c).prependTo(b)},phenix.show_ok_message=function(a){alert(a)},phenix.before_submit=function(){return $(".ui.submit.button").addClass("loading"),$(".ui.error.message").remove(),!0},phenix.after_submit=function(){return $(".ui.submit.button").removeClass("loading"),!0},phenix.initial=function(){$("a.confirm-request").livequery(function(){$(this).click(function(){return confirm("确认执行这个操作吗?")&&$.get($(this).attr("href")),!1})}),$("a.ajax").livequery(function(){$(this).click(function(){var a=$(this).attr("href");return phenix.visitor.is_login?($.get(a),!1):(phenix.show_login_box(a),!1)})}),$(".ui.message .close").livequery(function(){$(this).on("click",function(){$(this).closest(".ui.message").fadeOut("slow")})}),$(".ui.basket.button").livequery(function(){$(this).on("click",function(){var a=$(this).data("url");phenix.redirect(a)})}),$("#shopping-basket .ui.close.button").livequery(function(){$(this).bind("click",function(){var a=$(this).data("sku");return $.get(phenix.url.domain+"/shopping/remove",{sku:a}),!1})}),$("#searchbar i.search.icon").click(function(){$("#searchbar").submit()}),$(".ui.cancel.button").bind("click",function(){window.location.href=document.referrer}),$(".ui.pop").popup(),$(".ui.checkbox").checkbox(),$(".ui.selection.dropdown").dropdown(),$(".ui.dropdown").dropdown({on:"hover"}),$(".ui.wechat.button").click(function(){return $(".ui.wechat.modal").modal("show"),!1}),$(".ui.accordion").accordion(),$.scrollUp({scrollText:'<i class="angle up icon"></i>',className:"ui circular topup button",scrollTitle:!1}),phenix.showbox(),$(".promo .close-promo").click(function(){return $(".promo").slideUp("slow"),!1})},phenix.show_login_box=function(a){$("#loginbox-form").form({account:{identifier:"account",rules:[{type:"empty",prompt:"输入你注册时填写的邮件或手机号码"}]},password:{identifier:"password",rules:[{type:"empty",prompt:"输入正确的登录密码"},{type:"length[6]",prompt:"登录密码为必须6位以上字符"}]}},{inline:!0,onSuccess:function(b){b.preventDefault(),$(this).ajaxSubmit({dataType:"json",beforeSubmit:function(){phenix.before_submit()},success:function(c){phenix.after_submit(),c.is_error?($(b.target).addClass("error"),phenix.show_error_note(c.message)):($(".ui.loginbox.modal").modal("hide"),phenix.visitor=c.data,a&&$.get(a))}})}}),$(".ui.loginbox.modal").modal("show")},phenix.showbox=function(){$(".showbox").livequery(function(){$(this).click(function(){var a=this.hash&&this.hash.substr(1);return $("#"+a).toggle(),!1})})},phenix.doit=function(a,b,c){var d,e=$("#"+a),f=e.html();"undefined"==typeof c&&(c=1),parseInt(f)==b&&(f=0),d=parseInt(f)+c,isNaN(d)&&(d=0),b>d?(e.html(d.toString()),setTimeout("phenix.doit('"+a+"',"+b+","+c+")",1)):e.html(b.toString())},phenix.build_auth_page=function(){$("#login-form").form({account:{identifier:"account",rules:[{type:"empty",prompt:"请输入您注册时填写的邮件或手机号码"}]},password:{identifier:"password",rules:[{type:"empty",prompt:"请输入正确的登录密码"},{type:"length[6]",prompt:"登录密码为必须6位以上字符"}]}},{inline:!0,onSuccess:function(a){a.preventDefault(),$(this).ajaxSubmit({dataType:"json",beforeSubmit:function(){phenix.before_submit()},success:function(a){phenix.after_submit(),a.is_error?phenix.show_error_note(a.message,5e3):phenix.redirect(a.redirect_url)}})}}),$("#register-form").form({account:{identifier:"account",rules:[{type:"empty",prompt:"账户名称不能为空"}]},verify_code:{identifier:"verify_code",rules:[{type:"empty",prompt:"验证码不能为空"}]},password:{identifier:"password",rules:[{type:"empty",prompt:"请输入正确的登录密码"},{type:"length[6]",prompt:"登录密码必须6位以上字符"}]},password_confirm:{identifier:"password_confirm",rules:[{type:"empty",prompt:"请输入正确的确认密码"},{type:"match[password]",prompt:"两次输入密码不一致"}]}},{inline:!0,onSuccess:function(a){a.preventDefault(),$(a.target).ajaxSubmit({dataType:"json",beforeSubmit:function(){phenix.before_submit()},success:function(a){phenix.after_submit(),a.is_error?phenix.show_error_note(a.message,5e3):phenix.redirect(a.redirect_url)}})}})},phenix.hook_product_topic=function(){$("#topic-form").form({title:{identifier:"title",rules:[{type:"empty",prompt:"标题不能为空"},{type:"maxLength[40]",prompt:"内容不超过40字符"}]},description:{identifier:"description",rules:[{type:"empty",prompt:"评论内容不能为空"},{type:"maxLength[140]",prompt:"评论内容不超过140字符"}]}},{inline:!0,onSuccess:function(a){a.preventDefault(),$(a.target).ajaxSubmit()}})},phenix.hook_comment_page=function(){$("#comment-form").form({content:{identifier:"content",rules:[{type:"empty",prompt:"评论内容不能为空"},{type:"maxLength[140]",prompt:"评论内容不超过140字符"}]}},{inline:!0,onSuccess:function(a){a.preventDefault(),$(a.target).ajaxSubmit()}}).find(".submit.button").ajaxStart(function(){$(".ui.submit.button").addClass("loading")}).ajaxSuccess(function(){$(".ui.submit.button").removeClass("loading")}),$(".ui.reply.form").livequery(function(){$(this).form({content:{identifier:"content",rules:[{type:"empty",prompt:"评论内容不能为空"},{type:"maxLength[1400]",prompt:"评论内容不超过1400字符"}]}},{inline:!0,onSuccess:function(a){a.preventDefault(),$(a.target).ajaxSubmit()}})})},phenix.rebuild_batch_assets=function(a){var b=$("#batch_assets").val();if(b){var c=b.split(",");-1==$.inArray(a,c)&&(c.push(a),$("#batch_assets").val(c.join(",")))}else $("#batch_assets").val(a)},phenix.bind_share_list=function(a){var b=encodeURIComponent(document.location),c=encodeURIComponent(document.title.substring(0,100)),d=encodeURIComponent("太火鸟"),e="tShare",f="http://www.taihuoniao.com/",g=function(a,b){return["toolbar=0,status=0,resizable=1,width="+a+",height="+b+",left=",(screen.width-a)/2,",top=",(screen.height-b)/2].join("")};$("#wechat-share").click(function(){return $(".ui.qrcode.modal").modal("show"),!1}),$("#sina-share").click(function(){var d="http://v.t.sina.com.cn/share/share.php?url="+b+"&title="+c+"&pic="+a,f=g(607,523);return window.open(d,e,f),!1}),$("#o-share-weibo").click(function(){var d="http://v.t.sina.com.cn/share/share.php?url="+b+"&title="+c+"&pic="+a,f=g(607,523);return window.open(d,e,f),!1}),$("#tencent-share").click(function(){var d="http://v.t.qq.com/share/share.php?title="+c+"&url="+b+"&site="+f+"&pic="+a,h=g(634,668);return window.open(d,e,h),!1}),$("#douban-share").click(function(){var d="http://www.douban.com/recommend/?url="+b+"&title="+c+"&pic="+a,f=g(450,350);return window.open(d,e,f),!1}),$("#renren-share").click(function(){var d="http://share.renren.com/share/buttonshare?link="+b+"&title="+c+"&pic="+a,f=g(626,436);return window.open(d,e,f),!1}),$("#kaixin001-share").click(function(){var d="http://www.kaixin001.com/repaste/share.php?rurl="+b+"&rcontent="+b+"&rtitle="+c+"&pic="+a,f=g(540,342);return window.open(d,e,f),!1}),$("#netease-share").click(function(){var a="http://t.163.com/article/user/checkLogin.do?link="+b+"source="+d+"&info="+c+" "+b,f=g(642,468);return window.open(a,e,f),!1}),$("#facebook-share").click(function(){var a="http://facebook.com/share.php?u="+b+"&t="+c,d=g(626,436);return window.open(a,e,d),!1}),$("#twitter-share").click(function(){var a="http://twitter.com/share?url="+b+"&text="+c,d=g(500,375);return window.open(a,e,d),!1}),$("#delicious-share").click(function(){var a="http://delicious.com/post?url="+b+"&title="+c,d=g(550,550);return window.open(a,e,d),!1})},phenix.create_cookie=function(a,b,c,d,e){var f="";if(c){var g=new Date;g.setTime(g.getTime()+24*c*60*60*1e3),f="; expires="+g.toGMTString()}d=d?"; domain="+d:"",e="; path="+(e?e:"/"),document.cookie=a+"="+b+f+e+d},phenix.read_cookie=function(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){var e=c[d].replace(/^\s+/,"");if(0==e.indexOf(b))return e.substring(b.length)}return null},phenix.erase_cookie=function(a,b,c){create_cookie(a,"",-1,b,c)};var wps_width=0,wps_height=0,wps_ratio=1,scale_width=480,scale_height=0,crop_width=0,crop_height=0;phenix.hook_imgarea_select=function(){scale_height=parseInt(wps_height*scale_width/wps_width),ias=$("img#avatar-photo").imgAreaSelect({aspectRatio:"1:1",x1:0,y1:0,x2:300,y2:300,handles:!0,parent:"#select-area",fadeSpeed:200,instance:!0,onSelectChange:phenix.preview,onSelectEnd:phenix.updateAreaSelect})},phenix.preview=function(a,b){b.width&&b.height&&($("#x1").val(b.x1),$("#y1").val(b.y1),$("#x2").val(b.x2),$("#y2").val(b.y2),$("#w").val(b.width),$("#h").val(b.height))},phenix.updateAreaSelect=function(){},$.extend($.imgAreaSelect.prototype,{animateSelection:function(a,b,c,d,e){var f=$.extend($("<div/>")[0],{ias:this,start:this.getSelection(),end:{x1:a,y1:b,x2:c,y2:d}});$(f).animate({cur:1},{duration:e,step:function(a,b){var c=b.elem.start,d=b.elem.end,e=Math.round(c.x1+(d.x1-c.x1)*a),f=Math.round(c.y1+(d.y1-c.y1)*a),g=Math.round(c.x2+(d.x2-c.x2)*a),h=Math.round(c.y2+(d.y2-c.y2)*a);b.elem.ias.setSelection(e,f,g,h),b.elem.ias.update()}})}}),jQuery.extend(jQuery.fn.pickadate.defaults,{monthsFull:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthsShort:["一","二","三","四","五","六","七","八","九","十","十一","十二"],weekdaysFull:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],weekdaysShort:["日","一","二","三","四","五","六"],today:"今天",clear:"清除",firstDay:1,format:"yyyy-mm-dd",formatSubmit:"yyyy-mm-dd"}),function(a){a.fn.extend({insertAtCaret:function(b){var c=a(this)[0];if(document.selection)this.focus(),sel=document.selection.createRange(),sel.text=b,this.focus();else if(c.selectionStart||"0"==c.selectionStart){var d=c.selectionStart,e=c.selectionEnd,f=c.scrollTop;c.value=c.value.substring(0,d)+b+c.value.substring(e,c.value.length),this.focus(),c.selectionStart=d+b.length,c.selectionEnd=d+b.length,c.scrollTop=f}else this.value+=b,this.focus()}})}(jQuery);