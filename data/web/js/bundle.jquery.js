(function(b){b.notifybar={};b.show_notify_bar=function(c){var e=b.extend({},b.notifybar.defaults,c);if(!b(".jbar").length){a=setTimeout("$.remove_notify_bar()",e.time);var d=b(document.createElement("div")).addClass("jbar alert").addClass(e.class_name);if(e.removebutton){var g=b('<button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>');g.click(function(h){b.remove_notify_bar()})}else{d.css({cursor:"pointer"});d.click(function(h){b.remove_notify_bar()})}var f=e.container?b(e.container):b("#doc3");d.html(e.message).prepend(g).hide().appendTo(f).fadeIn("fast")}};var a;b.remove_notify_bar=function(){if(b(".jbar").length){clearTimeout(a);b(".jbar").fadeOut("fast",function(){b(this).remove()})}};b.notifybar.defaults={position:"top",removebutton:false,time:5000,class_name:"alert-warning"}})(jQuery);
/*
 * jQuery Taconite plugin - A port of the Taconite framework by Ryan Asleson and
 *     Nathaniel T. Schutta: http://taconite.sourceforge.net/
 *
 * Examples and documentation at: http://malsup.com/jquery/taconite/
 * Copyright (c) 2007-2011 M. Alsup
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 * Thanks to Kenton Simpson for contributing many good ideas!
 *
 * @version: 3.66  02-MAR-2013
 * @requires jQuery v1.3.2 or later
 */
(function(f){var e="3.66";var z=f.browser;if(!z){var w=navigator.userAgent.toLowerCase();var s=/(msie) ([\w.]+)/.exec(w)||!/compatible/.test(w)&&/(mozilla)/.exec(w)||[];z={version:s[2]};z[s[1]]=true}f.taconite=function(m){k(m)};f.taconite.debug=0;f.taconite.autodetect=true;f.taconite.defaults={cdataWrap:"div"};f.fn.replace=f.fn.replace||function(m){this.after(m);this.remove();return this};f.fn.replaceContent=f.fn.replaceContent||function(m){return this.empty().append(m)};f.expr[":"].taconiteTag=function(m){return m.taconiteTag===1};f.taconite.enableAutoDetection=function(m){f.taconite.autodetect=m;if(y){f.httpData=m?y:x}};var l=0;function i(){if(!f.taconite.debug||!window.console||!window.console.log){return}if(++l===1){i("Plugin Version: "+e)}window.console.log("[taconite] "+[].join.call(arguments,""))}var b=f.parseJSON||function(m){return window["eval"]("("+m+")")};function a(I,G,F){var E=I.getResponseHeader("content-type")||"",m=G==="xml"||!G&&E.indexOf("xml")>=0,H=m?I.responseXML:I.responseText;if(m&&H.documentElement.nodeName==="parsererror"){if(f.error){f.error("parsererror")}}if(F&&F.dataFilter){H=F.dataFilter(H,G)}if(typeof H==="string"){if(G==="json"||!G&&E.indexOf("json")>=0){H=b(H)}else{if(G==="script"||!G&&E.indexOf("javascript")>=0){f.globalEval(H)}}}return H}function D(F,E,m){if(y){return y(F,E,m)}return F.responseXML||F.responseText}function x(H,F,E){var m=H.getResponseHeader("content-type");if(f.taconite.debug){i("[AJAX response] content-type: ",m,";  status: ",H.status," ",H.statusText,";  has responseXML: ",H.responseXML!==null);i("type arg: "+F)}var G=D(H,F,E);if(G&&G.documentElement&&G.documentElement.nodeName!="parsererror"){f.taconite(G)}else{if(typeof G=="string"){if(/taconite/.test(G)){f.taconite(G)}}else{i("jQuery core httpData returned: "+G);i('httpData: response is not XML (or not "valid" XML)')}}return G}if(f.ajaxPrefilter){f.ajaxPrefilter(function(m,F,E){E.success(function(I,G,H){if(f.taconite.autodetect){x(H,m.dataType,m)}})})}var y=f.httpData;if(f.httpData){f.httpData=x}var g={json:o},q,h;f.taconite.registerParser=function(E,m){g[E]=m};function n(m,E){var F=E,G=g[m];if(f.isFunction(G)){return G(E)}else{throw'No parser registered for rawData of type "'+m+'"'}}function o(m){return b(m)}function k(G){var E=true,H;try{if(typeof G=="string"){G=j(G)}if(!(G&&G.documentElement)){i("$.taconite invoked without valid document; nothing to process");return false}var m=G.documentElement.tagName;i("XML document root: ",m);var F=f("taconite",G)[0];if(!F){i("document does not contain <taconite> element; nothing to process");return false}f.event.trigger("taconite-begin-notify",[F]);E=t(F)}catch(I){E=H=I}if(h){f.event.trigger("taconite-rawdata-notify",[q])}f.event.trigger("taconite-complete-notify",[G,!!E,E===true?null:E]);if(H){throw H}}function j(E){var G;i("attempting string to document conversion");try{if(window.DOMParser){var H=new DOMParser();G=H.parseFromString(E,"text/xml")}else{G=f("<xml>")[0];G.async="false";G.loadXML(E)}}catch(F){if(window.console&&window.console.error){window.console.error("[taconite] ERROR parsing XML string for conversion: "+F)}throw F}var m=G&&G.documentElement&&G.documentElement.tagName!="parsererror";i("conversion ",m?"successful!":"FAILED");return G}function t(m){try{var E=new Date().getTime();p(m.childNodes);f.taconite.lastTime=(new Date().getTime())-E;i("time to process response: "+f.taconite.lastTime+"ms")}catch(F){if(window.console&&window.console.error){window.console.error("[taconite] ERROR processing document: "+F)}throw F}return true}function p(G){q={};h=false;var J={wrap:1};var Q=0;var V,O,H,T,S,N,F,K,E,M,P,L,U;for(T=0;T<G.length;T++){if(G[T].nodeType!=1){continue}var m=G[T],R=m.tagName;if(R=="eval"){N=(m.firstChild?m.firstChild.nodeValue:null);i('invoking "eval" command: ',N);if(N){f.globalEval(N)}continue}if(R=="rawData"){K=(m.firstChild?m.firstChild.nodeValue:null);E=m.getAttribute("type");i("rawData ("+E+"): ",K);var I=m.getAttribute("namespace")||"none";if(!q[I]){q[I]=[]}q[I].push({data:n(E,K),type:E,name:m.getAttribute("name")||null,raw:K});if(!h){h=true}continue}M=m.getAttribute("select");P=f(M);if(!P[0]){i("No matching targets for selector: ",M);continue}L=m.getAttribute("cdataWrap")||f.taconite.defaults.cdataWrap;V=[];if(m.childNodes.length>0){Q=1;for(S=0,F=[];S<m.childNodes.length;S++){F[S]=C(m.childNodes[S],L)}V.push(J[R]?A(F):F)}O=m.getAttribute("name");H=m.getAttribute("value");if(O!==null){V.push(O)}if(H!==null){U=Number(H);if(H==U){H=U}V.push(H)}for(S=1;true;S++){H=m.getAttribute("arg"+S);if(H===null){break}if(H.length){U=Number(H);if(H==U){H=U}}V.push(H)}if(f.taconite.debug){v(M,R,V,F)}P[R].apply(P,V)}if(Q){u()}}function v(I,H,m,G){var F="...";if(!G){F="";for(var E=0;E<m.length;E++){val=m[E];if(E>0){F+=","}if(typeof val=="string"){F+=("'"+val+"'")}else{F+=val}}}i("invoking command: $('",I,"').",H,"("+F+")")}function u(){if(z.mozilla){return}f("select:taconiteTag").each(function(){var m=this;f("option:taconiteTag",this).each(function(){this.setAttribute("selected","selected");this.taconiteTag=null;if(m.type=="select-one"){var E=f("option",m).index(this);m.selectedIndex=E}});this.taconiteTag=null})}function A(F){for(var E=0,m=[];E<F.length;E++){if(F[E].nodeType==1){m.push(F[E])}}return m}function C(F,m){var E=F.nodeType;if(E==1){return r(F,m)}if(E==3){return B(F.nodeValue)}if(E==4){return c(F.nodeValue,m)}return null}function c(H,m){var G=document.createElement(m);var F=f(G)[m=="script"?"text":"html"](H);var E=F.children();if(E.size()==1){return E[0]}return G}function B(m){if(z.msie){m=m.replace(/\n/g,"\r").replace(/\s+/g," ")}return document.createTextNode(m)}function r(G,m){var I,L=G.tagName.toLowerCase();if(z.msie&&z.version<9){var J=G.getAttribute("type");if(L=="table"||J=="radio"||J=="checkbox"||L=="button"||(L=="select"&&G.getAttribute("multiple"))){I=document.createElement("<"+L+" "+d(null,G,true)+">")}}if(!I){I=document.createElement(L);d(I,G)}if(z.msie&&L=="td"){var F=G.getAttribute("colspan");if(F){I.colSpan=parseInt(F,10)}}if(z.msie&&!I.canHaveChildren){if(G.childNodes.length>0){I.text=G.text}}else{for(var H=0,K=G.childNodes.length;H<K;H++){var E=C(G.childNodes[H],m);if(E){I.appendChild(E)}}}if(!z.mozilla){if(L=="select"||(L=="option"&&G.getAttribute("selected"))){I.taconiteTag=1}}return I}function d(G,J,I){for(var H=0,m="";H<J.attributes.length;H++){var E=J.attributes[H],K=f.trim(E.name),F=f.trim(E.value);if(I){m+=(K+'="'+F+'" ')}else{if(K=="style"){G.style.cssText=F;G.setAttribute(K,F)}else{f.attr(G,K,F)}}}return m}})(jQuery);(function(a){a.extend(a.fn,{validate:function(b){if(!this.length){b&&b.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing");return}var c=a.data(this[0],"validator");if(c){return c}this.attr("novalidate","novalidate");c=new a.validator(b,this[0]);a.data(this[0],"validator",c);if(c.settings.onsubmit){var d=this.find("input, button");d.filter(".cancel").click(function(){c.cancelSubmit=true});if(c.settings.submitHandler){d.filter(":submit").click(function(){c.submitButton=this})}this.submit(function(e){if(c.settings.debug){e.preventDefault()}function f(){if(c.settings.submitHandler){if(c.submitButton){var g=a("<input type='hidden'/>").attr("name",c.submitButton.name).val(c.submitButton.value).appendTo(c.currentForm)}c.settings.submitHandler.call(c,c.currentForm);if(c.submitButton){g.remove()}return false}return true}if(c.cancelSubmit){c.cancelSubmit=false;return f()}if(c.form()){if(c.pendingRequest){c.formSubmitted=true;return false}return f()}else{c.focusInvalid();return false}})}return c},valid:function(){if(a(this[0]).is("form")){return this.validate().form()}else{var c=true;var b=a(this[0].form).validate();this.each(function(){c&=b.element(this)});return c}},removeAttrs:function(d){var b={},c=this;a.each(d.split(/\s/),function(e,f){b[f]=c.attr(f);c.removeAttr(f)});return b},rules:function(e,b){var g=this[0];if(e){var d=a.data(g.form,"validator").settings;var i=d.rules;var j=a.validator.staticRules(g);switch(e){case"add":a.extend(j,a.validator.normalizeRule(b));i[g.name]=j;if(b.messages){d.messages[g.name]=a.extend(d.messages[g.name],b.messages)}break;case"remove":if(!b){delete i[g.name];return j}var h={};a.each(b.split(/\s/),function(k,l){h[l]=j[l];delete j[l]});return h}}var f=a.validator.normalizeRules(a.extend({},a.validator.metadataRules(g),a.validator.classRules(g),a.validator.attributeRules(g),a.validator.staticRules(g)),g);if(f.required){var c=f.required;delete f.required;f=a.extend({required:c},f)}return f}});a.extend(a.expr[":"],{blank:function(b){return !a.trim(""+b.value)},filled:function(b){return !!a.trim(""+b.value)},unchecked:function(b){return !b.checked}});a.validator=function(b,c){this.settings=a.extend(true,{},a.validator.defaults,b);this.currentForm=c;this.init()};a.validator.format=function(b,c){if(arguments.length==1){return function(){var d=a.makeArray(arguments);d.unshift(b);return a.validator.format.apply(this,d)}}if(arguments.length>2&&c.constructor!=Array){c=a.makeArray(arguments).slice(1)}if(c.constructor!=Array){c=[c]}a.each(c,function(d,e){b=b.replace(new RegExp("\\{"+d+"\\}","g"),e)});return b};a.extend(a.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:true,errorContainer:a([]),errorLabelContainer:a([]),onsubmit:true,ignore:"",ignoreTitle:false,onfocusin:function(b,c){this.lastActive=b;if(this.settings.focusCleanup&&!this.blockFocusCleanup){this.settings.unhighlight&&this.settings.unhighlight.call(this,b,this.settings.errorClass,this.settings.validClass);this.addWrapper(this.errorsFor(b)).hide()}},onfocusout:function(b,c){if(!this.checkable(b)&&(b.name in this.submitted||!this.optional(b))){this.element(b)}},onkeyup:function(b,c){if(b.name in this.submitted||b==this.lastElement){this.element(b)}},onclick:function(b,c){if(b.name in this.submitted){this.element(b)}else{if(b.parentNode.name in this.submitted){this.element(b.parentNode)}}},highlight:function(d,b,c){if(d.type==="radio"){this.findByName(d.name).addClass(b).removeClass(c)}else{a(d).addClass(b).removeClass(c)}},unhighlight:function(d,b,c){if(d.type==="radio"){this.findByName(d.name).removeClass(b).addClass(c)}else{a(d).removeClass(b).addClass(c)}}},setDefaults:function(b){a.extend(a.validator.defaults,b)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:a.validator.format("Please enter no more than {0} characters."),minlength:a.validator.format("Please enter at least {0} characters."),rangelength:a.validator.format("Please enter a value between {0} and {1} characters long."),range:a.validator.format("Please enter a value between {0} and {1}."),max:a.validator.format("Please enter a value less than or equal to {0}."),min:a.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:false,prototype:{init:function(){this.labelContainer=a(this.settings.errorLabelContainer);this.errorContext=this.labelContainer.length&&this.labelContainer||a(this.currentForm);this.containers=a(this.settings.errorContainer).add(this.settings.errorLabelContainer);this.submitted={};this.valueCache={};this.pendingRequest=0;this.pending={};this.invalid={};this.reset();var b=(this.groups={});a.each(this.settings.groups,function(e,f){a.each(f.split(/\s/),function(h,g){b[g]=e})});var d=this.settings.rules;a.each(d,function(e,f){d[e]=a.validator.normalizeRule(f)});function c(g){var f=a.data(this[0].form,"validator"),e="on"+g.type.replace(/^validate/,"");f.settings[e]&&f.settings[e].call(f,this[0],g)}a(this.currentForm).validateDelegate("[type='text'], [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'] ","focusin focusout keyup",c).validateDelegate("[type='radio'], [type='checkbox'], select, option","click",c);if(this.settings.invalidHandler){a(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)}},form:function(){this.checkForm();a.extend(this.submitted,this.errorMap);this.invalid=a.extend({},this.errorMap);if(!this.valid()){a(this.currentForm).triggerHandler("invalid-form",[this])}this.showErrors();return this.valid()},checkForm:function(){this.prepareForm();for(var b=0,c=(this.currentElements=this.elements());c[b];b++){this.check(c[b])}return this.valid()},element:function(c){c=this.validationTargetFor(this.clean(c));this.lastElement=c;this.prepareElement(c);this.currentElements=a(c);var b=this.check(c);if(b){delete this.invalid[c.name]}else{this.invalid[c.name]=true}if(!this.numberOfInvalids()){this.toHide=this.toHide.add(this.containers)}this.showErrors();return b},showErrors:function(c){if(c){a.extend(this.errorMap,c);this.errorList=[];for(var b in c){this.errorList.push({message:c[b],element:this.findByName(b)[0]})}this.successList=a.grep(this.successList,function(d){return !(d.name in c)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){if(a.fn.resetForm){a(this.currentForm).resetForm()}this.submitted={};this.lastElement=null;this.prepareForm();this.hideErrors();this.elements().removeClass(this.settings.errorClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(d){var c=0;for(var b in d){c++}return c},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return this.size()==0},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid){try{a(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(b){}}},findLastActive:function(){var b=this.lastActive;return b&&a.grep(this.errorList,function(c){return c.element.name==b.name}).length==1&&b},elements:function(){var c=this,b={};return a(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){!this.name&&c.settings.debug&&window.console&&console.error("%o has no name assigned",this);if(this.name in b||!c.objectLength(a(this).rules())){return false}b[this.name]=true;return true})},clean:function(b){return a(b)[0]},errors:function(){return a(this.settings.errorElement+"."+this.settings.errorClass,this.errorContext)},reset:function(){this.successList=[];this.errorList=[];this.errorMap={};this.toShow=a([]);this.toHide=a([]);this.currentElements=a([])},prepareForm:function(){this.reset();this.toHide=this.errors().add(this.containers)},prepareElement:function(b){this.reset();this.toHide=this.errorsFor(b)},check:function(c){c=this.validationTargetFor(this.clean(c));var h=a(c).rules();var d=false;for(var i in h){var g={method:i,parameters:h[i]};try{var b=a.validator.methods[i].call(this,c.value.replace(/\r/g,""),c,g.parameters);if(b=="dependency-mismatch"){d=true;continue}d=false;if(b=="pending"){this.toHide=this.toHide.not(this.errorsFor(c));return}if(!b){this.formatAndAdd(c,g);return false}}catch(f){this.settings.debug&&window.console&&console.log("exception occured when checking element "+c.id+", check the '"+g.method+"' method",f);throw f}}if(d){return}if(this.objectLength(h)){this.successList.push(c)}return true},customMetaMessage:function(b,d){if(!a.metadata){return}var c=this.settings.meta?a(b).metadata()[this.settings.meta]:a(b).metadata();return c&&c.messages&&c.messages[d]},customMessage:function(c,d){var b=this.settings.messages[c];return b&&(b.constructor==String?b:b[d])},findDefined:function(){for(var b=0;b<arguments.length;b++){if(arguments[b]!==undefined){return arguments[b]}}return undefined},defaultMessage:function(b,c){return this.findDefined(this.customMessage(b.name,c),this.customMetaMessage(b,c),!this.settings.ignoreTitle&&b.title||undefined,a.validator.messages[c],"<strong>Warning: No message defined for "+b.name+"</strong>")},formatAndAdd:function(c,e){var d=this.defaultMessage(c,e.method),b=/\$?\{(\d+)\}/g;if(typeof d=="function"){d=d.call(this,e.parameters,c)}else{if(b.test(d)){d=jQuery.format(d.replace(b,"{$1}"),e.parameters)}}this.errorList.push({message:d,element:c});this.errorMap[c.name]=d;this.submitted[c.name]=d},addWrapper:function(b){if(this.settings.wrapper){b=b.add(b.parent(this.settings.wrapper))}return b},defaultShowErrors:function(){for(var c=0;this.errorList[c];c++){var b=this.errorList[c];this.settings.highlight&&this.settings.highlight.call(this,b.element,this.settings.errorClass,this.settings.validClass);this.showLabel(b.element,b.message)}if(this.errorList.length){this.toShow=this.toShow.add(this.containers)}if(this.settings.success){for(var c=0;this.successList[c];c++){this.showLabel(this.successList[c])}}if(this.settings.unhighlight){for(var c=0,d=this.validElements();d[c];c++){this.settings.unhighlight.call(this,d[c],this.settings.errorClass,this.settings.validClass)}}this.toHide=this.toHide.not(this.toShow);this.hideErrors();this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return a(this.errorList).map(function(){return this.element})},showLabel:function(c,d){var b=this.errorsFor(c);if(b.length){b.removeClass(this.settings.validClass).addClass(this.settings.errorClass);b.attr("generated")&&b.html(d)}else{b=a("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(c),generated:true}).addClass(this.settings.errorClass).html(d||"");if(this.settings.wrapper){b=b.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()}if(!this.labelContainer.append(b).length){this.settings.errorPlacement?this.settings.errorPlacement(b,a(c)):b.insertAfter(c)}}if(!d&&this.settings.success){b.text("");typeof this.settings.success=="string"?b.addClass(this.settings.success):this.settings.success(b)}this.toShow=this.toShow.add(b)},errorsFor:function(c){var b=this.idOrName(c);return this.errors().filter(function(){return a(this).attr("for")==b})},idOrName:function(b){return this.groups[b.name]||(this.checkable(b)?b.name:b.id||b.name)},validationTargetFor:function(b){if(this.checkable(b)){b=this.findByName(b.name).not(this.settings.ignore)[0]}return b},checkable:function(b){return/radio|checkbox/i.test(b.type)},findByName:function(b){var c=this.currentForm;return a(document.getElementsByName(b)).map(function(d,e){return e.form==c&&e.name==b&&e||null})},getLength:function(c,b){switch(b.nodeName.toLowerCase()){case"select":return a("option:selected",b).length;case"input":if(this.checkable(b)){return this.findByName(b.name).filter(":checked").length}}return c.length},depend:function(c,b){return this.dependTypes[typeof c]?this.dependTypes[typeof c](c,b):true},dependTypes:{"boolean":function(c,b){return c},string:function(c,b){return !!a(c,b.form).length},"function":function(c,b){return c(b)}},optional:function(b){return !a.validator.methods.required.call(this,a.trim(b.value),b)&&"dependency-mismatch"},startRequest:function(b){if(!this.pending[b.name]){this.pendingRequest++;this.pending[b.name]=true}},stopRequest:function(b,c){this.pendingRequest--;if(this.pendingRequest<0){this.pendingRequest=0}delete this.pending[b.name];if(c&&this.pendingRequest==0&&this.formSubmitted&&this.form()){a(this.currentForm).submit();this.formSubmitted=false}else{if(!c&&this.pendingRequest==0&&this.formSubmitted){a(this.currentForm).triggerHandler("invalid-form",[this]);this.formSubmitted=false}}},previousValue:function(b){return a.data(b,"previousValue")||a.data(b,"previousValue",{old:null,valid:true,message:this.defaultMessage(b,"remote")})}},classRuleSettings:{required:{required:true},email:{email:true},url:{url:true},date:{date:true},dateISO:{dateISO:true},dateDE:{dateDE:true},number:{number:true},numberDE:{numberDE:true},digits:{digits:true},creditcard:{creditcard:true}},addClassRules:function(b,c){b.constructor==String?this.classRuleSettings[b]=c:a.extend(this.classRuleSettings,b)},classRules:function(c){var d={};var b=a(c).attr("class");b&&a.each(b.split(" "),function(){if(this in a.validator.classRuleSettings){a.extend(d,a.validator.classRuleSettings[this])}});return d},attributeRules:function(c){var e={};var b=a(c);for(var f in a.validator.methods){var d;if(f==="required"&&typeof a.fn.prop==="function"){d=b.prop(f)}else{d=b.attr(f)}if(d){e[f]=d}else{if(b[0].getAttribute("type")===f){e[f]=true}}}if(e.maxlength&&/-1|2147483647|524288/.test(e.maxlength)){delete e.maxlength}return e},metadataRules:function(b){if(!a.metadata){return{}}var c=a.data(b.form,"validator").settings.meta;return c?a(b).metadata()[c]:a(b).metadata()},staticRules:function(c){var d={};var b=a.data(c.form,"validator");if(b.settings.rules){d=a.validator.normalizeRule(b.settings.rules[c.name])||{}}return d},normalizeRules:function(c,b){a.each(c,function(f,e){if(e===false){delete c[f];return}if(e.param||e.depends){var d=true;switch(typeof e.depends){case"string":d=!!a(e.depends,b.form).length;break;case"function":d=e.depends.call(b,b);break}if(d){c[f]=e.param!==undefined?e.param:true}else{delete c[f]}}});a.each(c,function(d,e){c[d]=a.isFunction(e)?e(b):e});a.each(["minlength","maxlength","min","max"],function(){if(c[this]){c[this]=Number(c[this])}});a.each(["rangelength","range"],function(){if(c[this]){c[this]=[Number(c[this][0]),Number(c[this][1])]}});if(a.validator.autoCreateRanges){if(c.min&&c.max){c.range=[c.min,c.max];delete c.min;delete c.max}if(c.minlength&&c.maxlength){c.rangelength=[c.minlength,c.maxlength];delete c.minlength;delete c.maxlength}}if(c.messages){delete c.messages}return c},normalizeRule:function(c){if(typeof c=="string"){var b={};a.each(c.split(/\s/),function(){b[this]=true});c=b}return c},addMethod:function(b,d,c){a.validator.methods[b]=d;a.validator.messages[b]=c!=undefined?c:a.validator.messages[b];if(d.length<3){a.validator.addClassRules(b,a.validator.normalizeRule(b))}},methods:{required:function(c,b,e){if(!this.depend(e,b)){return"dependency-mismatch"}switch(b.nodeName.toLowerCase()){case"select":var d=a(b).val();return d&&d.length>0;case"input":if(this.checkable(b)){return this.getLength(c,b)>0}default:return a.trim(c).length>0}},remote:function(f,c,g){if(this.optional(c)){return"dependency-mismatch"}var d=this.previousValue(c);if(!this.settings.messages[c.name]){this.settings.messages[c.name]={}}d.originalMessage=this.settings.messages[c.name].remote;this.settings.messages[c.name].remote=d.message;g=typeof g=="string"&&{url:g}||g;if(this.pending[c.name]){return"pending"}if(d.old===f){return d.valid}d.old=f;var b=this;this.startRequest(c);var e={};e[c.name]=f;a.ajax(a.extend(true,{url:g,mode:"abort",port:"validate"+c.name,dataType:"json",data:e,success:function(i){b.settings.messages[c.name].remote=d.originalMessage;var k=i===true;if(k){var h=b.formSubmitted;b.prepareElement(c);b.formSubmitted=h;b.successList.push(c);b.showErrors()}else{var l={};var j=i||b.defaultMessage(c,"remote");l[c.name]=d.message=a.isFunction(j)?j(f):j;b.showErrors(l)}d.valid=k;b.stopRequest(c,k)}},g));return"pending"},minlength:function(c,b,d){return this.optional(b)||this.getLength(a.trim(c),b)>=d},maxlength:function(c,b,d){return this.optional(b)||this.getLength(a.trim(c),b)<=d},rangelength:function(d,b,e){var c=this.getLength(a.trim(d),b);return this.optional(b)||(c>=e[0]&&c<=e[1])},min:function(c,b,d){return this.optional(b)||c>=d},max:function(c,b,d){return this.optional(b)||c<=d},range:function(c,b,d){return this.optional(b)||(c>=d[0]&&c<=d[1])},email:function(c,b){return this.optional(b)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(c)},url:function(c,b){return this.optional(b)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(c)},date:function(c,b){return this.optional(b)||!/Invalid|NaN/.test(new Date(c))},dateISO:function(c,b){return this.optional(b)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(c)},number:function(c,b){return this.optional(b)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(c)},digits:function(c,b){return this.optional(b)||/^\d+$/.test(c)},creditcard:function(f,c){if(this.optional(c)){return"dependency-mismatch"}if(/[^0-9 -]+/.test(f)){return false}var g=0,e=0,b=false;f=f.replace(/\D/g,"");for(var h=f.length-1;h>=0;h--){var d=f.charAt(h);var e=parseInt(d,10);if(b){if((e*=2)>9){e-=9}}g+=e;b=!b}return(g%10)==0},accept:function(c,b,d){d=typeof d=="string"?d.replace(/,/g,"|"):"png|jpe?g|gif";return this.optional(b)||c.match(new RegExp(".("+d+")$","i"))},equalTo:function(c,b,e){var d=a(e).unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){a(b).valid()});return c==d.val()}}});a.format=a.validator.format})(jQuery);(function(c){var a={};if(c.ajaxPrefilter){c.ajaxPrefilter(function(f,e,g){var d=f.port;if(f.mode=="abort"){if(a[d]){a[d].abort()}a[d]=g}})}else{var b=c.ajax;c.ajax=function(e){var f=("mode" in e?e:c.ajaxSettings).mode,d=("port" in e?e:c.ajaxSettings).port;if(f=="abort"){if(a[d]){a[d].abort()}return(a[d]=b.apply(this,arguments))}return b.apply(this,arguments)}}})(jQuery);(function(a){if(!jQuery.event.special.focusin&&!jQuery.event.special.focusout&&document.addEventListener){a.each({focus:"focusin",blur:"focusout"},function(c,b){a.event.special[b]={setup:function(){this.addEventListener(c,d,true)},teardown:function(){this.removeEventListener(c,d,true)},handler:function(f){arguments[0]=a.event.fix(f);arguments[0].type=b;return a.event.handle.apply(this,arguments)}};function d(f){f=a.event.fix(f);f.type=b;return a.event.handle.call(this,f)}})}a.extend(a.fn,{validateDelegate:function(d,c,b){return this.bind(c,function(e){var f=a(e.target);if(f.is(d)){return b.apply(f,arguments)}})}})})(jQuery);
/*
 * jQuery Form Plugin
 * version: 3.27.0-2013.02.06
 * @requires jQuery v1.5 or later
 *
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Project repository: https://github.com/malsup/form
 * Dual licensed under the MIT and GPL licenses:
 *    http://malsup.github.com/mit-license.txt
 *    http://malsup.github.com/gpl-license-v2.txt
 */
(function(e){var c={};c.fileapi=e("<input type='file'/>").get(0).files!==undefined;c.formdata=window.FormData!==undefined;e.fn.ajaxSubmit=function(h){if(!this.length){d("ajaxSubmit: skipping submit process - no element selected");return this}var g,y,j,m=this;if(typeof h=="function"){h={success:h}}g=this.attr("method");y=this.attr("action");j=(typeof y==="string")?e.trim(y):"";j=j||window.location.href||"";if(j){j=(j.match(/^([^#]+)/)||[])[1]}h=e.extend(true,{url:j,async:false,success:e.ajaxSettings.success,type:g||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},h);var s={};this.trigger("form-pre-serialize",[this,h,s]);if(s.veto){d("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(h.beforeSerialize&&h.beforeSerialize(this,h)===false){d("ajaxSubmit: submit aborted via beforeSerialize callback");return this}var l=h.traditional;if(l===undefined){l=e.ajaxSettings.traditional}var p=[];var B,C=this.formToArray(h.semantic,p);if(h.data){h.extraData=h.data;B=e.param(h.data,l)}if(h.beforeSubmit&&h.beforeSubmit(C,this,h)===false){d("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[C,this,h,s]);if(s.veto){d("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}var w=e.param(C,l);if(B){w=(w?(w+"&"+B):B)}if(h.type.toUpperCase()=="GET"){h.url+=(h.url.indexOf("?")>=0?"&":"?")+w;h.data=null}else{h.data=w}var E=[];if(h.resetForm){E.push(function(){m.resetForm()})}if(h.clearForm){E.push(function(){m.clearForm(h.includeHidden)})}if(!h.dataType&&h.target){var i=h.success||function(){};E.push(function(q){var k=h.replaceTarget?"replaceWith":"html";e(h.target)[k](q).each(i,arguments)})}else{if(h.success){E.push(h.success)}}h.success=function(H,q,I){var G=h.context||this;for(var F=0,k=E.length;F<k;F++){E[F].apply(G,[H,q,I||m,m])}};var A=e('input[type=file]:enabled[value!=""]',this);var n=A.length>0;var z="multipart/form-data";var v=(m.attr("enctype")==z||m.attr("encoding")==z);var u=c.fileapi&&c.formdata;d("fileAPI :"+u);var o=(n||v)&&!u;var t;if(h.iframe!==false&&(h.iframe||o)){if(h.closeKeepAlive){e.get(h.closeKeepAlive,function(){t=D(C)})}else{t=D(C)}}else{if((n||v)&&u){t=r(C)}else{t=e.ajax(h)}}m.removeData("jqxhr").data("jqxhr",t);for(var x=0;x<p.length;x++){p[x]=null}this.trigger("form-submit-notify",[this,h]);return this;function f(H){var I=e.param(H).split("&");var q=I.length;var k=[];var G,F;for(G=0;G<q;G++){I[G]=I[G].replace(/\+/g," ");F=I[G].split("=");k.push([decodeURIComponent(F[0]),decodeURIComponent(F[1])])}return k}function r(q){var k=new FormData();for(var F=0;F<q.length;F++){k.append(q[F].name,q[F].value)}if(h.extraData){var I=f(h.extraData);for(F=0;F<I.length;F++){if(I[F]){k.append(I[F][0],I[F][1])}}}h.data=null;var H=e.extend(true,{},e.ajaxSettings,h,{contentType:false,processData:false,cache:false,type:g||"POST"});if(h.uploadProgress){H.xhr=function(){var J=jQuery.ajaxSettings.xhr();if(J.upload){J.upload.addEventListener("progress",function(N){var M=0;var K=N.loaded||N.position;var L=N.total;if(N.lengthComputable){M=Math.ceil(K/L*100)}h.uploadProgress(N,K,L,M)},false)}return J}}H.data=null;var G=H.beforeSend;H.beforeSend=function(K,J){J.data=k;if(G){G.call(this,K,J)}};return e.ajax(H)}function D(ad){var I=m[0],H,Z,T,ab,W,K,O,M,N,X,aa,R;var L=!!e.fn.prop;var ag=e.Deferred();if(ad){for(Z=0;Z<p.length;Z++){H=e(p[Z]);if(L){H.prop("disabled",false)}else{H.removeAttr("disabled")}}}T=e.extend(true,{},e.ajaxSettings,h);T.context=T.context||T;W="jqFormIO"+(new Date().getTime());if(T.iframeTarget){K=e(T.iframeTarget);X=K.attr("name");if(!X){K.attr("name",W)}else{W=X}}else{K=e('<iframe name="'+W+'" src="'+T.iframeSrc+'" />');K.css({position:"absolute",top:"-1000px",left:"-1000px"})}O=K[0];M={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(ah){var ai=(ah==="timeout"?"timeout":"aborted");d("aborting upload... "+ai);this.aborted=1;try{if(O.contentWindow.document.execCommand){O.contentWindow.document.execCommand("Stop")}}catch(aj){}K.attr("src",T.iframeSrc);M.error=ai;if(T.error){T.error.call(T.context,M,ai,ah)}if(ab){e.event.trigger("ajaxError",[M,T,ai])}if(T.complete){T.complete.call(T.context,M,ai)}}};ab=T.global;if(ab&&0===e.active++){e.event.trigger("ajaxStart")}if(ab){e.event.trigger("ajaxSend",[M,T])}if(T.beforeSend&&T.beforeSend.call(T.context,M,T)===false){if(T.global){e.active--}ag.reject();return ag}if(M.aborted){ag.reject();return ag}N=I.clk;if(N){X=N.name;if(X&&!N.disabled){T.extraData=T.extraData||{};T.extraData[X]=N.value;if(N.type=="image"){T.extraData[X+".x"]=I.clk_x;T.extraData[X+".y"]=I.clk_y}}}var S=1;var P=2;function Q(ai){var ah=ai.contentWindow?ai.contentWindow.document:ai.contentDocument?ai.contentDocument:ai.document;return ah}var G=e("meta[name=csrf-token]").attr("content");var F=e("meta[name=csrf-param]").attr("content");if(F&&G){T.extraData=T.extraData||{};T.extraData[F]=G}function Y(){var aj=m.attr("target"),ah=m.attr("action");I.setAttribute("target",W);if(!g){I.setAttribute("method","POST")}if(ah!=T.url){I.setAttribute("action",T.url)}if(!T.skipEncodingOverride&&(!g||/post/i.test(g))){m.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"})}if(T.timeout){R=setTimeout(function(){aa=true;V(S)},T.timeout)}function ak(){try{var an=Q(O).readyState;d("state = "+an);if(an&&an.toLowerCase()=="uninitialized"){setTimeout(ak,50)}}catch(ao){d("Server abort: ",ao," (",ao.name,")");V(P);if(R){clearTimeout(R)}R=undefined}}var ai=[];try{if(T.extraData){for(var am in T.extraData){if(T.extraData.hasOwnProperty(am)){if(e.isPlainObject(T.extraData[am])&&T.extraData[am].hasOwnProperty("name")&&T.extraData[am].hasOwnProperty("value")){ai.push(e('<input type="hidden" name="'+T.extraData[am].name+'">').val(T.extraData[am].value).appendTo(I)[0])}else{ai.push(e('<input type="hidden" name="'+am+'">').val(T.extraData[am]).appendTo(I)[0])}}}}if(!T.iframeTarget){K.appendTo("body");if(O.attachEvent){O.attachEvent("onload",V)}else{O.addEventListener("load",V,false)}}setTimeout(ak,15);var al=document.createElement("form").submit;al.apply(I)}finally{I.setAttribute("action",ah);if(aj){I.setAttribute("target",aj)}else{m.removeAttr("target")}e(ai).remove()}}if(T.forceSync){Y()}else{setTimeout(Y,10)}var ae,af,ac=50,J;function V(am){if(M.aborted||J){return}try{af=Q(O)}catch(ap){d("cannot access response document: ",ap);am=P}if(am===S&&M){M.abort("timeout");ag.reject(M,"timeout");return}else{if(am==P&&M){M.abort("server abort");ag.reject(M,"error","server abort");return}}if(!af||af.location.href==T.iframeSrc){if(!aa){return}}if(O.detachEvent){O.detachEvent("onload",V)}else{O.removeEventListener("load",V,false)}var ak="success",ao;try{if(aa){throw"timeout"}var aj=T.dataType=="xml"||af.XMLDocument||e.isXMLDoc(af);d("isXml="+aj);if(!aj&&window.opera&&(af.body===null||!af.body.innerHTML)){if(--ac){d("requeing onLoad callback, DOM not available");setTimeout(V,250);return}}var aq=af.body?af.body:af.documentElement;M.responseText=aq?aq.innerHTML:null;M.responseXML=af.XMLDocument?af.XMLDocument:af;if(aj){T.dataType="xml"}M.getResponseHeader=function(au){var at={"content-type":T.dataType};return at[au]};if(aq){M.status=Number(aq.getAttribute("status"))||M.status;M.statusText=aq.getAttribute("statusText")||M.statusText}var ah=(T.dataType||"").toLowerCase();var an=/(json|script|text)/.test(ah);if(an||T.textarea){var al=af.getElementsByTagName("textarea")[0];if(al){M.responseText=al.value;M.status=Number(al.getAttribute("status"))||M.status;M.statusText=al.getAttribute("statusText")||M.statusText}else{if(an){var ai=af.getElementsByTagName("pre")[0];var ar=af.getElementsByTagName("body")[0];if(ai){M.responseText=ai.textContent?ai.textContent:ai.innerText}else{if(ar){M.responseText=ar.textContent?ar.textContent:ar.innerText}}}}}else{if(ah=="xml"&&!M.responseXML&&M.responseText){M.responseXML=U(M.responseText)}}try{ae=k(M,ah,T)}catch(am){ak="parsererror";M.error=ao=(am||ak)}}catch(am){d("error caught: ",am);ak="error";M.error=ao=(am||ak)}if(M.aborted){d("upload aborted");ak=null}if(M.status){ak=(M.status>=200&&M.status<300||M.status===304)?"success":"error"}if(ak==="success"){if(T.success){T.success.call(T.context,ae,"success",M)}ag.resolve(M.responseText,"success",M);if(ab){e.event.trigger("ajaxSuccess",[M,T])}}else{if(ak){if(ao===undefined){ao=M.statusText}if(T.error){T.error.call(T.context,M,ak,ao)}ag.reject(M,"error",ao);if(ab){e.event.trigger("ajaxError",[M,T,ao])}}}if(ab){e.event.trigger("ajaxComplete",[M,T])}if(ab&&!--e.active){e.event.trigger("ajaxStop")}if(T.complete){T.complete.call(T.context,M,ak)}J=true;if(T.timeout){clearTimeout(R)}setTimeout(function(){if(!T.iframeTarget){K.remove()}M.responseXML=null},100)}var U=e.parseXML||function(ah,ai){if(window.ActiveXObject){ai=new ActiveXObject("Microsoft.XMLDOM");ai.async="false";ai.loadXML(ah)}else{ai=(new DOMParser()).parseFromString(ah,"text/xml")}return(ai&&ai.documentElement&&ai.documentElement.nodeName!="parsererror")?ai:null};var q=e.parseJSON||function(ah){return window["eval"]("("+ah+")")};var k=function(am,ak,aj){var ai=am.getResponseHeader("content-type")||"",ah=ak==="xml"||!ak&&ai.indexOf("xml")>=0,al=ah?am.responseXML:am.responseText;if(ah&&al.documentElement.nodeName==="parsererror"){if(e.error){e.error("parsererror")}}if(aj&&aj.dataFilter){al=aj.dataFilter(al,ak)}if(typeof al==="string"){if(ak==="json"||!ak&&ai.indexOf("json")>=0){al=q(al)}else{if(ak==="script"||!ak&&ai.indexOf("javascript")>=0){e.globalEval(al)}}}return al};return ag}};e.fn.ajaxForm=function(f){f=f||{};f.delegation=f.delegation&&e.isFunction(e.fn.on);if(!f.delegation&&this.length===0){var g={s:this.selector,c:this.context};if(!e.isReady&&g.s){d("DOM not ready, queuing ajaxForm");e(function(){e(g.s,g.c).ajaxForm(f)});return this}d("terminating; zero elements found by selector"+(e.isReady?"":" (DOM not ready)"));return this}if(f.delegation){e(document).off("submit.form-plugin",this.selector,b).off("click.form-plugin",this.selector,a).on("submit.form-plugin",this.selector,f,b).on("click.form-plugin",this.selector,f,a);return this}return this.ajaxFormUnbind().bind("submit.form-plugin",f,b).bind("click.form-plugin",f,a)};function b(g){var f=g.data;if(!g.isDefaultPrevented()){g.preventDefault();e(this).ajaxSubmit(f)}}function a(j){var i=j.target;var g=e(i);if(!(g.is("[type=submit],[type=image]"))){var f=g.closest("[type=submit]");if(f.length===0){return}i=f[0]}var h=this;h.clk=i;if(i.type=="image"){if(j.offsetX!==undefined){h.clk_x=j.offsetX;h.clk_y=j.offsetY}else{if(typeof e.fn.offset=="function"){var k=g.offset();h.clk_x=j.pageX-k.left;h.clk_y=j.pageY-k.top}else{h.clk_x=j.pageX-i.offsetLeft;h.clk_y=j.pageY-i.offsetTop}}}setTimeout(function(){h.clk=h.clk_x=h.clk_y=null},100)}e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};e.fn.formToArray=function(w,f){var u=[];if(this.length===0){return u}var k=this[0];var o=w?k.getElementsByTagName("*"):k.elements;if(!o){return u}var q,p,m,x,l,s,h;for(q=0,s=o.length;q<s;q++){l=o[q];m=l.name;if(!m){continue}if(w&&k.clk&&l.type=="image"){if(!l.disabled&&k.clk==l){u.push({name:m,value:e(l).val(),type:l.type});u.push({name:m+".x",value:k.clk_x},{name:m+".y",value:k.clk_y})}continue}x=e.fieldValue(l,true);if(x&&x.constructor==Array){if(f){f.push(l)}for(p=0,h=x.length;p<h;p++){u.push({name:m,value:x[p]})}}else{if(c.fileapi&&l.type=="file"&&!l.disabled){if(f){f.push(l)}var g=l.files;if(g.length){for(p=0;p<g.length;p++){u.push({name:m,value:g[p],type:l.type})}}else{u.push({name:m,value:"",type:l.type})}}else{if(x!==null&&typeof x!="undefined"){if(f){f.push(l)}u.push({name:m,value:x,type:l.type,required:l.required})}}}}if(!w&&k.clk){var r=e(k.clk),t=r[0];m=t.name;if(m&&!t.disabled&&t.type=="image"){u.push({name:m,value:r.val()});u.push({name:m+".x",value:k.clk_x},{name:m+".y",value:k.clk_y})}}return u};e.fn.formSerialize=function(f){return e.param(this.formToArray(f))};e.fn.fieldSerialize=function(g){var f=[];this.each(function(){var l=this.name;if(!l){return}var j=e.fieldValue(this,g);if(j&&j.constructor==Array){for(var k=0,h=j.length;k<h;k++){f.push({name:l,value:j[k]})}}else{if(j!==null&&typeof j!="undefined"){f.push({name:this.name,value:j})}}});return e.param(f)};e.fn.fieldValue=function(l){for(var k=[],h=0,f=this.length;h<f;h++){var j=this[h];var g=e.fieldValue(j,l);if(g===null||typeof g=="undefined"||(g.constructor==Array&&!g.length)){continue}if(g.constructor==Array){e.merge(k,g)}else{k.push(g)}}return k};e.fieldValue=function(f,m){var h=f.name,s=f.type,u=f.tagName.toLowerCase();if(m===undefined){m=true}if(m&&(!h||f.disabled||s=="reset"||s=="button"||(s=="checkbox"||s=="radio")&&!f.checked||(s=="submit"||s=="image")&&f.form&&f.form.clk!=f||u=="select"&&f.selectedIndex==-1)){return null}if(u=="select"){var o=f.selectedIndex;if(o<0){return null}var q=[],g=f.options;var k=(s=="select-one");var p=(k?o+1:g.length);for(var j=(k?o:0);j<p;j++){var l=g[j];if(l.selected){var r=l.value;if(!r){r=(l.attributes&&l.attributes.value&&!(l.attributes.value.specified))?l.text:l.value}if(k){return r}q.push(r)}}return q}return e(f).val()};e.fn.clearForm=function(f){return this.each(function(){e("input,select,textarea",this).clearFields(f)})};e.fn.clearFields=e.fn.clearInputs=function(f){var g=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var i=this.type,h=this.tagName.toLowerCase();if(g.test(i)||h=="textarea"){this.value=""}else{if(i=="checkbox"||i=="radio"){this.checked=false}else{if(h=="select"){this.selectedIndex=-1}else{if(i=="file"){if(/MSIE/.test(navigator.userAgent)){e(this).replaceWith(e(this).clone())}else{e(this).val("")}}else{if(f){if((f===true&&/hidden/.test(i))||(typeof f=="string"&&e(this).is(f))){this.value=""}}}}}}})};e.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=="function"||(typeof this.reset=="object"&&!this.reset.nodeType)){this.reset()}})};e.fn.enable=function(f){if(f===undefined){f=true}return this.each(function(){this.disabled=!f})};e.fn.selected=function(f){if(f===undefined){f=true}return this.each(function(){var g=this.type;if(g=="checkbox"||g=="radio"){this.checked=f}else{if(this.tagName.toLowerCase()=="option"){var h=e(this).parent("select");if(f&&h[0]&&h[0].type=="select-one"){h.find("option").selected(false)}this.selected=f}}})};e.fn.ajaxSubmit.debug=false;function d(){if(!e.fn.ajaxSubmit.debug){return}var f="[jquery.form] "+Array.prototype.join.call(arguments,"");if(window.console&&window.console.log){window.console.log(f)}else{if(window.opera&&window.opera.postError){window.opera.postError(f)}}}})(jQuery);(function(a){if(typeof a.fn.each2=="undefined"){a.fn.extend({each2:function(f){var d=a([0]),e=-1,b=this.length;while(++e<b&&(d.context=d[0]=this[e])&&f.call(d[0],e,d)!==false){}return this}})}})(jQuery);(function(j,l){if(window.Select2!==l){return}var c,e,w,G,u,a,C,D;c={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(H){H=H.which?H.which:H;switch(H){case c.LEFT:case c.RIGHT:case c.UP:case c.DOWN:return true}return false},isControl:function(I){var H=I.which;switch(H){case c.SHIFT:case c.CTRL:case c.ALT:return true}if(I.metaKey){return true}return false},isFunctionKey:function(H){H=H.which?H.which:H;return H>=112&&H<=123}};D=j(document);u=(function(){var H=1;return function(){return H++}}());function b(J,K){var I=0,H=K.length;for(;I<H;I=I+1){if(J===K[I]){return I}}return -1}function q(I,H){return I===H}function m(I,K){var L,J,H;if(I===null||I.length<1){return[]}L=I.split(K);for(J=0,H=L.length;J<H;J=J+1){L[J]=j.trim(L[J])}return L}function n(H){return H.outerWidth(false)-H.width()}function B(I){var H="keyup-change-value";I.bind("keydown",function(){if(j.data(I,H)===l){j.data(I,H,I.val())}});I.bind("keyup",function(){var J=j.data(I,H);if(J!==l&&I.val()!==J){j.removeData(I,H);I.trigger("keyup-change")}})}D.bind("mousemove",function(H){C={x:H.pageX,y:H.pageY}});function v(H){H.bind("mousemove",function(J){var I=C;if(I===l||I.x!==J.pageX||I.y!==J.pageY){j(J.target).trigger("mousemove-filtered",J)}})}function g(K,I,H){H=H||l;var J;return function(){var L=arguments;window.clearTimeout(J);J=window.setTimeout(function(){I.apply(H,L)},K)}}function E(J){var H=false,I;return function(){if(H===false){I=J();H=true}return I}}function f(H,J){var I=g(H,function(K){J.trigger("scroll-debounced",K)});J.bind("scroll",function(K){if(b(K.target,J.get())>=0){I(K)}})}function r(H){if(H[0]===document.activeElement){return}window.setTimeout(function(){var J=H[0],K=H.val().length,I;H.focus();if(J.setSelectionRange){J.setSelectionRange(K,K)}else{if(J.createTextRange){I=J.createTextRange();I.collapse(true);I.moveEnd("character",K);I.moveStart("character",K);I.select()}}},0)}function d(H){H.preventDefault();H.stopPropagation()}function F(H){H.preventDefault();H.stopImmediatePropagation()}function z(I){if(!a){var H=I[0].currentStyle||window.getComputedStyle(I[0],null);a=j(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:H.fontSize,fontFamily:H.fontFamily,fontStyle:H.fontStyle,fontWeight:H.fontWeight,letterSpacing:H.letterSpacing,textTransform:H.textTransform,whiteSpace:"nowrap"});a.attr("class","select2-sizer");j("body").append(a)}a.text(I.val());return a.width()}function y(I,M,H){var K,L=[],J;K=I.attr("class");if(typeof K==="string"){j(K.split(" ")).each2(function(){if(this.indexOf("select2-")===0){L.push(this)}})}K=M.attr("class");if(typeof K==="string"){j(K.split(" ")).each2(function(){if(this.indexOf("select2-")!==0){J=H(this);if(typeof J==="string"&&J.length>0){L.push(this)}}})}I.attr("class",L.join(" "))}function i(M,L,J,H){var K=M.toUpperCase().indexOf(L.toUpperCase()),I=L.length;if(K<0){J.push(H(M));return}J.push(H(M.substring(0,K)));J.push("<span class='select2-match'>");J.push(H(M.substring(K,K+I)));J.push("</span>");J.push(H(M.substring(K+I,M.length)))}function p(I){var K,H=0,J=null,L=I.quietMillis||100;return function(M){window.clearTimeout(K);K=window.setTimeout(function(){H+=1;var O=H,Q=I.data,N=I.url,S=I.transport||j.ajax,P=I.type||"GET",R={};Q=Q?Q.call(this,M.term,M.page,M.context):null;N=(typeof N==="function")?N.call(this,M.term,M.page,M.context):N;if(null!==J){J.abort()}if(I.params){if(j.isFunction(I.params)){j.extend(R,I.params.call(null))}else{j.extend(R,I.params)}}j.extend(R,{url:N,dataType:I.dataType,data:Q,type:P,cache:false,success:function(U){if(O<H){return}var T=I.results(U,M.page);M.callback(T)}});J=S.call(null,R)},L)}}function s(H){var J=H,I,K=function(L){return""+L.text};if(!j.isArray(J)){K=J.text;if(!j.isFunction(K)){I=J.text;K=function(L){return L[I]}}J=J.results}return function(N){var M=N.term,L={results:[]},O;if(M===""){N.callback({results:J});return}O=function(Q,S){var R,P;Q=Q[0];if(Q.children){R={};for(P in Q){if(Q.hasOwnProperty(P)){R[P]=Q[P]}}R.children=[];j(Q.children).each2(function(T,U){O(U,R.children)});if(R.children.length||N.matcher(M,K(R),Q)){S.push(R)}}else{if(N.matcher(M,K(Q),Q)){S.push(Q)}}};j(J).each2(function(Q,P){O(P,L.results)});N.callback(L)}}function o(I){var H=j.isFunction(I);return function(L){var K=L.term,J={results:[]};j(H?I():I).each(function(){var M=this.text!==l,N=M?this.text:this;if(K===""||L.matcher(K,N)){J.results.push(M?this:{id:this,text:this})}});L.callback(J)}}function k(H,I){if(j.isFunction(H)){return true}if(!H){return false}throw new Error("formatterName must be a function or a falsy value")}function t(H){return j.isFunction(H)?H():H}function h(H){var I=0;j.each(H,function(J,K){if(K.children){I+=h(K.children)}else{I++}});return I}function A(P,Q,N,H){var I=P,R=false,K,O,L,J,M;if(!H.createSearchChoice||!H.tokenSeparators||H.tokenSeparators.length<1){return l}while(true){O=-1;for(L=0,J=H.tokenSeparators.length;L<J;L++){M=H.tokenSeparators[L];O=P.indexOf(M);if(O>=0){break}}if(O<0){break}K=P.substring(0,O);P=P.substring(O+M.length);if(K.length>0){K=H.createSearchChoice(K,Q);if(K!==l&&K!==null&&H.id(K)!==l&&H.id(K)!==null){R=false;for(L=0,J=Q.length;L<J;L++){if(q(H.id(K),H.id(Q[L]))){R=true;break}}if(!R){N(K)}}}}if(I!==P){return P}}function x(H,I){var J=function(){};J.prototype=new H;J.prototype.constructor=J;J.prototype.parent=H.prototype;J.prototype=j.extend(J.prototype,I);return J}e=x(Object,{bind:function(I){var H=this;return function(){I.apply(H,arguments)}},init:function(K){var J,I,L=".select2-results",H;this.opts=K=this.prepareOpts(K);this.id=K.id;if(K.element.data("select2")!==l&&K.element.data("select2")!==null){this.destroy()}this.enabled=true;this.container=this.createContainer();this.containerId="s2id_"+(K.element.attr("id")||"autogen"+u());this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1");this.container.attr("id",this.containerId);this.body=E(function(){return K.element.closest("body")});H=j("#select2-drop-mask");if(H.length==0){H=j(document.createElement("div"));H.attr("id","select2-drop-mask").attr("class","select2-drop-mask");H.hide();H.appendTo(this.body());H.bind("mousedown touchstart",function(N){var O=j("#select2-drop"),M;if(O.length>0){M=O.data("select2");if(M.opts.selectOnBlur){M.selectHighlighted({noFocus:true})}M.close()}})}y(this.container,this.opts.element,this.opts.adaptContainerCssClass);this.container.css(t(K.containerCss));this.container.addClass(t(K.containerCssClass));this.elementTabIndex=this.opts.element.attr("tabIndex");this.opts.element.data("select2",this).addClass("select2-offscreen").bind("focus.select2",function(){j(this).select2("focus")}).attr("tabIndex","-1").before(this.container);this.container.data("select2",this);this.dropdown=this.container.find(".select2-drop");this.dropdown.addClass(t(K.dropdownCssClass));this.dropdown.data("select2",this);this.results=J=this.container.find(L);this.search=I=this.container.find("input.select2-input");I.attr("tabIndex",this.elementTabIndex);this.resultsPage=0;this.context=null;this.initContainer();this.initContainerWidth();v(this.results);this.dropdown.delegate(L,"mousemove-filtered",this.bind(this.highlightUnderEvent));f(80,this.results);this.dropdown.delegate(L,"scroll-debounced",this.bind(this.loadMoreIfNeeded));if(j.fn.mousewheel){J.mousewheel(function(Q,R,O,N){var P=J.scrollTop(),M;if(N>0&&P-N<=0){J.scrollTop(0);d(Q)}else{if(N<0&&J.get(0).scrollHeight-J.scrollTop()+N<=J.height()){J.scrollTop(J.get(0).scrollHeight-J.height());d(Q)}}})}B(I);I.bind("keyup-change input paste",this.bind(this.updateResults));I.bind("focus",function(){I.addClass("select2-focused")});I.bind("blur",function(){I.removeClass("select2-focused")});this.dropdown.delegate(L,"mouseup",this.bind(function(M){if(j(M.target).closest(".select2-result-selectable").length>0){this.highlightUnderEvent(M);this.selectHighlighted(M)}else{this.focusSearch()}d(M)}));this.dropdown.bind("click mouseup mousedown",function(M){M.stopPropagation()});if(j.isFunction(this.opts.initSelection)){this.initSelection();this.monitorSource()}if(K.element.is(":disabled")||K.element.is("[readonly='readonly']")){this.disable()}},destroy:function(){var H=this.opts.element.data("select2");if(this.propertyObserver){delete this.propertyObserver;this.propertyObserver=null}if(H!==l){H.container.remove();H.dropdown.remove();H.opts.element.removeClass("select2-offscreen").removeData("select2").unbind(".select2").attr({tabIndex:this.elementTabIndex}).show()}},prepareOpts:function(L){var J,I,H,K;J=L.element;if(J.get(0).tagName.toLowerCase()==="select"){this.select=I=L.element}if(I){j.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in L){throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}})}L=j.extend({},{populateResults:function(M,Q,S){var R,P,U,O,N=this.opts.id,T=this;R=function(ab,V,aa){var ac,X,ah,ae,Y,ag,W,af,ad,Z;ab=L.sortResults(ab,V,S);for(ac=0,X=ab.length;ac<X;ac=ac+1){ah=ab[ac];Y=(ah.disabled===true);ae=(!Y)&&(N(ah)!==l);ag=ah.children&&ah.children.length>0;W=j("<li></li>");W.addClass("select2-results-dept-"+aa);W.addClass("select2-result");W.addClass(ae?"select2-result-selectable":"select2-result-unselectable");if(Y){W.addClass("select2-disabled")}if(ag){W.addClass("select2-result-with-children")}W.addClass(T.opts.formatResultCssClass(ah));af=j(document.createElement("div"));af.addClass("select2-result-label");Z=L.formatResult(ah,af,S,T.opts.escapeMarkup);if(Z!==l){af.html(Z)}W.append(af);if(ag){ad=j("<ul></ul>");ad.addClass("select2-result-sub");R(ah.children,ad,aa+1);W.append(ad)}W.data("select2-data",ah);V.append(W)}};R(Q,M,0)}},j.fn.select2.defaults,L);if(typeof(L.id)!=="function"){H=L.id;L.id=function(M){return M[H]}}if(j.isArray(L.element.data("select2Tags"))){if("tags" in L){throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+L.element.attr("id")}L.tags=L.element.attr("data-select2-tags")}if(I){L.query=this.bind(function(P){var O={results:[],more:false},N=P.term,M,R,Q;Q=function(S,U){var T;if(S.is("option")){if(P.matcher(N,S.text(),S)){U.push({id:S.attr("value")||S.text(),text:S.text(),element:S.get(),css:S.attr("class"),disabled:q(S.attr("disabled"),"disabled")})}}else{if(S.is("optgroup")){T={text:S.attr("label"),children:[],element:S.get(),css:S.attr("class")};S.children().each2(function(V,W){Q(W,T.children)});if(T.children.length>0){U.push(T)}}}};M=J.children();if(this.getPlaceholder()!==l&&M.length>0){R=M[0];if(j(R).text()===""){M=M.not(R)}}M.each2(function(S,T){Q(T,O.results)});P.callback(O)});L.id=function(M){return M.id};L.formatResultCssClass=function(M){return M.css}}else{if(!("query" in L)){if("ajax" in L){K=L.element.data("ajax-url");if(K&&K.length>0){L.ajax.url=K}L.query=p(L.ajax)}else{if("data" in L){L.query=s(L.data)}else{if("tags" in L){L.query=o(L.tags);if(L.createSearchChoice===l){L.createSearchChoice=function(M){return{id:M,text:M}}}if(L.initSelection===l){L.initSelection=function(M,O){var N=[];j(m(M.val(),L.separator)).each(function(){var R=this,Q=this,P=L.tags;if(j.isFunction(P)){P=P()}j(P).each(function(){if(q(this.id,R)){Q=this.text;return false}});N.push({id:R,text:Q})});O(N)}}}}}}}if(typeof(L.query)!=="function"){throw"query function not defined for Select2 "+L.element.attr("id")}return L},monitorSource:function(){var H=this.opts.element,I;H.bind("change.select2",this.bind(function(J){if(this.opts.element.data("select2-change-triggered")!==true){this.initSelection()}}));I=this.bind(function(){var L,K,J=this;L=this.opts.element.attr("disabled")!=="disabled";K=this.opts.element.attr("readonly")==="readonly";L=L&&!K;if(this.enabled!==L){if(L){this.enable()}else{this.disable()}}y(this.container,this.opts.element,this.opts.adaptContainerCssClass);this.container.addClass(t(this.opts.containerCssClass));y(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass);this.dropdown.addClass(t(this.opts.dropdownCssClass))});H.bind("propertychange.select2 DOMAttrModified.select2",I);if(typeof WebKitMutationObserver!=="undefined"){if(this.propertyObserver){delete this.propertyObserver;this.propertyObserver=null}this.propertyObserver=new WebKitMutationObserver(function(J){J.forEach(I)});this.propertyObserver.observe(H.get(0),{attributes:true,subtree:false})}},triggerChange:function(H){H=H||{};H=j.extend({},H,{type:"change",val:this.val()});this.opts.element.data("select2-change-triggered",true);this.opts.element.trigger(H);this.opts.element.data("select2-change-triggered",false);this.opts.element.click();if(this.opts.blurOnChange){this.opts.element.blur()}},enable:function(){if(this.enabled){return}this.enabled=true;this.container.removeClass("select2-container-disabled");this.opts.element.removeAttr("disabled")},disable:function(){if(!this.enabled){return}this.close();this.enabled=false;this.container.addClass("select2-container-disabled");this.opts.element.attr("disabled","disabled")},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var N=this.container.offset(),W=this.container.outerHeight(false),I=this.container.outerWidth(false),M=this.dropdown.outerHeight(false),P=j(window).scrollLeft()+j(window).width(),S=j(window).scrollTop()+j(window).height(),H=N.top+W,V=N.left,T=H+M<=S,R=(N.top-M)>=this.body().scrollTop(),J=this.dropdown.outerWidth(false),K=V+J<=P,L=this.dropdown.hasClass("select2-drop-above"),O,U,Q;if(this.body().css("position")!=="static"){O=this.body().offset();H-=O.top;V-=O.left}if(L){U=true;if(!R&&T){U=false}}else{U=false;if(!T&&R){U=true}}if(!K){V=N.left+I-J}if(U){H=N.top-M;this.container.addClass("select2-drop-above");this.dropdown.addClass("select2-drop-above")}else{this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above")}Q=j.extend({top:H,left:V,width:I},t(this.opts.dropdownCss));this.dropdown.css(Q)},shouldOpen:function(){var H;if(this.opened()){return false}H=j.Event("opening");this.opts.element.trigger(H);return !H.isDefaultPrevented()},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above")},open:function(){if(!this.shouldOpen()){return false}window.setTimeout(this.bind(this.opening),1);return true},opening:function(){var L=this.containerId,H="scroll."+L,K="resize."+L,J="orientationchange."+L,I;this.clearDropdownAlignmentPreference();this.container.addClass("select2-dropdown-open").addClass("select2-container-active");if(this.dropdown[0]!==this.body().children().last()[0]){this.dropdown.detach().appendTo(this.body())}this.updateResults(true);I=j("#select2-drop-mask");if(this.dropdown.prev()[0]!==I[0]){this.dropdown.before(I)}j("#select2-drop").removeAttr("id");this.dropdown.attr("id","select2-drop");I.css({width:document.documentElement.scrollWidth,height:document.documentElement.scrollHeight});I.show();this.dropdown.show();this.positionDropdown();this.dropdown.addClass("select2-drop-active");this.ensureHighlightVisible();this.container.parents().add(window).each(function(){j(this).bind(K+" "+H+" "+J,function(M){j("#select2-drop-mask").css({width:document.documentElement.scrollWidth,height:document.documentElement.scrollHeight});j("#select2-drop").data("select2").positionDropdown()})});this.focusSearch()},close:function(){if(!this.opened()){return}var K=this.containerId,H="scroll."+K,J="resize."+K,I="orientationchange."+K;this.container.parents().add(window).each(function(){j(this).unbind(H).unbind(J).unbind(I)});this.clearDropdownAlignmentPreference();j("#select2-drop-mask").hide();this.dropdown.removeAttr("id");this.dropdown.hide();this.container.removeClass("select2-dropdown-open");this.results.empty();this.clearSearch();this.opts.element.trigger(j.Event("close"))},clearSearch:function(){},getMaximumSelectionSize:function(){return t(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var K=this.results,J,H,O,N,L,M,I;H=this.highlight();if(H<0){return}if(H==0){K.scrollTop(0);return}J=this.findHighlightableChoices();O=j(J[H]);N=O.offset().top+O.outerHeight(true);if(H===J.length-1){I=K.find("li.select2-more-results");if(I.length>0){N=I.offset().top+I.outerHeight(true)}}L=K.offset().top+K.outerHeight(true);if(N>L){K.scrollTop(K.scrollTop()+(N-L))}M=O.offset().top-K.offset().top;if(M<0&&O.css("display")!="none"){K.scrollTop(K.scrollTop()+M)}},findHighlightableChoices:function(){var H=this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)");return this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)")},moveHighlight:function(K){var J=this.findHighlightableChoices(),I=this.highlight();while(I>-1&&I<J.length){I+=K;var H=j(J[I]);if(H.hasClass("select2-result-selectable")&&!H.hasClass("select2-disabled")&&!H.hasClass("select2-selected")){this.highlight(I);break}}},highlight:function(I){var K=this.findHighlightableChoices(),H,J;if(arguments.length===0){return b(K.filter(".select2-highlighted")[0],K.get())}if(I>=K.length){I=K.length-1}if(I<0){I=0}this.results.find(".select2-highlighted").removeClass("select2-highlighted");H=j(K[I]);H.addClass("select2-highlighted");this.ensureHighlightVisible();J=H.data("select2-data");if(J){this.opts.element.trigger({type:"highlight",val:this.id(J),choice:J})}},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(I){var H=j(I.target).closest(".select2-result-selectable");if(H.length>0&&!H.is(".select2-highlighted")){var J=this.findHighlightableChoices();this.highlight(J.index(H))}else{if(H.length==0){this.results.find(".select2-highlighted").removeClass("select2-highlighted")}}},loadMoreIfNeeded:function(){var L=this.results,K=L.find("li.select2-more-results"),O,N=-1,M=this.resultsPage+1,H=this,J=this.search.val(),I=this.context;if(K.length===0){return}O=K.offset().top-L.offset().top-L.height();if(O<=this.opts.loadMorePadding){K.addClass("select2-active");this.opts.query({element:this.opts.element,term:J,page:M,context:I,matcher:this.opts.matcher,callback:this.bind(function(P){if(!H.opened()){return}H.opts.populateResults.call(this,L,P.results,{term:J,page:M,context:I});if(P.more===true){K.detach().appendTo(L).text(H.opts.formatLoadMore(M+1));window.setTimeout(function(){H.loadMoreIfNeeded()},10)}else{K.remove()}H.positionDropdown();H.resultsPage=M;H.context=P.context})})}},tokenize:function(){},updateResults:function(N){var Q=this.search,L=this.results,H=this.opts,K,P=this,O;if(N!==true&&(this.showSearchInput===false||!this.opened())){return}Q.addClass("select2-active");function M(){L.scrollTop(0);Q.removeClass("select2-active");P.positionDropdown()}function I(R){L.html(R);M()}var J=this.getMaximumSelectionSize();if(J>=1){K=this.data();if(j.isArray(K)&&K.length>=J&&k(H.formatSelectionTooBig,"formatSelectionTooBig")){I("<li class='select2-selection-limit'>"+H.formatSelectionTooBig(J)+"</li>");return}}if(Q.val().length<H.minimumInputLength){if(k(H.formatInputTooShort,"formatInputTooShort")){I("<li class='select2-no-results'>"+H.formatInputTooShort(Q.val(),H.minimumInputLength)+"</li>")}else{I("")}return}else{if(H.formatSearching()&&N===true){I("<li class='select2-searching'>"+H.formatSearching()+"</li>")}}if(H.maximumInputLength&&Q.val().length>H.maximumInputLength){if(k(H.formatInputTooLong,"formatInputTooLong")){I("<li class='select2-no-results'>"+H.formatInputTooLong(Q.val(),H.maximumInputLength)+"</li>")}else{I("")}return}O=this.tokenize();if(O!=l&&O!=null){Q.val(O)}this.resultsPage=1;H.query({element:H.element,term:Q.val(),page:this.resultsPage,context:null,matcher:H.matcher,callback:this.bind(function(S){var R;if(!this.opened()){return}this.context=(S.context===l)?null:S.context;if(this.opts.createSearchChoice&&Q.val()!==""){R=this.opts.createSearchChoice.call(null,Q.val(),S.results);if(R!==l&&R!==null&&P.id(R)!==l&&P.id(R)!==null){if(j(S.results).filter(function(){return q(P.id(this),P.id(R))}).length===0){S.results.unshift(R)}}}if(S.results.length===0&&k(H.formatNoMatches,"formatNoMatches")){I("<li class='select2-no-results'>"+H.formatNoMatches(Q.val())+"</li>");return}L.empty();P.opts.populateResults.call(this,L,S.results,{term:Q.val(),page:this.resultsPage,context:null});if(S.more===true&&k(H.formatLoadMore,"formatLoadMore")){L.append("<li class='select2-more-results'>"+P.opts.escapeMarkup(H.formatLoadMore(this.resultsPage))+"</li>");window.setTimeout(function(){P.loadMoreIfNeeded()},10)}this.postprocessResults(S,N);M()})})},cancel:function(){this.close()},blur:function(){if(this.opts.selectOnBlur){this.selectHighlighted({noFocus:true})}this.close();this.container.removeClass("select2-container-active");if(this.search[0]===document.activeElement){this.search.blur()}this.clearSearch();this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){r(this.search)},selectHighlighted:function(I){var H=this.highlight(),J=this.results.find(".select2-highlighted"),K=J.closest(".select2-result").data("select2-data");if(K){this.highlight(H);this.onSelect(K,I)}},getPlaceholder:function(){if(this.select){if(this.select.find("option").first().text()!==""){return l}}return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder},initContainerWidth:function(){function I(){var M,K,N,L,J;if(this.opts.width==="off"){return null}else{if(this.opts.width==="element"){return this.opts.element.outerWidth(false)===0?"auto":this.opts.element.outerWidth(false)+"px"}else{if(this.opts.width==="copy"||this.opts.width==="resolve"){M=this.opts.element.attr("style");if(M!==l){K=M.split(";");for(L=0,J=K.length;L<J;L=L+1){N=K[L].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/);if(N!==null&&N.length>=1){return N[1]}}}if(this.opts.width==="resolve"){M=this.opts.element.css("width");if(M.indexOf("%")>0){return M}return(this.opts.element.outerWidth(false)===0?"auto":this.opts.element.outerWidth(false)+"px")}return null}else{if(j.isFunction(this.opts.width)){return this.opts.width()}else{return this.opts.width}}}}}var H=I.call(this);if(H!==null){this.container.css("width",H)}}});w=x(e,{createContainer:function(){var H=j(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' onclick='return false;' class='select2-choice' tabindex='-1'>","   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>","   <div><b></b></div>","</a>","<input class='select2-focusser select2-offscreen' type='text'/>","<div class='select2-drop' style='display:none'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return H},disable:function(){if(!this.enabled){return}this.parent.disable.apply(this,arguments);this.focusser.attr("disabled","disabled")},enable:function(){if(this.enabled){return}this.parent.enable.apply(this,arguments);this.focusser.removeAttr("disabled")},opening:function(){this.parent.opening.apply(this,arguments);this.focusser.attr("disabled","disabled");this.opts.element.trigger(j.Event("open"))},close:function(){if(!this.opened()){return}this.parent.close.apply(this,arguments);this.focusser.removeAttr("disabled");r(this.focusser)},focus:function(){if(this.opened()){this.close()}else{this.focusser.removeAttr("disabled");this.focusser.focus()}},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments);this.focusser.removeAttr("disabled");this.focusser.focus()},initContainer:function(){var J,I=this.container,K=this.dropdown,H=false;this.selection=J=I.find(".select2-choice");this.focusser=I.find(".select2-focusser");this.search.bind("keydown",this.bind(function(L){if(!this.enabled){return}if(L.which===c.PAGE_UP||L.which===c.PAGE_DOWN){d(L);return}switch(L.which){case c.UP:case c.DOWN:this.moveHighlight((L.which===c.UP)?-1:1);d(L);return;case c.TAB:case c.ENTER:this.selectHighlighted();d(L);return;case c.ESC:this.cancel(L);d(L);return}}));this.focusser.bind("keydown",this.bind(function(L){if(!this.enabled){return}if(L.which===c.TAB||c.isControl(L)||c.isFunctionKey(L)||L.which===c.ESC){return}if(this.opts.openOnEnter===false&&L.which===c.ENTER){d(L);return}if(L.which==c.DOWN||L.which==c.UP||(L.which==c.ENTER&&this.opts.openOnEnter)){this.open();d(L);return}if(L.which==c.DELETE||L.which==c.BACKSPACE){if(this.opts.allowClear){this.clear()}d(L);return}}));B(this.focusser);this.focusser.bind("keyup-change input",this.bind(function(L){if(this.opened()){return}this.open();this.search.val(this.focusser.val());this.focusser.val("");d(L)}));J.delegate("abbr","mousedown",this.bind(function(L){if(!this.enabled){return}this.clear();F(L);this.close();this.triggerChange();this.selection.focus()}));J.bind("mousedown",this.bind(function(L){H=true;if(this.opened()){this.close()}else{if(this.enabled){this.open()}}d(L);H=false}));K.bind("mousedown",this.bind(function(){this.search.focus()}));J.bind("focus",this.bind(function(L){d(L)}));this.focusser.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")})).bind("blur",this.bind(function(){if(!this.opened()){this.container.removeClass("select2-container-active")}}));this.search.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")}));this.setPlaceholder()},clear:function(){var H=this.selection.data("select2-data");this.opts.element.val("");this.selection.find("span").empty();this.selection.removeData("select2-data");this.setPlaceholder();this.opts.element.trigger({type:"removed",val:this.id(H),choice:H});this.triggerChange({removed:H})},initSelection:function(){var I;if(this.opts.element.val()===""&&this.opts.element.text()===""){this.close();this.setPlaceholder()}else{var H=this;this.opts.initSelection.call(null,this.opts.element,function(J){if(J!==l&&J!==null){H.updateSelection(J);H.close();H.setPlaceholder()}})}},prepareOpts:function(){var H=this.parent.prepareOpts.apply(this,arguments);if(H.element.get(0).tagName.toLowerCase()==="select"){H.initSelection=function(I,K){var J=I.find(":selected");if(j.isFunction(K)){K({id:J.attr("value")||J.text(),text:J.text(),element:J})}}}else{if("data" in H){H.initSelection=H.initSelection||function(I,K){var J=I.val();H.query({matcher:function(L,N,M){return q(J,H.id(M))},callback:!j.isFunction(K)?j.noop:function(L){K(L.results.length?L.results[0]:null)}})}}}return H},setPlaceholder:function(){var H=this.getPlaceholder();if(this.opts.element.val()===""&&H!==l){if(this.select&&this.select.find("option:first").text()!==""){return}this.selection.find("span").html(this.opts.escapeMarkup(H));this.selection.addClass("select2-default");this.selection.find("abbr").hide()}},postprocessResults:function(K,I){var J=0,H=this,L=true;this.findHighlightableChoices().each2(function(M,N){if(q(H.id(N.data("select2-data")),H.opts.element.val())){J=M;return false}});this.highlight(J);if(I===true){L=this.showSearchInput=h(K.results)>=this.opts.minimumResultsForSearch;this.dropdown.find(".select2-search")[L?"removeClass":"addClass"]("select2-search-hidden");j(this.dropdown,this.container)[L?"addClass":"removeClass"]("select2-with-searchbox")}},onSelect:function(J,I){var H=this.opts.element.val();this.opts.element.val(this.id(J));this.updateSelection(J);this.opts.element.trigger({type:"selected",val:this.id(J),choice:J});this.close();if(!I||!I.noFocus){this.selection.focus()}if(!q(H,this.id(J))){this.triggerChange()}},updateSelection:function(J){var H=this.selection.find("span"),I;this.selection.data("select2-data",J);H.empty();I=this.opts.formatSelection(J,H);if(I!==l){H.append(this.opts.escapeMarkup(I))}this.selection.removeClass("select2-default");if(this.opts.allowClear&&this.getPlaceholder()!==l){this.selection.find("abbr").show()}},val:function(){var K,I=false,J=null,H=this;if(arguments.length===0){return this.opts.element.val()}K=arguments[0];if(arguments.length>1){I=arguments[1]}if(this.select){this.select.val(K).find(":selected").each2(function(L,M){J={id:M.attr("value")||M.text(),text:M.text()};return false});this.updateSelection(J);this.setPlaceholder();if(I){this.triggerChange()}}else{if(this.opts.initSelection===l){throw new Error("cannot call val() if initSelection() is not defined")}if(!K&&K!==0){this.clear();if(I){this.triggerChange()}return}this.opts.element.val(K);this.opts.initSelection(this.opts.element,function(L){H.opts.element.val(!L?"":H.id(L));H.updateSelection(L);H.setPlaceholder();if(I){H.triggerChange()}})}},clearSearch:function(){this.search.val("");this.focusser.val("")},data:function(I){var H;if(arguments.length===0){H=this.selection.data("select2-data");if(H==l){H=null}return H}else{if(!I||I===""){this.clear()}else{this.opts.element.val(!I?"":this.id(I));this.updateSelection(I)}}}});G=x(e,{createContainer:function(){var H=j(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["    <ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi' style='display:none;'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return H},prepareOpts:function(){var H=this.parent.prepareOpts.apply(this,arguments);if(H.element.get(0).tagName.toLowerCase()==="select"){H.initSelection=function(I,K){var J=[];I.find(":selected").each2(function(L,M){J.push({id:M.attr("value")||M.text(),text:M.text(),element:M[0]})});K(J)}}else{if("data" in H){H.initSelection=H.initSelection||function(I,K){var J=m(I.val(),H.separator);H.query({matcher:function(L,N,M){return j.grep(J,function(O){return q(O,H.id(M))}).length},callback:!j.isFunction(K)?j.noop:function(L){K(L.results)}})}}}return H},initContainer:function(){var H=".select2-choices",I;this.searchContainer=this.container.find(".select2-search-field");this.selection=I=this.container.find(H);this.search.bind("input paste",this.bind(function(){if(!this.enabled){return}if(!this.opened()){this.open()}}));this.search.bind("keydown",this.bind(function(K){if(!this.enabled){return}if(K.which===c.BACKSPACE&&this.search.val()===""){this.close();var L,J=I.find(".select2-search-choice-focus");if(J.length>0){this.unselect(J.first());this.search.width(10);d(K);return}L=I.find(".select2-search-choice:not(.select2-locked)");if(L.length>0){L.last().addClass("select2-search-choice-focus")}}else{I.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")}if(this.opened()){switch(K.which){case c.UP:case c.DOWN:this.moveHighlight((K.which===c.UP)?-1:1);d(K);return;case c.ENTER:case c.TAB:this.selectHighlighted();d(K);return;case c.ESC:this.cancel(K);d(K);return}}if(K.which===c.TAB||c.isControl(K)||c.isFunctionKey(K)||K.which===c.BACKSPACE||K.which===c.ESC){return}if(K.which===c.ENTER){if(this.opts.openOnEnter===false){return}else{if(K.altKey||K.ctrlKey||K.shiftKey||K.metaKey){return}}}this.open();if(K.which===c.PAGE_UP||K.which===c.PAGE_DOWN){d(K)}}));this.search.bind("keyup",this.bind(this.resizeSearch));this.search.bind("blur",this.bind(function(J){this.container.removeClass("select2-container-active");this.search.removeClass("select2-focused");if(!this.opened()){this.clearSearch()}J.stopImmediatePropagation()}));this.container.delegate(H,"mousedown",this.bind(function(J){if(!this.enabled){return}if(j(J.target).closest(".select2-search-choice").length>0){return}this.clearPlaceholder();this.open();this.focusSearch();J.preventDefault()}));this.container.delegate(H,"focus",this.bind(function(){if(!this.enabled){return}this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active");this.clearPlaceholder()}));this.clearSearch()},enable:function(){if(this.enabled){return}this.parent.enable.apply(this,arguments);this.search.removeAttr("disabled")},disable:function(){if(!this.enabled){return}this.parent.disable.apply(this,arguments);this.search.attr("disabled",true)},initSelection:function(){var I;if(this.opts.element.val()===""&&this.opts.element.text()===""){this.updateSelection([]);this.close();this.clearSearch()}if(this.select||this.opts.element.val()!==""){var H=this;this.opts.initSelection.call(null,this.opts.element,function(J){if(J!==l&&J!==null){H.updateSelection(J);H.close();H.clearSearch()}})}},clearSearch:function(){var H=this.getPlaceholder();if(H!==l&&this.getVal().length===0&&this.search.hasClass("select2-focused")===false){this.search.val(H).addClass("select2-default");this.resizeSearch()}else{this.search.val("").width(10)}},clearPlaceholder:function(){if(this.search.hasClass("select2-default")){this.search.val("").removeClass("select2-default")}},opening:function(){this.parent.opening.apply(this,arguments);this.clearPlaceholder();this.resizeSearch();this.focusSearch();this.opts.element.trigger(j.Event("open"))},close:function(){if(!this.opened()){return}this.parent.close.apply(this,arguments)},focus:function(){this.close();this.search.focus();this.opts.element.triggerHandler("focus")},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(K){var J=[],I=[],H=this;j(K).each(function(){if(b(H.id(this),J)<0){J.push(H.id(this));I.push(this)}});K=I;this.selection.find(".select2-search-choice").remove();j(K).each(function(){H.addSelectedChoice(this)});H.postprocessResults()},tokenize:function(){var H=this.search.val();H=this.opts.tokenizer(H,this.data(),this.bind(this.onSelect),this.opts);if(H!=null&&H!=l){this.search.val(H);if(H.length>0){this.open()}}},onSelect:function(I,H){this.addSelectedChoice(I);this.opts.element.trigger({type:"selected",val:this.id(I),choice:I});if(this.select||!this.opts.closeOnSelect){this.postprocessResults()}if(this.opts.closeOnSelect){this.close();this.search.width(10)}else{if(this.countSelectableResults()>0){this.search.width(10);this.resizeSearch();if(this.val().length>=this.getMaximumSelectionSize()){this.updateResults(true)}this.positionDropdown()}else{this.close();this.search.width(10)}}this.triggerChange({added:I});if(!H||!H.noFocus){this.focusSearch()}},cancel:function(){this.close();this.focusSearch()},addSelectedChoice:function(K){var I=!K.locked,O=j("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),N=j("<li class='select2-search-choice select2-locked'><div></div></li>");var H=I?O:N,M=this.id(K),L=this.getVal(),J;J=this.opts.formatSelection(K,H.find("div"));if(J!=l){H.find("div").replaceWith("<div>"+this.opts.escapeMarkup(J)+"</div>")}if(I){H.find(".select2-search-choice-close").bind("mousedown",d).bind("click dblclick",this.bind(function(P){if(!this.enabled){return}j(P.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(j(P.target));this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");this.close();this.focusSearch()})).dequeue();d(P)})).bind("focus",this.bind(function(){if(!this.enabled){return}this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active")}))}H.data("select2-data",K);H.insertBefore(this.searchContainer);L.push(M);this.setVal(L)},unselect:function(I){var K=this.getVal(),J,H;I=I.closest(".select2-search-choice");if(I.length===0){throw"Invalid argument: "+I+". Must be .select2-search-choice"}J=I.data("select2-data");if(!J){return}H=b(this.id(J),K);if(H>=0){K.splice(H,1);this.setVal(K);if(this.select){this.postprocessResults()}}I.remove();this.opts.element.trigger({type:"removed",val:this.id(J),choice:J});this.triggerChange({removed:J})},postprocessResults:function(){var J=this.getVal(),K=this.results.find(".select2-result"),I=this.results.find(".select2-result-with-children"),H=this;K.each2(function(M,L){var N=H.id(L.data("select2-data"));if(b(N,J)>=0){L.addClass("select2-selected");L.find(".select2-result-selectable").addClass("select2-selected")}});I.each2(function(M,L){if(!L.is(".select2-result-selectable")&&L.find(".select2-result-selectable:not(.select2-selected)").length===0){L.addClass("select2-selected")}});if(this.highlight()==-1){H.highlight(0)}},resizeSearch:function(){var M,K,J,H,I,L=n(this.search);M=z(this.search)+10;K=this.search.offset().left;J=this.selection.width();H=this.selection.offset().left;I=J-(K-H)-L;if(I<M){I=J-L}if(I<40){I=J-L}if(I<=0){I=M}this.search.width(I)},getVal:function(){var H;if(this.select){H=this.select.val();return H===null?[]:H}else{H=this.opts.element.val();return m(H,this.opts.separator)}},setVal:function(I){var H;if(this.select){this.select.val(I)}else{H=[];j(I).each(function(){if(b(this,H)<0){H.push(this)}});this.opts.element.val(H.length===0?"":H.join(this.opts.separator))}},val:function(){var K,I=false,J=[],H=this;if(arguments.length===0){return this.getVal()}K=arguments[0];if(arguments.length>1){I=arguments[1]}if(!K&&K!==0){this.opts.element.val("");this.updateSelection([]);this.clearSearch();if(I){this.triggerChange()}return}this.setVal(K);if(this.select){this.opts.initSelection(this.select,this.bind(this.updateSelection));if(I){this.triggerChange()}}else{if(this.opts.initSelection===l){throw new Error("val() cannot be called if initSelection() is not defined")}this.opts.initSelection(this.opts.element,function(M){var L=j(M).map(H.id);H.setVal(L);H.updateSelection(M);H.clearSearch();if(I){H.triggerChange()}})}this.clearSearch()},onSortStart:function(){if(this.select){throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.")}this.search.width(0);this.searchContainer.hide()},onSortEnd:function(){var I=[],H=this;this.searchContainer.show();this.searchContainer.appendTo(this.searchContainer.parent());this.resizeSearch();this.selection.find(".select2-search-choice").each(function(){I.push(H.opts.id(j(this).data("select2-data")))});this.setVal(I);this.triggerChange()},data:function(I){var H=this,J;if(arguments.length===0){return this.selection.find(".select2-search-choice").map(function(){return j(this).data("select2-data")}).get()}else{if(!I){I=[]}J=j.map(I,function(K){return H.opts.id(K)});this.setVal(J);this.updateSelection(I);this.clearSearch()}}});j.fn.select2=function(){var K=Array.prototype.slice.call(arguments,0),L,J,M,I,H=["val","destroy","opened","open","close","focus","isFocused","container","onSortStart","onSortEnd","enable","disable","positionDropdown","data"];this.each(function(){if(K.length===0||typeof(K[0])==="object"){L=K.length===0?{}:j.extend({},K[0]);L.element=j(this);if(L.element.get(0).tagName.toLowerCase()==="select"){I=L.element.attr("multiple")}else{I=L.multiple||false;if("tags" in L){L.multiple=I=true}}J=I?new G():new w();J.init(L)}else{if(typeof(K[0])==="string"){if(b(K[0],H)<0){throw"Unknown method: "+K[0]}M=l;J=j(this).data("select2");if(J===l){return}if(K[0]==="container"){M=J.container}else{M=J[K[0]].apply(J,K.slice(1))}if(M!==l){return false}}else{throw"Invalid arguments to select2 plugin: "+K}}});return(M===l)?this:M};j.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:true,openOnEnter:true,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(I,J,L,H){var K=[];i(I.text,L.term,K,H);return K.join("")},formatSelection:function(I,H){return I?I.text:l},sortResults:function(I,H,J){return I},formatResultCssClass:function(H){return l},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(H,I){var J=I-H.length;return"Please enter "+J+" more character"+(J==1?"":"s")},formatInputTooLong:function(I,H){var J=I.length-H;return"Please enter "+J+" less character"+(J==1?"":"s")},formatSelectionTooBig:function(H){return"You can only select "+H+" item"+(H==1?"":"s")},formatLoadMore:function(H){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(H){return H.id},matcher:function(H,I){return I.toUpperCase().indexOf(H.toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:A,escapeMarkup:function(H){var I={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;","/":"&#47;"};return String(H).replace(/[&<>"'/\\]/g,function(J){return I[J[0]]})},blurOnChange:false,selectOnBlur:false,adaptContainerCssClass:function(H){return H},adaptDropdownCssClass:function(H){return null}};window.Select2={query:{ajax:p,local:s,tags:o},util:{debounce:g,markMatch:i},"class":{"abstract":e,single:w,multi:G}}}(jQuery));eval(function(h,b,j,f,g,i){g=function(a){return(a<b?"":g(parseInt(a/b)))+((a=a%b)>35?String.fromCharCode(a+29):a.toString(36))};while(j--){if(f[j]){h=h.replace(new RegExp("\\b"+g(j)+"\\b","g"),f[j])}}return h}('(m($){18 W=2v.4T,D=2v.4S,F=2v.4R,u=2v.4Q;m V(){C $("<4P/>")};$.N=m(T,c){18 O=$(T),1F,A=V(),1k=V(),I=V().r(V()).r(V()).r(V()),B=V().r(V()).r(V()).r(V()),E=$([]),1K,G,l,17={v:0,l:0},Q,M,1l,1g={v:0,l:0},12=0,1J="1H",2k,2j,1t,1s,S,1B,1A,2o,2n,14,1Q,a,b,j,g,f={a:0,b:0,j:0,g:0,H:0,L:0},2u=R.4O,1M=4N.4M,$p,d,i,o,w,h,2p;m 1n(x){C x+17.v-1g.v};m 1m(y){C y+17.l-1g.l};m 1b(x){C x-17.v+1g.v};m 1a(y){C y-17.l+1g.l};m 1z(3J){C 3J.4L-1g.v};m 1y(3I){C 3I.4K-1g.l};m 13(32){18 1i=32||1t,1h=32||1s;C{a:u(f.a*1i),b:u(f.b*1h),j:u(f.j*1i),g:u(f.g*1h),H:u(f.j*1i)-u(f.a*1i),L:u(f.g*1h)-u(f.b*1h)}};m 23(a,b,j,g,31){18 1i=31||1t,1h=31||1s;f={a:u(a/1i||0),b:u(b/1h||0),j:u(j/1i||0),g:u(g/1h||0)};f.H=f.j-f.a;f.L=f.g-f.b};m 1f(){9(!1F||!O.H()){C}17={v:u(O.2t().v),l:u(O.2t().l)};Q=O.2Y();M=O.3H();17.l+=(O.30()-M)>>1;17.v+=(O.2q()-Q)>>1;1B=u(c.4J/1t)||0;1A=u(c.4I/1s)||0;2o=u(F(c.4H/1t||1<<24,Q));2n=u(F(c.4G/1s||1<<24,M));9($().4F=="1.3.2"&&1J=="21"&&!2u["4E"]){17.l+=D(R.1q.2r,2u.2r);17.v+=D(R.1q.2s,2u.2s)}1g=/1H|4D/.1c(1l.q("1p"))?{v:u(1l.2t().v)-1l.2s(),l:u(1l.2t().l)-1l.2r()}:1J=="21"?{v:$(R).2s(),l:$(R).2r()}:{v:0,l:0};G=1n(0);l=1m(0);9(f.j>Q||f.g>M){1U()}};m 1V(3F){9(!1Q){C}A.q({v:1n(f.a),l:1m(f.b)}).r(1k).H(w=f.H).L(h=f.L);1k.r(I).r(E).q({v:0,l:0});I.H(D(w-I.2q()+I.2Y(),0)).L(D(h-I.30()+I.3H(),0));$(B[0]).q({v:G,l:l,H:f.a,L:M});$(B[1]).q({v:G+f.a,l:l,H:w,L:f.b});$(B[2]).q({v:G+f.j,l:l,H:Q-f.j,L:M});$(B[3]).q({v:G+f.a,l:l+f.g,H:w,L:M-f.g});w-=E.2q();h-=E.30();2O(E.3f){15 8:$(E[4]).q({v:w>>1});$(E[5]).q({v:w,l:h>>1});$(E[6]).q({v:w>>1,l:h});$(E[7]).q({l:h>>1});15 4:E.3G(1,3).q({v:w});E.3G(2,4).q({l:h})}9(3F!==Y){9($.N.2Z!=2R){$(R).U($.N.2z,$.N.2Z)}9(c.1T){$(R)[$.N.2z]($.N.2Z=2R)}}9(1j&&I.2q()-I.2Y()==2){I.q("3E",0);3x(m(){I.q("3E","4C")},0)}};m 22(3D){1f();1V(3D);a=1n(f.a);b=1m(f.b);j=1n(f.j);g=1m(f.g)};m 27(2X,2w){c.1P?2X.4B(c.1P,2w):2X.1r()};m 1d(2W){18 x=1b(1z(2W))-f.a,y=1a(1y(2W))-f.b;9(!2p){1f();2p=11;A.1G("4A",m(){2p=Y})}S="";9(c.2D){9(y<=c.1W){S="n"}X{9(y>=f.L-c.1W){S="s"}}9(x<=c.1W){S+="w"}X{9(x>=f.H-c.1W){S+="e"}}}A.q("2V",S?S+"-19":c.26?"4z":"");9(1K){1K.4y()}};m 2S(4x){$("1q").q("2V","");9(c.4w||f.H*f.L==0){27(A.r(B),m(){$(J).1r()})}$(R).U("P",2l);A.P(1d);c.2f(T,13())};m 2C(1X){9(1X.3z!=1){C Y}1f();9(S){$("1q").q("2V",S+"-19");a=1n(f[/w/.1c(S)?"j":"a"]);b=1m(f[/n/.1c(S)?"g":"b"]);$(R).P(2l).1G("1x",2S);A.U("P",1d)}X{9(c.26){2k=G+f.a-1z(1X);2j=l+f.b-1y(1X);A.U("P",1d);$(R).P(2T).1G("1x",m(){c.2f(T,13());$(R).U("P",2T);A.P(1d)})}X{O.1O(1X)}}C Y};m 1w(3C){9(14){9(3C){j=D(G,F(G+Q,a+W(g-b)*14*(j>a||-1)));g=u(D(l,F(l+M,b+W(j-a)/14*(g>b||-1))));j=u(j)}X{g=D(l,F(l+M,b+W(j-a)/14*(g>b||-1)));j=u(D(G,F(G+Q,a+W(g-b)*14*(j>a||-1))));g=u(g)}}};m 1U(){a=F(a,G+Q);b=F(b,l+M);9(W(j-a)<1B){j=a-1B*(j<a||-1);9(j<G){a=G+1B}X{9(j>G+Q){a=G+Q-1B}}}9(W(g-b)<1A){g=b-1A*(g<b||-1);9(g<l){b=l+1A}X{9(g>l+M){b=l+M-1A}}}j=D(G,F(j,G+Q));g=D(l,F(g,l+M));1w(W(j-a)<W(g-b)*14);9(W(j-a)>2o){j=a-2o*(j<a||-1);1w()}9(W(g-b)>2n){g=b-2n*(g<b||-1);1w(11)}f={a:1b(F(a,j)),j:1b(D(a,j)),b:1a(F(b,g)),g:1a(D(b,g)),H:W(j-a),L:W(g-b)};1V();c.2g(T,13())};m 2l(2U){j=/w|e|^$/.1c(S)||14?1z(2U):1n(f.j);g=/n|s|^$/.1c(S)||14?1y(2U):1m(f.g);1U();C Y};m 1v(3B,3A){j=(a=3B)+f.H;g=(b=3A)+f.L;$.2c(f,{a:1b(a),b:1a(b),j:1b(j),g:1a(g)});1V();c.2g(T,13())};m 2T(2m){a=D(G,F(2k+1z(2m),G+Q-f.H));b=D(l,F(2j+1y(2m),l+M-f.L));1v(a,b);2m.4v();C Y};m 2h(){$(R).U("P",2h);1f();j=a;g=b;1U();S="";9(!B.2y(":4u")){A.r(B).1r().2E(c.1P||0)}1Q=11;$(R).U("1x",1N).P(2l).1G("1x",2S);A.U("P",1d);c.3y(T,13())};m 1N(){$(R).U("P",2h).U("1x",1N);27(A.r(B));23(1b(a),1a(b),1b(a),1a(b));9(!(J 4t $.N)){c.2g(T,13());c.2f(T,13())}};m 2A(2i){9(2i.3z!=1||B.2y(":4s")){C Y}1f();2k=a=1z(2i);2j=b=1y(2i);$(R).P(2h).1x(1N);C Y};m 2B(){22(Y)};m 2x(){1F=11;25(c=$.2c({1S:"4r",26:11,20:"1q",2D:11,1W:10,3w:m(){},3y:m(){},2g:m(){},2f:m(){}},c));A.r(B).q({3b:""});9(c.2F){1Q=11;1f();1V();A.r(B).1r().2E(c.1P||0)}3x(m(){c.3w(T,13())},0)};18 2R=m(16){18 k=c.1T,d,t,2N=16.4q;d=!1L(k.2P)&&(16.2e||16.3t.2e)?k.2P:!1L(k.2a)&&16.3u?k.2a:!1L(k.2b)&&16.3v?k.2b:!1L(k.2Q)?k.2Q:10;9(k.2Q=="19"||(k.2b=="19"&&16.3v)||(k.2a=="19"&&16.3u)||(k.2P=="19"&&(16.2e||16.3t.2e))){2O(2N){15 37:d=-d;15 39:t=D(a,j);a=F(a,j);j=D(t+d,a);1w();1u;15 38:d=-d;15 40:t=D(b,g);b=F(b,g);g=D(t+d,b);1w(11);1u;3s:C}1U()}X{a=F(a,j);b=F(b,g);2O(2N){15 37:1v(D(a-d,G),b);1u;15 38:1v(a,D(b-d,l));1u;15 39:1v(a+F(d,Q-1b(j)),b);1u;15 40:1v(a,b+F(d,M-1a(g)));1u;3s:C}}C Y};m 1R(3r,2M){3p(18 2d 4p 2M){9(c[2d]!==1Y){3r.q(2M[2d],c[2d])}}};m 25(K){9(K.20){(1l=$(K.20)).2G(A.r(B))}$.2c(c,K);1f();9(K.2L!=3q){E.1o();E=$([]);i=K.2L?K.2L=="4o"?4:8:0;3g(i--){E=E.r(V())}E.29(c.1S+"-4n").q({1p:"1H",36:0,1I:12+1||1});9(!4m(E.q("H"))>=0){E.H(5).L(5)}9(o=c.2K){E.q({2K:o,2H:"3m"})}1R(E,{3n:"2J-28",3l:"2I-28",3o:"1e"})}1t=c.4l/Q||1;1s=c.4k/M||1;9(K.a!=3q){23(K.a,K.b,K.j,K.g);K.2F=!K.1r}9(K.1T){c.1T=$.2c({2b:1,2a:"19"},K.1T)}B.29(c.1S+"-4j");1k.29(c.1S+"-4i");3p(i=0;i++<4;){$(I[i-1]).29(c.1S+"-2J"+i)}1R(1k,{4h:"2I-28",4g:"1e"});1R(I,{3o:"1e",2K:"2J-H"});1R(B,{4f:"2I-28",4e:"1e"});9(o=c.3n){$(I[0]).q({2H:"3m",3k:o})}9(o=c.3l){$(I[1]).q({2H:"4d",3k:o})}A.2G(1k.r(I).r(1K)).2G(E);9(1j){9(o=(B.q("3j")||"").3i(/1e=(\\d+)/)){B.q("1e",o[1]/1Z)}9(o=(I.q("3j")||"").3i(/1e=(\\d+)/)){I.q("1e",o[1]/1Z)}}9(K.1r){27(A.r(B))}X{9(K.2F&&1F){1Q=11;A.r(B).2E(c.1P||0);22()}}14=(d=(c.4c||"").4b(/:/))[0]/d[1];O.r(B).U("1O",2A);9(c.1E||c.1D===Y){A.U("P",1d).U("1O",2C);$(3h).U("19",2B)}X{9(c.1D||c.1E===Y){9(c.2D||c.26){A.P(1d).1O(2C)}$(3h).19(2B)}9(!c.4a){O.r(B).1O(2A)}}c.1D=c.1E=1Y};J.1o=m(){25({1E:11});A.r(B).1o()};J.49=m(){C c};J.33=25;J.48=13;J.47=23;J.46=1N;J.45=22;18 1j=(/44 ([\\w.]+)/i.43(1M)||[])[1],3c=/42/i.1c(1M),3d=/41/i.1c(1M)&&!/3Z/i.1c(1M);$p=O;3g($p.3f){12=D(12,!1L($p.q("z-3e"))?$p.q("z-3e"):12);9($p.q("1p")=="21"){1J="21"}$p=$p.20(":3Y(1q)")}12=c.1I||12;9(1j){O.3X("3W","3V")}$.N.2z=1j||3d?"3U":"3T";9(3c){1K=V().q({H:"1Z%",L:"1Z%",1p:"1H",1I:12+2||2})}A.r(B).q({3b:"3a",1p:1J,3S:"3a",1I:12||"0"});A.q({1I:12+2||2});1k.r(I).q({1p:"1H",36:0});T.35||T.3R=="35"||!O.2y("3Q")?2x():O.1G("3P",2x);9(!1F&&1j&&1j>=7){T.34=T.34}};$.2w.N=m(Z){Z=Z||{};J.3O(m(){9($(J).1C("N")){9(Z.1o){$(J).1C("N").1o();$(J).3N("N")}X{$(J).1C("N").33(Z)}}X{9(!Z.1o){9(Z.1D===1Y&&Z.1E===1Y){Z.1D=11}$(J).1C("N",3M $.N(J,Z))}}});9(Z.3L){C $(J).1C("N")}C J}})(3K);',62,304,"|||||||||if|x1|y1|_7|||_23|y2|||x2||top|function||||css|add|||_4|left|||||_a|_d|return|_2|_e|_3|_10|width|_c|this|_55|height|_13|imgAreaSelect|_8|mousemove|_12|document|_1c|_6|unbind|_5|_1|else|false|_58||true|_16|_2c|_21|case|_50|_11|var|resize|_29|_28|test|_3a|opacity|_30|_15|sy|sx|_35|_b|_14|_27|_26|remove|position|body|hide|_1b|_1a|break|_45|_42|mouseup|evY|evX|_1e|_1d|data|enable|disable|_9|one|absolute|zIndex|_17|_f|isNaN|ua|_4a|mousedown|fadeSpeed|_22|_51|classPrefix|keys|_31|_32|resizeMargin|_40|undefined|100|parent|fixed|_36|_2e||_4f|movable|_38|color|addClass|ctrl|shift|extend|_54|altKey|onSelectEnd|onSelectChange|_49|_4c|_19|_18|_3e|_48|_20|_1f|_25|outerWidth|scrollTop|scrollLeft|offset|_24|Math|fn|_4e|is|keyPress|_4b|_4d|_3f|resizable|fadeIn|show|append|borderStyle|background|border|borderWidth|handles|_53|key|switch|alt|arrows|_34|_3c|_41|_44|cursor|_3b|_39|innerWidth|onKeyPress|outerHeight|_2f|_2d|setOptions|src|complete|fontSize||||hidden|visibility|_56|_57|index|length|while|window|match|filter|borderColor|borderColor2|solid|borderColor1|borderOpacity|for|null|_52|default|originalEvent|ctrlKey|shiftKey|onInit|setTimeout|onSelectStart|which|_47|_46|_43|_37|margin|_33|slice|innerHeight|_2b|_2a|jQuery|instance|new|removeData|each|load|img|readyState|overflow|keypress|keydown|on|unselectable|attr|not|chrome||webkit|opera|exec|msie|update|cancelSelection|setSelection|getSelection|getOptions|persistent|split|aspectRatio|dashed|outerOpacity|outerColor|selectionOpacity|selectionColor|selection|outer|imageHeight|imageWidth|parseInt|handle|corners|in|keyCode|imgareaselect|animated|instanceof|visible|preventDefault|autoHide|_3d|toggle|move|mouseout|fadeOut|auto|relative|getBoundingClientRect|jquery|maxHeight|maxWidth|minHeight|minWidth|pageY|pageX|userAgent|navigator|documentElement|div|round|min|max|abs".split("|")));var qq=function(b){return{hide:function(){b.style.display="none";return this},attach:function(a,d){b.addEventListener?b.addEventListener(a,d,!1):b.attachEvent&&b.attachEvent("on"+a,d);return function(){qq(b).detach(a,d)}},detach:function(a,d){b.removeEventListener?b.removeEventListener(a,d,!1):b.attachEvent&&b.detachEvent("on"+a,d);return this},contains:function(a){return b===a?!0:b.contains?b.contains(a):!!(a.compareDocumentPosition(b)&8)},insertBefore:function(a){a.parentNode.insertBefore(b,a);return this},remove:function(){b.parentNode.removeChild(b);return this},css:function(a){null!==a.opacity&&("string"!==typeof b.style.opacity&&"undefined"!==typeof b.filters)&&(a.filter="alpha(opacity="+Math.round(100*a.opacity)+")");qq.extend(b.style,a);return this},hasClass:function(a){return RegExp("(^| )"+a+"( |$)").test(b.className)},addClass:function(a){qq(b).hasClass(a)||(b.className+=" "+a);return this},removeClass:function(a){b.className=b.className.replace(RegExp("(^| )"+a+"( |$)")," ").replace(/^\s+|\s+$/g,"");return this},getByClass:function(a){var f,e=[];if(b.querySelectorAll){return b.querySelectorAll("."+a)}f=b.getElementsByTagName("*");qq.each(f,function(d,g){qq(g).hasClass(a)&&e.push(g)});return e},children:function(){for(var a=[],d=b.firstChild;d;){1===d.nodeType&&a.push(d),d=d.nextSibling}return a},setText:function(a){b.innerText=a;b.textContent=a;return this},clearText:function(){return qq(b).setText("")}}};qq.log=function(d,c){if(window.console){if(!c||"info"===c){window.console.log(d)}else{if(window.console[c]){window.console[c](d)}else{window.console.log("<"+c+"> "+d)}}}};qq.isObject=function(b){return null!==b&&b&&"object"===typeof b&&b.constructor===Object};qq.isFunction=function(b){return"function"===typeof b};qq.isString=function(b){return"[object String]"===Object.prototype.toString.call(b)};qq.trimStr=function(b){return String.prototype.trim?b.trim():b.replace(/^\s+|\s+$/g,"")};qq.isFileOrInput=function(b){if(window.File&&b instanceof File){return !0}if(window.HTMLInputElement){if(b instanceof HTMLInputElement&&b.type&&"file"===b.type.toLowerCase()){return !0}}else{if(b.tagName&&"input"===b.tagName.toLowerCase()&&b.type&&"file"===b.type.toLowerCase()){return !0}}return !1};qq.isBlob=function(b){return window.Blob&&"[object Blob]"===Object.prototype.toString.call(b)};qq.isXhrUploadSupported=function(){var b=document.createElement("input");b.type="file";return void 0!==b.multiple&&"undefined"!==typeof File&&"undefined"!==typeof FormData&&"undefined"!==typeof(new XMLHttpRequest).upload};qq.isFolderDropSupported=function(b){return b.items&&b.items[0].webkitGetAsEntry};qq.isFileChunkingSupported=function(){return !qq.android()&&qq.isXhrUploadSupported()&&(void 0!==File.prototype.slice||void 0!==File.prototype.webkitSlice||void 0!==File.prototype.mozSlice)};qq.extend=function(e,d,f){qq.each(d,function(a,c){f&&qq.isObject(c)?(void 0===e[a]&&(e[a]={}),qq.extend(e[a],c,!0)):e[a]=c})};qq.indexOf=function(f,e,h){if(f.indexOf){return f.indexOf(e,h)}var h=h||0,g=f.length;for(0>h&&(h+=g);h<g;h+=1){if(f.hasOwnProperty(h)&&f[h]===e){return h}}return -1};qq.getUniqueId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(d){var c=16*Math.random()|0;return("x"==d?c:c&3|8).toString(16)})};qq.ie=function(){return -1!==navigator.userAgent.indexOf("MSIE")};qq.ie10=function(){return -1!==navigator.userAgent.indexOf("MSIE 10")};qq.safari=function(){return void 0!==navigator.vendor&&-1!==navigator.vendor.indexOf("Apple")};qq.chrome=function(){return void 0!==navigator.vendor&&-1!==navigator.vendor.indexOf("Google")};qq.firefox=function(){return -1!==navigator.userAgent.indexOf("Mozilla")&&void 0!==navigator.vendor&&""===navigator.vendor};qq.windows=function(){return"Win32"===navigator.platform};qq.android=function(){return -1!==navigator.userAgent.toLowerCase().indexOf("android")};qq.preventDefault=function(b){b.preventDefault?b.preventDefault():b.returnValue=!1};qq.toElement=function(){var b=document.createElement("div");return function(a){b.innerHTML=a;a=b.firstChild;b.removeChild(a);return a}}();qq.each=function(f,e){var h,g;if(f){for(h in f){if(Object.prototype.hasOwnProperty.call(f,h)&&(g=e(h,f[h]),!1===g)){break}}}};qq.obj2url=function(i,h,n){var l,k=[],j="&",g=function(b,f){var e=h?/\[\]$/.test(h)?h:h+"["+f+"]":f;"undefined"!==e&&"undefined"!==f&&k.push("object"===typeof b?qq.obj2url(b,e,!0):"[object Function]"===Object.prototype.toString.call(b)?encodeURIComponent(e)+"="+encodeURIComponent(b()):encodeURIComponent(e)+"="+encodeURIComponent(b))};if(!n&&h){j=/\?/.test(h)?/\?$/.test(h)?"":"&":"?",k.push(h),k.push(qq.obj2url(i))}else{if("[object Array]"===Object.prototype.toString.call(i)&&"undefined"!==typeof i){l=-1;for(n=i.length;l<n;l+=1){g(i[l],l)}}else{if("undefined"!==typeof i&&null!==i&&"object"===typeof i){for(l in i){i.hasOwnProperty(l)&&g(i[l],l)}}else{k.push(encodeURIComponent(h)+"="+encodeURIComponent(i))}}}return h?k.join(j):k.join(j).replace(/^&/,"").replace(/%20/g,"+")};qq.obj2FormData=function(e,d,f){d||(d=new FormData);qq.each(e,function(b,c){b=f?f+"["+b+"]":b;qq.isObject(c)?qq.obj2FormData(c,d,b):qq.isFunction(c)?d.append(b,c()):d.append(b,c)});return d};qq.obj2Inputs=function(e,d){var f;d||(d=document.createElement("form"));qq.obj2FormData(e,{append:function(b,c){f=document.createElement("input");f.setAttribute("name",b);f.setAttribute("value",c);d.appendChild(f)}});return d};qq.setCookie=function(g,f,j){var i=new Date,h="";j&&(i.setTime(i.getTime()+86400000*j),h="; expires="+i.toGMTString());document.cookie=g+"="+f+h+"; path=/"};qq.getCookie=function(f){for(var f=f+"=",e=document.cookie.split(";"),h,g=0;g<e.length;g++){for(h=e[g];" "==h.charAt(0);){h=h.substring(1,h.length)}if(0===h.indexOf(f)){return h.substring(f.length,h.length)}}};qq.getCookieNames=function(e){var d=document.cookie.split(";"),f=[];qq.each(d,function(a,g){var g=qq.trimStr(g),c=g.indexOf("=");g.match(e)&&f.push(g.substr(0,c))});return f};qq.deleteCookie=function(b){qq.setCookie(b,"",-1)};qq.areCookiesEnabled=function(){var b="qqCookieTest:"+100000*Math.random();qq.setCookie(b,1);return qq.getCookie(b)?(qq.deleteCookie(b),!0):!1};qq.parseJson=function(a){return window.JSON&&qq.isFunction(JSON.parse)?JSON.parse(a):eval("("+a+")")};qq.DisposeSupport=function(){var b=[];return{dispose:function(){var a;do{(a=b.shift())&&a()}while(a)},attach:function(){this.addDisposer(qq(arguments[0]).attach.apply(this,Array.prototype.slice.call(arguments,1)))},addDisposer:function(a){b.push(a)}}};qq.supportedFeatures=function(){var i,h,n,l,k,j;i=!0;try{h=document.createElement("input"),h.type="file",qq(h).hide(),h.disabled&&(i=!1)}catch(g){i=!1}n=(h=i&&qq.isXhrUploadSupported())&&qq.chrome()&&void 0!==navigator.userAgent.match(/Chrome\/[2][1-9]|Chrome\/[3-9][0-9]/);l=h&&qq.isFileChunkingSupported();k=h&&l&&qq.areCookiesEnabled();j=h&&qq.chrome()&&void 0!==navigator.userAgent.match(/Chrome\/[1][4-9]|Chrome\/[2-9][0-9]/);return{uploading:i,ajaxUploading:h,fileDrop:h,folderDrop:n,chunking:l,resume:k,uploadCustomHeaders:h,uploadNonMultipart:h,itemSizeValidation:h,uploadViaPaste:j,progressBar:h,uploadCors:i&&(void 0!==window.postMessage||h),deleteFileCors:h}}();qq.Promise=function(){var h,g,l,k,j,i=0;return{then:function(b,a){0===i?(l=b,k=a):-1===i&&a?a(g):b&&b(h);return this},done:function(b){0===i?j=b:b();return this},success:function(a){i=1;h=a;l&&l(a);j&&j();return this},failure:function(b){i=-1;g=b;k&&k(b);j&&j();return this}}};qq.UploadButton=function(g){function f(){var b=document.createElement("input");h.multiple&&b.setAttribute("multiple","multiple");h.acceptFiles&&b.setAttribute("accept",h.acceptFiles);b.setAttribute("type","file");b.setAttribute("name",h.name);qq(b).css({position:"absolute",right:0,top:0,fontFamily:"Arial",fontSize:"118px",margin:0,padding:0,cursor:"pointer",opacity:0});h.element.appendChild(b);i.attach(b,"change",function(){h.onChange(b)});i.attach(b,"mouseover",function(){qq(h.element).addClass(h.hoverClass)});i.attach(b,"mouseout",function(){qq(h.element).removeClass(h.hoverClass)});i.attach(b,"focus",function(){qq(h.element).addClass(h.focusClass)});i.attach(b,"blur",function(){qq(h.element).removeClass(h.focusClass)});window.attachEvent&&b.setAttribute("tabIndex","-1");return b}var j,i=new qq.DisposeSupport,h={element:null,multiple:!1,acceptFiles:null,name:"file",onChange:function(){},hoverClass:"qq-upload-button-hover",focusClass:"qq-upload-button-focus"};qq.extend(h,g);qq(h.element).css({position:"relative",overflow:"hidden",direction:"ltr"});j=f();return{getInput:function(){return j},reset:function(){j.parentNode&&qq(j).remove();qq(h.element).removeClass(h.focusClass);j=f()}}};qq.PasteSupport=function(d){var c;c={targetElement:null,callbacks:{log:function(){},pasteReceived:function(){}}};qq.extend(c,d);(function(){qq(c.targetElement).attach("paste",function(b){(b=b.clipboardData)&&qq.each(b.items,function(e,h){if(h.type&&0===h.type.indexOf("image/")){var g=h.getAsFile();c.callbacks.pasteReceived(g)}})})})();return{reset:function(){}}};qq.FineUploaderBasic=function(b){this._options={debug:!1,button:null,multiple:!0,maxConnections:3,disableCancelForFormUploads:!1,autoUpload:!0,request:{endpoint:"/server/upload",params:{},paramsInBody:!0,customHeaders:{},forceMultipart:!0,inputName:"qqfile",uuidName:"qquuid",totalFileSizeName:"qqtotalfilesize"},validation:{allowedExtensions:[],sizeLimit:0,minSizeLimit:0,itemLimit:0,stopOnFirstInvalidFile:!0},callbacks:{onSubmit:function(){},onSubmitted:function(){},onComplete:function(){},onCancel:function(){},onUpload:function(){},onUploadChunk:function(){},onResume:function(){},onProgress:function(){},onError:function(){},onAutoRetry:function(){},onManualRetry:function(){},onValidateBatch:function(){},onValidate:function(){},onSubmitDelete:function(){},onDelete:function(){},onDeleteComplete:function(){},onPasteReceived:function(){}},messages:{typeError:"{file} has an invalid extension. Valid extension(s): {extensions}.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",noFilesError:"No files to upload.",tooManyItemsError:"Too many items ({netItems}) would be uploaded.  Item limit is {itemLimit}.",retryFailTooManyItems:"Retry failed - you have reached your file limit.",onLeave:"The files are being uploaded, if you leave now the upload will be cancelled."},retry:{enableAuto:!1,maxAutoAttempts:3,autoAttemptDelay:5,preventRetryResponseProperty:"preventRetry"},classes:{buttonHover:"qq-upload-button-hover",buttonFocus:"qq-upload-button-focus"},chunking:{enabled:!1,partSize:2000000,paramNames:{partIndex:"qqpartindex",partByteOffset:"qqpartbyteoffset",chunkSize:"qqchunksize",totalFileSize:"qqtotalfilesize",totalParts:"qqtotalparts",filename:"qqfilename"}},resume:{enabled:!1,id:null,cookiesExpireIn:7,paramNames:{resuming:"qqresume"}},formatFileName:function(c){33<c.length&&(c=c.slice(0,19)+"..."+c.slice(-14));return c},text:{defaultResponseError:"Upload failure reason unknown",sizeSymbols:"kB MB GB TB PB EB".split(" ")},deleteFile:{enabled:!1,endpoint:"/server/upload",customHeaders:{},params:{}},cors:{expected:!1,sendCredentials:!1},blobs:{defaultName:"misc_data",paramNames:{name:"qqblobname"}},paste:{targetElement:null,defaultName:"pasted_image"}};qq.extend(this._options,b,!0);this._wrapCallbacks();this._disposeSupport=new qq.DisposeSupport;this._filesInProgress=[];this._storedIds=[];this._autoRetries=[];this._retryTimeouts=[];this._preventRetries=[];this._netUploaded=this._netUploadedOrQueued=0;this._paramsStore=this._createParamsStore("request");this._deleteFileParamsStore=this._createParamsStore("deleteFile");this._endpointStore=this._createEndpointStore("request");this._deleteFileEndpointStore=this._createEndpointStore("deleteFile");this._handler=this._createUploadHandler();this._deleteHandler=this._createDeleteHandler();this._options.button&&(this._button=this._createUploadButton(this._options.button));this._options.paste.targetElement&&(this._pasteHandler=this._createPasteHandler());this._preventLeaveInProgress()};qq.FineUploaderBasic.prototype={log:function(d,c){this._options.debug&&(!c||"info"===c)?qq.log("[FineUploader] "+d):c&&"info"!==c&&qq.log("[FineUploader] "+d,c)},setParams:function(d,c){null==c?this._options.request.params=d:this._paramsStore.setParams(d,c)},setDeleteFileParams:function(d,c){null==c?this._options.deleteFile.params=d:this._deleteFileParamsStore.setParams(d,c)},setEndpoint:function(d,c){null==c?this._options.request.endpoint=d:this._endpointStore.setEndpoint(d,c)},getInProgress:function(){return this._filesInProgress.length},getNetUploads:function(){return this._netUploaded},uploadStoredFiles:function(){for(var b;this._storedIds.length;){b=this._storedIds.shift(),this._filesInProgress.push(b),this._handler.upload(b)}},clearStoredFiles:function(){this._storedIds=[]},retry:function(b){return this._onBeforeManualRetry(b)?(this._netUploadedOrQueued++,this._handler.retry(b),!0):!1},cancel:function(b){this._handler.cancel(b)},cancelAll:function(){var d=[],c=this;qq.extend(d,this._storedIds);qq.each(d,function(b,e){c.cancel(e)});this._handler.cancelAll()},reset:function(){this.log("Resetting uploader...");this._handler.reset();this._filesInProgress=[];this._storedIds=[];this._autoRetries=[];this._retryTimeouts=[];this._preventRetries=[];this._button.reset();this._paramsStore.reset();this._endpointStore.reset();this._netUploaded=this._netUploadedOrQueued=0;this._pasteHandler&&this._pasteHandler.reset()},addFiles:function(h,g,l){var k=[],j,i;if(h){if(!window.FileList||!(h instanceof FileList)){h=[].concat(h)}for(j=0;j<h.length;j+=1){i=h[j],qq.isFileOrInput(i)?k.push(i):this.log(i+" is not a File or INPUT element!  Ignoring!","warn")}this.log("Processing "+k.length+" files or inputs...");this._uploadFileOrBlobDataList(k,g,l)}},addBlobs:function(g,f,j){if(g){var g=[].concat(g),i=[],h=this;qq.each(g,function(d,c){qq.isBlob(c)&&!qq.isFileOrInput(c)?i.push({blob:c,name:h._options.blobs.defaultName}):qq.isObject(c)&&c.blob&&c.name?i.push(c):h.log("addBlobs: entry at index "+d+" is not a Blob or a BlobData object","error")});this._uploadFileOrBlobDataList(i,f,j)}else{this.log("undefined or non-array parameter passed into addBlobs","error")}},getUuid:function(b){return this._handler.getUuid(b)},getResumableFilesData:function(){return this._handler.getResumableFilesData()},getSize:function(b){return this._handler.getSize(b)},getName:function(b){return this._handler.getName(b)},getFile:function(b){return this._handler.getFile(b)},deleteFile:function(b){this._onSubmitDelete(b)},setDeleteFileEndpoint:function(d,c){null==c?this._options.deleteFile.endpoint=d:this._deleteFileEndpointStore.setEndpoint(d,c)},_createUploadButton:function(e){var d=this,f=new qq.UploadButton({element:e,multiple:this._options.multiple&&qq.supportedFeatures.ajaxUploading,acceptFiles:this._options.validation.acceptFiles,onChange:function(b){d._onInputChange(b)},hoverClass:this._options.classes.buttonHover,focusClass:this._options.classes.buttonFocus});this._disposeSupport.addDisposer(function(){f.dispose()});return f},_createUploadHandler:function(){var b=this;return new qq.UploadHandler({debug:this._options.debug,forceMultipart:this._options.request.forceMultipart,maxConnections:this._options.maxConnections,customHeaders:this._options.request.customHeaders,inputName:this._options.request.inputName,uuidParamName:this._options.request.uuidName,totalFileSizeParamName:this._options.request.totalFileSizeName,cors:this._options.cors,demoMode:this._options.demoMode,paramsInBody:this._options.request.paramsInBody,paramsStore:this._paramsStore,endpointStore:this._endpointStore,chunking:this._options.chunking,resume:this._options.resume,blobs:this._options.blobs,log:function(a,d){b.log(a,d)},onProgress:function(a,h,g,f){b._onProgress(a,h,g,f);b._options.callbacks.onProgress(a,h,g,f)},onComplete:function(a,h,g,f){b._onComplete(a,h,g,f);b._options.callbacks.onComplete(a,h,g,f)},onCancel:function(a,d){b._onCancel(a,d);b._options.callbacks.onCancel(a,d)},onUpload:function(a,d){b._onUpload(a,d);b._options.callbacks.onUpload(a,d)},onUploadChunk:function(a,f,e){b._options.callbacks.onUploadChunk(a,f,e)},onResume:function(a,f,e){return b._options.callbacks.onResume(a,f,e)},onAutoRetry:function(a,h,g,f){b._preventRetries[a]=g[b._options.retry.preventRetryResponseProperty];return b._shouldAutoRetry(a,h,g)?(b._maybeParseAndSendUploadError(a,h,g,f),b._options.callbacks.onAutoRetry(a,h,b._autoRetries[a]+1),b._onBeforeAutoRetry(a,h),b._retryTimeouts[a]=setTimeout(function(){b._onAutoRetry(a,h,g)},1000*b._options.retry.autoAttemptDelay),!0):!1}})},_createDeleteHandler:function(){var b=this;return new qq.DeleteFileAjaxRequestor({maxConnections:this._options.maxConnections,customHeaders:this._options.deleteFile.customHeaders,paramsStore:this._deleteFileParamsStore,endpointStore:this._deleteFileEndpointStore,demoMode:this._options.demoMode,cors:this._options.cors,log:function(a,d){b.log(a,d)},onDelete:function(a){b._onDelete(a);b._options.callbacks.onDelete(a)},onDeleteComplete:function(a,f,e){b._onDeleteComplete(a,f,e);b._options.callbacks.onDeleteComplete(a,f,e)}})},_createPasteHandler:function(){var b=this;return new qq.PasteSupport({targetElement:this._options.paste.targetElement,callbacks:{log:function(a,d){b.log(a,d)},pasteReceived:function(a){var d=b._options.callbacks.onPasteReceived;(d=d(a))&&d.then?d.then(function(e){b._handlePasteSuccess(a,e)},function(c){b.log("Ignoring pasted image per paste received callback.  Reason = '"+c+"'")}):b._handlePasteSuccess(a)}}})},_handlePasteSuccess:function(f,e){var h=f.type.split("/")[1],g=e;null==g&&(g=this._options.paste.defaultName);this.addBlobs({name:g+("."+h),blob:f})},_preventLeaveInProgress:function(){var b=this;this._disposeSupport.attach(window,"beforeunload",function(a){if(b._filesInProgress.length){return a=a||window.event,a.returnValue=b._options.messages.onLeave}})},_onSubmit:function(b){this._netUploadedOrQueued++;this._options.autoUpload&&this._filesInProgress.push(b)},_onProgress:function(){},_onComplete:function(f,e,h,g){h.success?this._netUploaded++:this._netUploadedOrQueued--;this._removeFromFilesInProgress(f);this._maybeParseAndSendUploadError(f,e,h,g)},_onCancel:function(b){this._netUploadedOrQueued--;this._removeFromFilesInProgress(b);clearTimeout(this._retryTimeouts[b]);b=qq.indexOf(this._storedIds,b);!this._options.autoUpload&&0<=b&&this._storedIds.splice(b,1)},_isDeletePossible:function(){return this._options.deleteFile.enabled&&(!this._options.cors.expected||qq.supportedFeatures.deleteFileCors)},_onSubmitDelete:function(b){if(this._isDeletePossible()){!1!==this._options.callbacks.onSubmitDelete(b)&&this._deleteHandler.sendDelete(b,this.getUuid(b))}else{return this.log("Delete request ignored for ID "+b+", delete feature is disabled or request not possible due to CORS on a user agent that does not support pre-flighting.","warn"),!1}},_onDelete:function(){},_onDeleteComplete:function(f,e,h){var g=this._handler.getName(f);h?(this.log("Delete request for '"+g+"' has failed.","error"),this._options.callbacks.onError(f,g,"Delete request failed with response code "+e.status,e)):(this._netUploadedOrQueued--,this._netUploaded--,this.log("Delete request for '"+g+"' has succeeded."))},_removeFromFilesInProgress:function(b){b=qq.indexOf(this._filesInProgress,b);0<=b&&this._filesInProgress.splice(b,1)},_onUpload:function(){},_onInputChange:function(b){qq.supportedFeatures.ajaxUploading?this.addFiles(b.files):this.addFiles(b);this._button.reset()},_onBeforeAutoRetry:function(d,c){this.log("Waiting "+this._options.retry.autoAttemptDelay+" seconds before retrying "+c+"...")},_onAutoRetry:function(d,c){this.log("Retrying "+c+"...");this._autoRetries[d]++;this._handler.retry(d)},_shouldAutoRetry:function(b){return !this._preventRetries[b]&&this._options.retry.enableAuto?(void 0===this._autoRetries[b]&&(this._autoRetries[b]=0),this._autoRetries[b]<this._options.retry.maxAutoAttempts):!1},_onBeforeManualRetry:function(e){var d=this._options.validation.itemLimit;if(this._preventRetries[e]){return this.log("Retries are forbidden for id "+e,"warn"),!1}if(this._handler.isValid(e)){var f=this._handler.getName(e);if(!1===this._options.callbacks.onManualRetry(e,f)){return !1}if(0<d&&this._netUploadedOrQueued+1>d){return this._itemError("retryFailTooManyItems",""),!1}this.log("Retrying upload for '"+f+"' (id: "+e+")...");this._filesInProgress.push(e);return !0}this.log("'"+e+"' is not a valid file ID","error");return !1},_maybeParseAndSendUploadError:function(f,e,h,g){if(!h.success){if(g&&200!==g.status&&!h.error){this._options.callbacks.onError(f,e,"XHR returned response code "+g.status,g)}else{this._options.callbacks.onError(f,e,h.error?h.error:this._options.text.defaultResponseError,g)}}},_uploadFileOrBlobDataList:function(f,e,h){var g;if(this._isBatchValid(this._getValidationDescriptors(f))){if(0<f.length){for(g=0;g<f.length;g++){if(this._validateFileOrBlobData(f[g])){this._upload(f[g],e,h)}else{if(this._options.validation.stopOnFirstInvalidFile){break}}}}else{this._itemError("noFilesError","")}}},_upload:function(f,e,h){var f=this._handler.add(f),g=this._handler.getName(f);e&&this.setParams(e,f);h&&this.setEndpoint(h,f);!1!==this._options.callbacks.onSubmit(f,g)&&(this._onSubmit(f,g),this._options.callbacks.onSubmitted(f,g),this._options.autoUpload?this._handler.upload(f):this._storeForLater(f))},_storeForLater:function(b){this._storedIds.push(b)},_isBatchValid:function(e){var d;d=this._options.validation.itemLimit;var f=this._netUploadedOrQueued+e.length;if(e=!1!==this._options.callbacks.onValidateBatch(e)){0===d||f<=d?e=!0:(e=!1,d=this._options.messages.tooManyItemsError.replace(/\{netItems\}/g,f).replace(/\{itemLimit\}/g,d),this._batchError(d))}return e},_validateFileOrBlobData:function(f){var e,h,g;e=this._getValidationDescriptor(f);h=e.name;g=e.size;return !1===this._options.callbacks.onValidate(e)?!1:qq.isFileOrInput(f)&&!this._isAllowedExtension(h)?(this._itemError("typeError",h),!1):0===g?(this._itemError("emptyError",h),!1):g&&this._options.validation.sizeLimit&&g>this._options.validation.sizeLimit?(this._itemError("sizeError",h),!1):g&&g<this._options.validation.minSizeLimit?(this._itemError("minSizeError",h),!1):!0},_itemError:function(j,h){function p(d,c){o=o.replace(d,c)}var o=this._options.messages[j],n=[],l=[].concat(h),g=l[0],k;qq.each(this._options.validation.allowedExtensions,function(d,c){qq.isString(c)&&n.push(c)});k=n.join(", ").toLowerCase();p("{file}",this._options.formatFileName(g));p("{extensions}",k);p("{sizeLimit}",this._formatSize(this._options.validation.sizeLimit));p("{minSizeLimit}",this._formatSize(this._options.validation.minSizeLimit));k=o.match(/(\{\w+\})/g);null!==k&&qq.each(k,function(d,c){p(c,l[d])});this._options.callbacks.onError(null,g,o);return o},_batchError:function(b){this._options.callbacks.onError(null,null,b)},_isAllowedExtension:function(e){var d=this._options.validation.allowedExtensions,f=!1;if(!d.length){return !0}qq.each(d,function(a,c){if(qq.isString(c)&&null!=e.match(RegExp("\\."+c+"$","i"))){return f=!0,!1}});return f},_formatSize:function(d){var c=-1;do{d/=1024,c++}while(99<d);return Math.max(d,0.1).toFixed(1)+this._options.text.sizeSymbols[c]},_wrapCallbacks:function(){var e,d;e=this;d=function(g,i,h){try{return i.apply(e,h)}catch(a){e.log("Caught exception in '"+g+"' callback - "+a.message,"error")}};for(var f in this._options.callbacks){(function(){var b,a;b=f;a=e._options.callbacks[b];e._options.callbacks[b]=function(){return d(b,a,arguments)}})()}},_parseFileOrBlobDataName:function(b){return qq.isFileOrInput(b)?b.value?b.value.replace(/.*(\/|\\)/,""):null!==b.fileName&&void 0!==b.fileName?b.fileName:b.name:b.name},_parseFileOrBlobDataSize:function(d){var c;qq.isFileOrInput(d)?d.value||(c=null!==d.fileSize&&void 0!==d.fileSize?d.fileSize:d.size):c=d.blob.size;return c},_getValidationDescriptor:function(e){var d,f;f={};d=this._parseFileOrBlobDataName(e);e=this._parseFileOrBlobDataSize(e);f.name=d;void 0!==e&&(f.size=e);return f},_getValidationDescriptors:function(e){var d=this,f=[];qq.each(e,function(b,c){f.push(d._getValidationDescriptor(c))});return f},_createParamsStore:function(e){var d={},f=this;return{setParams:function(b,h){var g={};qq.extend(g,b);d[h]=g},getParams:function(b){var a={};null!=b&&d[b]?qq.extend(a,d[b]):qq.extend(a,f._options[e].params);return a},remove:function(b){return delete d[b]},reset:function(){d={}}}},_createEndpointStore:function(e){var d={},f=this;return{setEndpoint:function(b,g){d[g]=b},getEndpoint:function(a){return null!=a&&d[a]?d[a]:f._options[e].endpoint},remove:function(b){return delete d[b]},reset:function(){d={}}}}};qq.DragAndDrop=function(r){function q(b){var i,g,f=new qq.Promise;b.isFile?b.file(function(c){j.push(c);f.success()},function(a){l.callbacks.dropLog("Problem parsing '"+b.fullPath+"'.  FileError code "+a.code+".","error");f.failure()}):b.isDirectory&&(i=b.createReader(),i.readEntries(function(d){var e=d.length;for(g=0;g<d.length;g+=1){q(d[g]).done(function(){e=e-1;e===0&&f.success()})}d.length||f.success()},function(a){l.callbacks.dropLog("Problem parsing '"+b.fullPath+"'.  FileError code "+a.code+".","error");f.failure()}));return f}function p(b){var m,i,f=[],g=new qq.Promise;l.callbacks.processingDroppedFiles();h.dropDisabled(!0);if(1<b.files.length&&!l.allowMultipleItems){l.callbacks.processingDroppedFilesComplete([]),l.callbacks.dropError("tooManyFilesError",""),h.dropDisabled(!1),g.failure()}else{j=[];if(qq.isFolderDropSupported(b)){m=b.items;for(b=0;b<m.length;b+=1){(i=m[b].webkitGetAsEntry())&&(i.isFile?j.push(m[b].getAsFile()):f.push(q(i).done(function(){f.pop();f.length===0&&g.success()})))}}else{j=b.files}0===f.length&&g.success()}return g}function o(b){h=new qq.UploadDropZone({element:b,onEnter:function(a){qq(b).addClass(l.classes.dropActive);a.stopPropagation()},onLeaveNotDescendants:function(){qq(b).removeClass(l.classes.dropActive)},onDrop:function(a){l.hideDropZonesBeforeEnter&&qq(b).hide();qq(b).removeClass(l.classes.dropActive);p(a.dataTransfer).done(function(){var c=j;l.callbacks.dropLog("Grabbed "+c.length+" dropped files.");h.dropDisabled(!1);l.callbacks.processingDroppedFilesComplete(c)})}});k.addDisposer(function(){h.dispose()});l.hideDropZonesBeforeEnter&&qq(b).hide()}function n(d){var c;qq.each(d.dataTransfer.types,function(b,e){if("Files"===e){return c=!0,!1}});return c}var l,h,j=[],k=new qq.DisposeSupport;l={dropZoneElements:[],hideDropZonesBeforeEnter:!1,allowMultipleItems:!0,classes:{dropActive:null},callbacks:new qq.DragAndDrop.callbacks};qq.extend(l,r,!0);(function(){var b=l.dropZoneElements;qq.each(b,function(d,c){o(c)});b.length&&(!qq.ie()||qq.ie10())&&k.attach(document,"dragenter",function(a){!h.dropDisabled()&&n(a)&&qq.each(b,function(d,c){qq(c).css({display:"block"})})});k.attach(document,"dragleave",function(a){l.hideDropZonesBeforeEnter&&qq.FineUploader.prototype._leaving_document_out(a)&&qq.each(b,function(d,c){qq(c).hide()})});k.attach(document,"drop",function(a){l.hideDropZonesBeforeEnter&&qq.each(b,function(d,c){qq(c).hide()});a.preventDefault()})})();return{setupExtraDropzone:function(b){l.dropZoneElements.push(b);o(b)},removeDropzone:function(e){var d,f=l.dropZoneElements;for(d in f){if(f[d]===e){return f.splice(d,1)}}},dispose:function(){k.dispose();h.dispose()}}};qq.DragAndDrop.callbacks=function(){return{processingDroppedFiles:function(){},processingDroppedFilesComplete:function(){},dropError:function(d,c){qq.log("Drag & drop error code '"+d+" with these specifics: '"+c+"'","error")},dropLog:function(d,c){qq.log(d,c)}}};qq.UploadDropZone=function(r){function q(){return qq.safari()||qq.firefox()&&qq.windows()}function p(e){if(qq.ie()&&!qq.ie10()){return !1}var d=e.dataTransfer,f=qq.safari(),e=qq.ie10()?!0:"none"!==d.effectAllowed;return d&&e&&(d.files||!f&&d.types.contains&&d.types.contains("Files"))}function o(b){void 0!==b&&(h=b);return h}var n,l,h,j,k=new qq.DisposeSupport;n={element:null,onEnter:function(){},onLeave:function(){},onLeaveNotDescendants:function(){},onDrop:function(){}};qq.extend(n,r);l=n.element;(function(){j||(q?k.attach(document,"dragover",function(b){b.preventDefault()}):k.attach(document,"dragover",function(b){b.dataTransfer&&(b.dataTransfer.dropEffect="none",b.preventDefault())}),j=!0)})();(function(){k.attach(l,"dragover",function(d){if(p(d)){var c=qq.ie()?null:d.dataTransfer.effectAllowed;d.dataTransfer.dropEffect="move"===c||"linkMove"===c?"move":"copy";d.stopPropagation();d.preventDefault()}});k.attach(l,"dragenter",function(b){if(!o()&&p(b)){n.onEnter(b)}});k.attach(l,"dragleave",function(d){if(p(d)){n.onLeave(d);var c=document.elementFromPoint(d.clientX,d.clientY);if(!qq(this).contains(c)){n.onLeaveNotDescendants(d)}}});k.attach(l,"drop",function(b){!o()&&p(b)&&(b.preventDefault(),n.onDrop(b))})})();return{dropDisabled:function(b){return o(b)},dispose:function(){k.dispose()}}};qq.FineUploader=function(b){qq.FineUploaderBasic.apply(this,arguments);qq.extend(this._options,{element:null,listElement:null,dragAndDrop:{extraDropzones:[],hideDropzones:!0,disableDefaultDropzone:!1},text:{uploadButton:"Upload a file",cancelButton:"Cancel",retryButton:"Retry",deleteButton:"Delete",failUpload:"Upload failed",dragZone:"Drop files here to upload",dropProcessing:"Processing dropped files...",formatProgress:"{percent}% of {total_size}",waitingForResponse:"Processing..."},template:'<div class="qq-uploader">'+(!this._options.dragAndDrop||!this._options.dragAndDrop.disableDefaultDropzone?'<div class="qq-upload-drop-area"><span>{dragZoneText}</span></div>':"")+(!this._options.button?'<div class="qq-upload-button"><div>{uploadButtonText}</div></div>':"")+'<span class="qq-drop-processing"><span>{dropProcessingText}</span><span class="qq-drop-processing-spinner"></span></span>'+(!this._options.listElement?'<ul class="qq-upload-list"></ul>':"")+"</div>",fileTemplate:'<li><div class="qq-progress-bar"></div><span class="qq-upload-spinner"></span><span class="qq-upload-finished"></span><span class="qq-upload-file"></span><span class="qq-upload-size"></span><a class="qq-upload-cancel" href="#">{cancelButtonText}</a><a class="qq-upload-retry" href="#">{retryButtonText}</a><a class="qq-upload-delete" href="#">{deleteButtonText}</a><span class="qq-upload-status-text">{statusText}</span></li>',classes:{button:"qq-upload-button",drop:"qq-upload-drop-area",dropActive:"qq-upload-drop-area-active",list:"qq-upload-list",progressBar:"qq-progress-bar",file:"qq-upload-file",spinner:"qq-upload-spinner",finished:"qq-upload-finished",retrying:"qq-upload-retrying",retryable:"qq-upload-retryable",size:"qq-upload-size",cancel:"qq-upload-cancel",deleteButton:"qq-upload-delete",retry:"qq-upload-retry",statusText:"qq-upload-status-text",success:"qq-upload-success",fail:"qq-upload-fail",successIcon:null,failIcon:null,dropProcessing:"qq-drop-processing",dropProcessingSpinner:"qq-drop-processing-spinner"},failedUploadTextDisplay:{mode:"default",maxChars:50,responseProperty:"error",enableTooltip:!0},messages:{tooManyFilesError:"You may only drop one file",unsupportedBrowser:"Unrecoverable error - this browser does not permit file uploading of any kind."},retry:{showAutoRetryNote:!0,autoRetryNote:"Retrying {retryNum}/{maxAuto}...",showButton:!1},deleteFile:{forceConfirm:!1,confirmMessage:"Are you sure you want to delete {filename}?",deletingStatusText:"Deleting...",deletingFailedText:"Delete failed"},display:{fileSizeOnSubmit:!1},paste:{promptForName:!1,namePromptMessage:"Please name this image"},showMessage:function(c){setTimeout(function(){window.alert(c)},0)},showConfirm:function(e,g,f){setTimeout(function(){window.confirm(e)?g():f&&f()},0)},showPrompt:function(f,i){var h=new qq.Promise,g=window.prompt(f,i);null!=g&&0<qq.trimStr(g).length?h.success(g):h.failure("Undefined or invalid user-supplied value.");return h}},!0);qq.extend(this._options,b,!0);!qq.supportedFeatures.uploading||this._options.cors.expected&&!qq.supportedFeatures.uploadCors?this._options.element.innerHTML="<div>"+this._options.messages.unsupportedBrowser+"</div>":(this._wrapCallbacks(),this._options.template=this._options.template.replace(/\{dragZoneText\}/g,this._options.text.dragZone),this._options.template=this._options.template.replace(/\{uploadButtonText\}/g,this._options.text.uploadButton),this._options.template=this._options.template.replace(/\{dropProcessingText\}/g,this._options.text.dropProcessing),this._options.fileTemplate=this._options.fileTemplate.replace(/\{cancelButtonText\}/g,this._options.text.cancelButton),this._options.fileTemplate=this._options.fileTemplate.replace(/\{retryButtonText\}/g,this._options.text.retryButton),this._options.fileTemplate=this._options.fileTemplate.replace(/\{deleteButtonText\}/g,this._options.text.deleteButton),this._options.fileTemplate=this._options.fileTemplate.replace(/\{statusText\}/g,""),this._element=this._options.element,this._element.innerHTML=this._options.template,this._listElement=this._options.listElement||this._find(this._element,"list"),this._classes=this._options.classes,this._button||(this._button=this._createUploadButton(this._find(this._element,"button"))),this._bindCancelAndRetryEvents(),this._dnd=this._setupDragAndDrop(),this._options.paste.targetElement&&this._options.paste.promptForName&&this._setupPastePrompt())};qq.extend(qq.FineUploader.prototype,qq.FineUploaderBasic.prototype);qq.extend(qq.FineUploader.prototype,{clearStoredFiles:function(){qq.FineUploaderBasic.prototype.clearStoredFiles.apply(this,arguments);this._listElement.innerHTML=""},addExtraDropzone:function(b){this._dnd.setupExtraDropzone(b)},removeExtraDropzone:function(b){return this._dnd.removeDropzone(b)},getItemByFileId:function(d){for(var c=this._listElement.firstChild;c;){if(c.qqFileId==d){return c}c=c.nextSibling}},reset:function(){qq.FineUploaderBasic.prototype.reset.apply(this,arguments);this._element.innerHTML=this._options.template;this._listElement=this._options.listElement||this._find(this._element,"list");this._options.button||(this._button=this._createUploadButton(this._find(this._element,"button")));this._bindCancelAndRetryEvents();this._dnd.dispose();this._dnd=this._setupDragAndDrop()},_removeFileItem:function(b){b=this.getItemByFileId(b);qq(b).remove()},_setupDragAndDrop:function(){var f=this,e=this._find(this._element,"dropProcessing"),h=this._options.dragAndDrop.extraDropzones,g;g=function(b){b.preventDefault()};this._options.dragAndDrop.disableDefaultDropzone||h.push(this._find(this._options.element,"drop"));return new qq.DragAndDrop({dropZoneElements:h,hideDropZonesBeforeEnter:this._options.dragAndDrop.hideDropzones,allowMultipleItems:this._options.multiple,classes:{dropActive:this._options.classes.dropActive},callbacks:{processingDroppedFiles:function(){var a=f._button.getInput();qq(e).css({display:"block"});qq(a).attach("click",g)},processingDroppedFilesComplete:function(b){var a=f._button.getInput();qq(e).hide();qq(a).detach("click",g);b&&f.addFiles(b)},dropError:function(a,d){f._itemError(a,d)},dropLog:function(a,d){f.log(a,d)}}})},_leaving_document_out:function(b){return(qq.chrome()||qq.safari()&&qq.windows())&&0==b.clientX&&0==b.clientY||qq.firefox()&&!b.relatedTarget},_storeForLater:function(d){qq.FineUploaderBasic.prototype._storeForLater.apply(this,arguments);var c=this.getItemByFileId(d);qq(this._find(c,"spinner")).hide()},_find:function(e,d){var f=qq(e).getByClass(this._options.classes[d])[0];if(!f){throw Error("element not found "+d)}return f},_onSubmit:function(d,c){qq.FineUploaderBasic.prototype._onSubmit.apply(this,arguments);this._addToList(d,c)},_onProgress:function(j,h,p,o){qq.FineUploaderBasic.prototype._onProgress.apply(this,arguments);var n,l,g,k;n=this.getItemByFileId(j);l=this._find(n,"progressBar");g=Math.round(100*(p/o));p===o?(k=this._find(n,"cancel"),qq(k).hide(),qq(l).hide(),qq(this._find(n,"statusText")).setText(this._options.text.waitingForResponse),this._displayFileSize(j)):(this._displayFileSize(j,p,o),qq(l).css({display:"block"}));qq(l).css({width:g+"%"})},_onComplete:function(g,f,j,i){qq.FineUploaderBasic.prototype._onComplete.apply(this,arguments);var h=this.getItemByFileId(g);qq(this._find(h,"statusText")).clearText();qq(h).removeClass(this._classes.retrying);qq(this._find(h,"progressBar")).hide();(!this._options.disableCancelForFormUploads||qq.supportedFeatures.ajaxUploading)&&qq(this._find(h,"cancel")).hide();qq(this._find(h,"spinner")).hide();j.success?(this._isDeletePossible()&&this._showDeleteLink(g),qq(h).addClass(this._classes.success),this._classes.successIcon&&(this._find(h,"finished").style.display="inline-block",qq(h).addClass(this._classes.successIcon))):(qq(h).addClass(this._classes.fail),this._classes.failIcon&&(this._find(h,"finished").style.display="inline-block",qq(h).addClass(this._classes.failIcon)),this._options.retry.showButton&&!this._preventRetries[g]&&qq(h).addClass(this._classes.retryable),this._controlFailureTextDisplay(h,j))},_onUpload:function(d,c){qq.FineUploaderBasic.prototype._onUpload.apply(this,arguments);this._showSpinner(d)},_onCancel:function(d,c){qq.FineUploaderBasic.prototype._onCancel.apply(this,arguments);this._removeFileItem(d)},_onBeforeAutoRetry:function(h){var g,l,k,j,i;qq.FineUploaderBasic.prototype._onBeforeAutoRetry.apply(this,arguments);g=this.getItemByFileId(h);l=this._find(g,"progressBar");this._showCancelLink(g);l.style.width=0;qq(l).hide();this._options.retry.showAutoRetryNote&&(l=this._find(g,"statusText"),k=this._autoRetries[h]+1,j=this._options.retry.maxAutoAttempts,i=this._options.retry.autoRetryNote.replace(/\{retryNum\}/g,k),i=i.replace(/\{maxAuto\}/g,j),qq(l).setText(i),1===k&&qq(g).addClass(this._classes.retrying))},_onBeforeManualRetry:function(d){var c=this.getItemByFileId(d);if(qq.FineUploaderBasic.prototype._onBeforeManualRetry.apply(this,arguments)){return this._find(c,"progressBar").style.width=0,qq(c).removeClass(this._classes.fail),qq(this._find(c,"statusText")).clearText(),this._showSpinner(d),this._showCancelLink(c),!0}qq(c).addClass(this._classes.retryable);return !1},_onSubmitDelete:function(b){if(this._isDeletePossible()){!1!==this._options.callbacks.onSubmitDelete(b)&&(this._options.deleteFile.forceConfirm?this._showDeleteConfirm(b):this._sendDeleteRequest(b))}else{return this.log("Delete request ignored for file ID "+b+", delete feature is disabled.","warn"),!1}},_onDeleteComplete:function(g,f,j){qq.FineUploaderBasic.prototype._onDeleteComplete.apply(this,arguments);var i=this.getItemByFileId(g),h=this._find(i,"spinner"),i=this._find(i,"statusText");qq(h).hide();j?(qq(i).setText(this._options.deleteFile.deletingFailedText),this._showDeleteLink(g)):this._removeFileItem(g)},_sendDeleteRequest:function(e){var d=this.getItemByFileId(e),f=this._find(d,"deleteButton"),d=this._find(d,"statusText");qq(f).hide();this._showSpinner(e);qq(d).setText(this._options.deleteFile.deletingStatusText);this._deleteHandler.sendDelete(e,this.getUuid(e))},_showDeleteConfirm:function(e){var d=this._options.deleteFile.confirmMessage.replace(/\{filename\}/g,this._handler.getName(e));this.getUuid(e);var f=this;this._options.showConfirm(d,function(){f._sendDeleteRequest(e)})},_addToList:function(f,e){var h=qq.toElement(this._options.fileTemplate);if(this._options.disableCancelForFormUploads&&!qq.supportedFeatures.ajaxUploading){var g=this._find(h,"cancel");qq(g).remove()}h.qqFileId=f;g=this._find(h,"file");qq(g).setText(this._options.formatFileName(e));qq(this._find(h,"size")).hide();this._options.multiple||(this._handler.cancelAll(),this._clearList());this._listElement.appendChild(h);this._options.display.fileSizeOnSubmit&&qq.supportedFeatures.ajaxUploading&&this._displayFileSize(f)},_clearList:function(){this._listElement.innerHTML="";this.clearStoredFiles()},_displayFileSize:function(f,e,h){var g=this.getItemByFileId(f),f=this._formatSize(this.getSize(f)),g=this._find(g,"size");void 0!==e&&void 0!==h&&(f=this._formatProgress(e,h));qq(g).css({display:"inline"});qq(g).setText(f)},_bindCancelAndRetryEvents:function(){var b=this;this._disposeSupport.attach(this._listElement,"click",function(a){var a=a||window.event,d=a.target||a.srcElement;if(qq(d).hasClass(b._classes.cancel)||qq(d).hasClass(b._classes.retry)||qq(d).hasClass(b._classes.deleteButton)){qq.preventDefault(a);for(a=d.parentNode;void 0===a.qqFileId;){a=a.parentNode}qq(d).hasClass(b._classes.deleteButton)?b.deleteFile(a.qqFileId):qq(d).hasClass(b._classes.cancel)?b.cancel(a.qqFileId):(qq(a).removeClass(b._classes.retryable),b.retry(a.qqFileId))}})},_formatProgress:function(f,e){var h=this._options.text.formatProgress,g=Math.round(100*(f/e)),h=h.replace("{percent}",g),g=this._formatSize(e);return h=h.replace("{total_size}",g)},_controlFailureTextDisplay:function(h,g){var l,k,j,i;l=this._options.failedUploadTextDisplay.mode;k=this._options.failedUploadTextDisplay.maxChars;j=this._options.failedUploadTextDisplay.responseProperty;"custom"===l?((l=g[j])?l.length>k&&(i=l.substring(0,k)+"..."):(l=this._options.text.failUpload,this.log("'"+j+"' is not a valid property on the server response.","warn")),qq(this._find(h,"statusText")).setText(i||l),this._options.failedUploadTextDisplay.enableTooltip&&this._showTooltip(h,l)):"default"===l?qq(this._find(h,"statusText")).setText(this._options.text.failUpload):"none"!==l&&this.log("failedUploadTextDisplay.mode value of '"+l+"' is not valid","warn")},_showTooltip:function(d,c){d.title=c},_showSpinner:function(b){this._find(this.getItemByFileId(b),"spinner").style.display="inline-block"},_showCancelLink:function(b){if(!this._options.disableCancelForFormUploads||qq.supportedFeatures.ajaxUploading){b=this._find(b,"cancel"),qq(b).css({display:"inline"})}},_showDeleteLink:function(b){b=this._find(this.getItemByFileId(b),"deleteButton");qq(b).css({display:"inline"})},_itemError:function(d,c){this._options.showMessage(qq.FineUploaderBasic.prototype._itemError.apply(this,arguments))},_batchError:function(b){qq.FineUploaderBasic.prototype._batchError.apply(this,arguments);this._options.showMessage(b)},_setupPastePrompt:function(){var b=this;this._options.callbacks.onPasteReceived=function(){return b._options.showPrompt(b._options.paste.namePromptMessage,b._options.paste.defaultName)}}});qq.AjaxRequestor=function(v){function u(e){var c=qq.indexOf(p,e),f=l.maxConnections;delete h[e];p.splice(c,1);p.length>=f&&c<f&&(e=p[f-1],t(e))}function t(e){var d=new XMLHttpRequest,n=q(),j={},i;l.onSend(e);l.paramsStore.getParams&&(j=l.paramsStore.getParams(e));i=j;var f=l.endpointStore.getEndpoint(e),m=h[e].addToPath;void 0!==m&&(f+="/"+m);i=o&&i?qq.obj2url(i,f):f;h[e].xhr=d;d.onreadystatechange=s(e);d.open(n,i,!0);l.cors.expected&&l.cors.sendCredentials&&(d.withCredentials=!0);r(e);k("Sending "+n+" request for "+e);!o&&j?d.send(qq.obj2url(j,"")):d.send()}function s(b){var d=h[b].xhr;return function(){if(4===d.readyState){var f=h[b].xhr,c=q(),a=!1;u(b);0<=qq.indexOf(l.successfulResponseCodes,f.status)||(a=!0,k(c+" request for "+b+" has failed - response code "+f.status,"error"));l.onComplete(b,f,a)}}}function r(d){var c=h[d].xhr,d=l.customHeaders;c.setRequestHeader("X-Requested-With","XMLHttpRequest");c.setRequestHeader("Cache-Control","no-cache");qq.each(d,function(b,e){c.setRequestHeader(b,e)})}function q(){return l.demoMode?"GET":l.method}var k,o,p=[],h=[],l={method:"POST",maxConnections:3,customHeaders:{},endpointStore:{},paramsStore:{},successfulResponseCodes:[200],demoMode:!1,cors:{expected:!1,sendCredentials:!1},log:function(){},onSend:function(){},onComplete:function(){},onCancel:function(){}};qq.extend(l,v);k=l.log;o="GET"===q()||"DELETE"===q();return{send:function(d,c){h[d]={addToPath:c};p.push(d)<=l.maxConnections&&t(d)},cancel:function(b){var f=h[b].xhr,e=q();f?(f.onreadystatechange=null,f.abort(),u(b),k("Cancelled "+e+" for "+b),l.onCancel(b),b=!0):b=!1;return b}}};qq.DeleteFileAjaxRequestor=function(e){var d,f={endpointStore:{},maxConnections:3,customHeaders:{},paramsStore:{},demoMode:!1,cors:{expected:!1,sendCredentials:!1},log:function(){},onDelete:function(){},onDeleteComplete:function(){}};qq.extend(f,e);d=new qq.AjaxRequestor({method:"DELETE",endpointStore:f.endpointStore,paramsStore:f.paramsStore,maxConnections:f.maxConnections,customHeaders:f.customHeaders,successfulResponseCodes:[200,202,204],demoMode:f.demoMode,log:f.log,onSend:f.onDelete,onComplete:f.onDeleteComplete});return{sendDelete:function(b,c){d.send(b,c);f.log("Submitted delete file request for "+b)}}};qq.WindowReceiveMessage=function(d){var c={};qq.extend({log:function(){}},d);return{receiveMessage:function(b,g){var f=function(e){g(e.data)};window.postMessage?c[b]=qq(window).attach("message",f):log("iframe message passing not supported in this browser!","error")},stopReceivingMessages:function(b){window.postMessage&&(b=c[b])&&b()}}};qq.UploadHandler=function(h){var g=[],l,k,j,i;l={debug:!1,forceMultipart:!0,paramsInBody:!1,paramsStore:{},endpointStore:{},cors:{expected:!1,sendCredentials:!1},maxConnections:3,uuidParamName:"qquuid",totalFileSizeParamName:"qqtotalfilesize",chunking:{enabled:!1,partSize:2000000,paramNames:{partIndex:"qqpartindex",partByteOffset:"qqpartbyteoffset",chunkSize:"qqchunksize",totalParts:"qqtotalparts",filename:"qqfilename"}},resume:{enabled:!1,id:null,cookiesExpireIn:7,paramNames:{resuming:"qqresume"}},blobs:{paramNames:{name:"qqblobname"}},log:function(){},onProgress:function(){},onComplete:function(){},onCancel:function(){},onUpload:function(){},onUploadChunk:function(){},onAutoRetry:function(){},onResume:function(){}};qq.extend(l,h);k=l.log;j=function(b){var b=qq.indexOf(g,b),c=l.maxConnections;0<=b&&(g.splice(b,1),g.length>=c&&b<c&&(b=g[c-1],i.upload(b)))};i=qq.supportedFeatures.ajaxUploading?new qq.UploadHandlerXhr(l,j,k):new qq.UploadHandlerForm(l,j,k);return{add:function(b){return i.add(b)},upload:function(b){if(g.push(b)<=l.maxConnections){return i.upload(b)}},retry:function(b){return 0<=qq.indexOf(g,b)?i.upload(b,!0):this.upload(b)},cancel:function(b){k("Cancelling "+b);l.paramsStore.remove(b);i.cancel(b);j(b)},cancelAll:function(){var b=this,d=[];qq.extend(d,g);qq.each(d,function(a,e){b.cancel(e)});g=[]},getName:function(b){return i.getName(b)},getSize:function(b){if(i.getSize){return i.getSize(b)}},getFile:function(b){if(i.getFile){return i.getFile(b)}},getQueue:function(){return g},reset:function(){k("Resetting upload handler");g=[];i.reset()},getUuid:function(b){return i.getUuid(b)},isValid:function(b){return i.isValid(b)},getResumableFilesData:function(){return i.getResumableFilesData?i.getResumableFilesData():[]}}};qq.UploadHandlerForm=function(F,D,C){function B(b){void 0!==t[b]&&(t[b](),delete t[b])}function A(e,d){var f=e.id;h[v[f]]=d;t[f]=qq(e).attach("load",function(){p[f]&&(k("Received iframe load event for CORS upload request (file id "+f+")"),G[f]=setTimeout(function(){var b="No valid message received from loaded iframe for file id "+f;k(b,"error");d({error:b})},1000))});E.receiveMessage(f,function(g){k("Received the following window message: '"+g+"'");var c=qq.parseJson(g),i=c.uuid;i&&h[i]?(clearTimeout(G[f]),delete G[f],B(f),g=h[i],delete h[i],E.stopReceivingMessages(f),g(c)):i||k("'"+g+"' does not contain a UUID - ignoring.")})}function z(d,c){y.cors.expected?A(d,c):t[d.id]=qq(d).attach("load",function(){k("Received response for "+d.id);if(d.parentNode){try{if(d.contentDocument&&d.contentDocument.body&&"false"==d.contentDocument.body.innerHTML){return}}catch(a){k("Error when attempting to access iframe during handling of upload response ("+a+")","error")}c()}})}function q(d){var c=qq.toElement('<iframe src="javascript:false;" name="'+d+'" />');c.setAttribute("id",d);c.style.display="none";document.body.appendChild(c);return c}function w(i,g){var n=y.paramsStore.getParams(i),m=qq.toElement('<form method="'+(y.demoMode?"GET":"POST")+'" enctype="multipart/form-data"></form>'),l=y.endpointStore.getEndpoint(i),j=l;n[y.uuidParamName]=v[i];y.paramsInBody?qq.obj2Inputs(n,m):j=qq.obj2url(n,l);m.setAttribute("action",j);m.setAttribute("target",g.name);m.style.display="none";document.body.appendChild(m);return m}var y=F,p=[],v=[],t={},G={},k=C,E=new qq.WindowReceiveMessage({log:k}),h={},H;return H={add:function(d){d.setAttribute("name",y.inputName);var c=p.push(d)-1;v[c]=qq.getUniqueId();d.parentNode&&qq(d).remove();return c},getName:function(b){if(H.isValid(b)){return p[b].value.replace(/.*(\/|\\)/,"")}k(b+" is not a valid item ID.","error")},isValid:function(b){return void 0!==p[b]},reset:function(){p=[];v=[];t={}},getUuid:function(b){return v[b]},cancel:function(b){y.onCancel(b,this.getName(b));delete p[b];delete v[b];delete t[b];y.cors.expected&&(clearTimeout(G[b]),delete G[b],E.stopReceivingMessages(b));if(b=document.getElementById(b)){b.setAttribute("src","java"+String.fromCharCode(115)+"cript:false;"),qq(b).remove()}},upload:function(d){var i=p[d],g=H.getName(d),b=q(d),f;if(!i){throw Error("file with passed id was not added, or already uploaded or cancelled")}y.onUpload(d,this.getName(d));f=w(d,b);f.appendChild(i);z(b,function(n){k("iframe loaded");if(!n){var m;try{var l=b.contentDocument||b.contentWindow.document,e=l.body.innerHTML;k("converting iframe's innerHTML to JSON");k("innerHTML = "+e);e&&e.match(/^<pre/i)&&(e=l.body.firstChild.firstChild.nodeValue);m=qq.parseJson(e)}catch(a){k("Error when attempting to parse form upload response ("+a+")","error"),m={success:!1}}n=m}B(d);y.cors.expected||qq(b).remove();if(n.success||!y.onAutoRetry(d,g,n)){y.onComplete(d,g,n),D(d)}});k("Sending upload request for "+d);f.submit();qq(f).remove();return d}}};qq.UploadHandlerXhr=function(ad,ac,ab){function aa(f,e,h){var g=N.getSize(f),f=N.getName(f);e[T.chunking.paramNames.partIndex]=h.part;e[T.chunking.paramNames.partByteOffset]=h.start;e[T.chunking.paramNames.chunkSize]=h.size;e[T.chunking.paramNames.totalParts]=h.count;e[T.totalFileSizeParamName]=g;F&&(e[T.chunking.paramNames.filename]=f)}function Z(i,f){var n=T.chunking.partSize,m=N.getSize(i),k=W[i].file||W[i].blobData.blob,j=n*f,n=j+n>=m?m:j+n,m=Y(i),h;k.slice?h=k.slice(j,n):k.mozSlice?h=k.mozSlice(j,n):k.webkitSlice&&(h=k.webkitSlice(j,n));return{part:f,start:j,end:n,count:m,blob:h,size:n-j}}function Y(b){b=N.getSize(b);return Math.ceil(b/T.chunking.partSize)}function R(d){var c=new XMLHttpRequest;return W[d].xhr=c}function V(v,u,t,s){var r=new FormData,q=T.demoMode?"GET":"POST",p=T.endpointStore.getEndpoint(s),k=p,m=N.getName(s),h=N.getSize(s),n=W[s].blobData;v[T.uuidParamName]=W[s].uuid;F&&(v[T.totalFileSizeParamName]=h,n&&(v[T.blobs.paramNames.name]=n.name));T.paramsInBody||(F||(v[T.inputName]=m),k=qq.obj2url(v,p));u.open(q,k,!0);T.cors.expected&&T.cors.sendCredentials&&(u.withCredentials=!0);return F?(T.paramsInBody&&qq.obj2FormData(v,r),r.append(T.inputName,t),r):t}function X(f,e){var h=T.customHeaders,g=W[f].file||W[f].blobData.blob;e.setRequestHeader("X-Requested-With","XMLHttpRequest");e.setRequestHeader("Cache-Control","no-cache");F||(e.setRequestHeader("Content-Type","application/octet-stream"),e.setRequestHeader("X-Mime-Type",g.type));qq.each(h,function(b,d){e.setRequestHeader(b,d)})}function Q(g,f,j){var i=N.getName(g),h=N.getSize(g);W[g].attemptingResume=!1;T.onProgress(g,i,h,h);T.onComplete(g,i,f,j);delete W[g].xhr;M(g)}function U(g){var d=W[g].remainingChunkIdxs[0],m=Z(g,d),i=R(g),e=N.getSize(g),h=N.getName(g),k;void 0===W[g].loaded&&(W[g].loaded=0);G&&W[g].file&&E(g,m);i.onreadystatechange=P(g,i);i.upload.onprogress=function(o){if(o.lengthComputable){var n=o.loaded+W[g].loaded,o=o.total,j=Z(g,d),o=o-j.size,b=N.getSize(g),j=j.count,a=o-W[g].initialRequestOverhead;W[g].lastRequestOverhead=o;if(d===0){W[g].lastChunkIdxProgress=0;W[g].initialRequestOverhead=o;W[g].estTotalRequestsSize=b+j*o}else{if(W[g].lastChunkIdxProgress!==d){W[g].lastChunkIdxProgress=d;W[g].estTotalRequestsSize=W[g].estTotalRequestsSize+a}}T.onProgress(g,h,n,W[g].estTotalRequestsSize)}};T.onUploadChunk(g,h,H(m));k=T.paramsStore.getParams(g);aa(g,k,m);W[g].attemptingResume&&(k[T.resume.paramNames.resuming]=!0);k=V(k,i,m.blob,g);X(g,i);I("Sending chunked upload request for item "+g+": bytes "+(m.start+1)+"-"+m.end+" of "+e);i.send(k)}function S(b){I("Server has ordered chunking effort to be restarted on next attempt for item ID "+b,"error");G&&(K(b),W[b].attemptingResume=!1);W[b].remainingChunkIdxs=[];delete W[b].loaded;delete W[b].estTotalRequestsSize;delete W[b].initialRequestOverhead}function H(b){return{partIndex:b.part,startByte:b.start+1,endByte:b.end,totalParts:b.count}}function P(d,c){return function(){if(4===c.readyState){var k;if(W[d]){I("xhr - server response received for "+d);I("responseText = "+c.responseText);try{k=qq.parseJson(c.responseText)}catch(j){I("Error when attempting to parse xhr response text ("+j+")","error"),k={}}if(200!==c.status||!k.success||k.reset){if(k.reset&&S(d),W[d].attemptingResume&&k.reset){W[d].attemptingResume=!1,I("Server has declared that it cannot handle resume for item ID "+d+" - starting from the first chunk","error"),S(d),N.upload(d,!0)}else{var e=N.getName(d);T.onAutoRetry(d,e,k,c)||Q(d,k,c)}}else{if(O){var e=W[d].remainingChunkIdxs.shift(),b=Z(d,e);W[d].attemptingResume=!1;var e=W[d],h=e.loaded,b=b.size,a;a=F?W[d].lastRequestOverhead:0;e.loaded=h+(b+a);0<W[d].remainingChunkIdxs.length?U(d):(G&&K(d),Q(d,k,c))}else{Q(d,k,c)}}}}}}function E(i,h){var n=N.getUuid(i),m=W[i].loaded,l=W[i].initialRequestOverhead,k=W[i].estTotalRequestsSize,j=J(i);qq.setCookie(j,n+L+h.part+L+m+L+l+L+k,T.resume.cookiesExpireIn)}function K(b){W[b].file&&(b=J(b),qq.deleteCookie(b))}function J(e){var d=N.getName(e),e=N.getSize(e),f=T.chunking.partSize,d="qqfilechunk"+L+encodeURIComponent(d)+L+e+L+f;void 0!==D&&(d+=L+D);return d}function C(g){var f=W[g].file||W[g].blobData.blob,j=N.getName(g),i,h;W[g].loaded=0;i=R(g);i.upload.onprogress=function(a){a.lengthComputable&&(W[g].loaded=a.loaded,T.onProgress(g,j,a.loaded,a.total))};i.onreadystatechange=P(g,i);h=T.paramsStore.getParams(g);f=V(h,i,f,g);X(g,i);I("Sending upload request for "+g);i.send(f)}var T=ad,M=ac,I=ab,W=[],L="|",O=T.chunking.enabled&&qq.supportedFeatures.chunking,G=T.resume.enabled&&O&&qq.supportedFeatures.resume,D;D=null!==T.resume.id&&void 0!==T.resume.id&&!qq.isFunction(T.resume.id)&&!qq.isObject(T.resume.id)?T.resume.id:void 0;var F=T.forceMultipart||T.paramsInBody,N;return N={add:function(b){if(b instanceof File){b=W.push({file:b})-1}else{if(qq.isBlob(b.blob)){b=W.push({blobData:b})-1}else{throw Error("Passed obj in not a File or BlobData (in qq.UploadHandlerXhr)")}}W[b].uuid=qq.getUniqueId();return b},getName:function(d){if(N.isValid(d)){var c=W[d].file,d=W[d].blobData;return c?null!==c.fileName&&void 0!==c.fileName?c.fileName:c.name:d.name}I(d+" is not a valid item ID.","error")},getSize:function(b){b=W[b].file||W[b].blobData.blob;return qq.isFileOrInput(b)?null!=b.fileSize?b.fileSize:b.size:b.size},getFile:function(b){if(W[b]){return W[b].file||W[b].blobData.blob}},getLoaded:function(b){return W[b].loaded||0},isValid:function(b){return void 0!==W[b]},reset:function(){W=[]},getUuid:function(b){return W[b].uuid},upload:function(r,q){var p=this.getName(r);T.onUpload(r,p);if(O){var m=N.getName(r),p=0,k,h;if(!W[r].remainingChunkIdxs||0===W[r].remainingChunkIdxs.length){W[r].remainingChunkIdxs=[];if(G&&!q&&W[r].file){r:{k=qq.getCookie(J(r));h=N.getName(r);var e,j,f;if(k){k=k.split(L);if(5===k.length){h=k[0];e=parseInt(k[1],10);j=parseInt(k[2],10);f=parseInt(k[3],10);k=parseInt(k[4],10);k={uuid:h,part:e,lastByteSent:j,initialRequestOverhead:f,estTotalRequestsSize:k};break r}I("Ignoring previously stored resume/chunk cookie for "+h+" - old cookie format","warn")}k=void 0}k&&(h=Z(r,k.part),!1!==T.onResume(r,m,H(h))&&(p=k.part,W[r].uuid=k.uuid,W[r].loaded=k.lastByteSent,W[r].estTotalRequestsSize=k.estTotalRequestsSize,W[r].initialRequestOverhead=k.initialRequestOverhead,W[r].attemptingResume=!0,I("Resuming "+m+" at partition index "+p)))}for(m=Y(r)-1;m>=p;m-=1){W[r].remainingChunkIdxs.unshift(m)}}U(r)}else{C(r)}},cancel:function(d){var c=W[d].xhr;T.onCancel(d,this.getName(d));c&&(c.onreadystatechange=null,c.abort());G&&K(d);delete W[d]},getResumableFilesData:function(){var d=[],c=[];return O&&G?(d=void 0===D?qq.getCookieNames(RegExp("^qqfilechunk\\"+L+".+\\"+L+"\\d+\\"+L+T.chunking.partSize+"=")):qq.getCookieNames(RegExp("^qqfilechunk\\"+L+".+\\"+L+"\\d+\\"+L+T.chunking.partSize+"\\"+L+D+"=")),qq.each(d,function(b,h){var g=h.split(L),f=qq.getCookie(h).split(L);c.push({name:decodeURIComponent(g[1]),size:g[2],uuid:f[0],partIdx:f[1]})}),c):[]}}};(function(v){var u,t,s,r,q,k,o,p,h,l;k=["uploaderType"];s=function(b){b&&(b=p(b),o(b),"basic"===q("uploaderType")?u(new qq.FineUploaderBasic(b)):u(new qq.FineUploader(b)));return t};r=function(e,c){var f=t.data("fineuploader");if(c){void 0===f&&(f={}),f[e]=c,t.data("fineuploader",f)}else{return void 0===f?null:f[e]}};u=function(b){return r("uploader",b)};q=function(d,c){return r(d,c)};o=function(a){var c=a.callbacks={},a=new qq.FineUploaderBasic;v.each(a._options.callbacks,function(f){var d,g;d=/^on(\w+)/.exec(f)[1];d=d.substring(0,1).toLowerCase()+d.substring(1);g=t;c[f]=function(){var b=Array.prototype.slice.call(arguments);return g.triggerHandler(d,b)}})};p=function(a,g){var f,c;f=void 0===g?"basic"!==a.uploaderType?{element:t[0]}:{}:g;v.each(a,function(d,e){0<=v.inArray(d,k)?q(d,e):e instanceof v?f[d]=e[0]:v.isPlainObject(e)?(f[d]={},p(e,f[d])):v.isArray(e)?(c=[],v.each(e,function(i,j){j instanceof v?v.merge(c,j):c.push(j)}),f[d]=c):f[d]=e});if(void 0===g){return f}};h=function(a){return"string"===v.type(a)&&!a.match(/^_/)&&void 0!==u()[a]};l=function(b){var f=[],e=Array.prototype.slice.call(arguments,1);p(e,f);return u()[b].apply(u(),f)};v.fn.fineUploader=function(d){var c=this,b=arguments,a=[];this.each(function(e,f){t=v(f);if(u()&&h(d)){if(a.push(l.apply(c,b)),1===c.length){return !1}}else{"object"===typeof d||!d?s.apply(c,b):v.error("Method "+d+" does not exist on jQuery.fineUploader")}});return 1===a.length?a[0]:1<a.length?a:this}})(jQuery);(function(j){function h(b){b||(b={});b.dropZoneElements=[k];b=n(b);o(b);p(new qq.DragAndDrop(b));return k}function p(e){var d;var f=k.data(g);e?(void 0===f&&(f={}),f.dndInstance=e,k.data(g,f)):d=void 0===f?null:f.dndInstance;return d}function o(a){var d=a.callbacks={};new qq.FineUploaderBasic;j.each(new qq.DragAndDrop.callbacks,function(e){var c;c=k;d[e]=function(){var b=Array.prototype.slice.call(arguments);return c.triggerHandler(e,b)}})}function n(a,m){var i,e;i=void 0===m?{}:m;j.each(a,function(d,f){f instanceof j?i[d]=f[0]:j.isPlainObject(f)?(i[d]={},n(f,i[d])):j.isArray(f)?(e=[],j.each(f,function(q,r){r instanceof j?j.merge(e,r):e.push(r)}),i[d]=e):i[d]=f});if(void 0===m){return i}}function l(e){var c=[],f=Array.prototype.slice.call(arguments,1);n(f,c);return p()[e].apply(p(),c)}var g="fineUploaderDnd",k;j.fn.fineUploaderDnd=function(f){var c=this,b=arguments,a=[];this.each(function(d,e){k=j(e);if(p()&&"string"===j.type(f)&&"dispose"===f&&void 0!==p()[f]){if(a.push(l.apply(c,b)),1===c.length){return !1}}else{"object"===typeof f||!f?h.apply(c,b):j.error("Method "+f+" does not exist in Fine Uploader's DnD module.")}});return 1===a.length?a[0]:1<a.length?a:this}})(jQuery);var scrolltotop={setting:{startline:1,scrollto:0,scrollduration:1000,fadeduration:[500,100]},controlHTML:'<img src="/images/gotop.png" style="width:40px; height:40px;filter:alpha(opacity=30);" />',controlattrs:{offsetx:182,offsety:68},anchorkeyword:"#top",state:{isvisible:false,shouldvisible:false},scrollup:function(){if(!this.cssfixedsupport){this.$control.css({opacity:0})}var a=isNaN(this.setting.scrollto)?this.setting.scrollto:parseInt(this.setting.scrollto);if(typeof a=="string"&&jQuery("#"+a).length==1){a=jQuery("#"+a).offset().top}else{a=0}this.$body.animate({scrollTop:a},this.setting.scrollduration)},keepfixed:function(){var c=jQuery(window);var b=c.scrollLeft()+c.width()-this.$control.width()-this.controlattrs.offsetx;var a=c.scrollTop()+c.height()-this.$control.height()-this.controlattrs.offsety;this.$control.css({left:b+"px",top:a+"px"})},togglecontrol:function(){var a=jQuery(window).scrollTop();if(!this.cssfixedsupport){this.keepfixed()}this.state.shouldvisible=(a>=this.setting.startline)?true:false;if(this.state.shouldvisible&&!this.state.isvisible){this.$control.stop().animate({opacity:1},this.setting.fadeduration[0]);this.state.isvisible=true}else{if(this.state.shouldvisible==false&&this.state.isvisible){this.$control.stop().animate({opacity:0},this.setting.fadeduration[1]);this.state.isvisible=false}}},init:function(){jQuery(document).ready(function(c){var a=scrolltotop;var b=document.all;a.cssfixedsupport=!b||b&&document.compatMode=="CSS1Compat"&&window.XMLHttpRequest;a.$body=(window.opera)?(document.compatMode=="CSS1Compat"?c("html"):c("body")):c("html,body");a.$control=c('<div id="topcontrol">'+a.controlHTML+"</div>").css({position:a.cssfixedsupport?"fixed":"absolute",bottom:a.controlattrs.offsety,right:a.controlattrs.offsetx,opacity:0,cursor:"pointer"}).attr({title:"Scroll Back to Top"}).click(function(){a.scrollup();return false}).appendTo("body");if(document.all&&!window.XMLHttpRequest&&a.$control.text()!=""){a.$control.css({width:a.$control.width()})}a.togglecontrol();c('a[href="'+a.anchorkeyword+'"]').click(function(){a.scrollup();return false});c(window).bind("scroll resize",function(d){a.togglecontrol()})})}};scrolltotop.init();